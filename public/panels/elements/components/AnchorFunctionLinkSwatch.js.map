{"version":3,"file":"AnchorFunctionLinkSwatch.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/AnchorFunctionLinkSwatch.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport '../../../ui/components/icon_button/icon_button.js';\nimport '../../../ui/legacy/components/inline_editor/inline_editor.js';\n/* eslint-disable rulesdir/no-lit-render-outside-of-view */\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as SDK from '../../../core/sdk/sdk.js';\nimport type * as InlineEditor from '../../../ui/legacy/components/inline_editor/inline_editor.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport anchorFunctionLinkSwatchStylesRaw from './anchorFunctionLinkSwatch.css.js';\n\n// TODO(crbug.com/391381439): Fully migrate off of constructed style sheets.\nconst anchorFunctionLinkSwatchStyles = new CSSStyleSheet();\nanchorFunctionLinkSwatchStyles.replaceSync(anchorFunctionLinkSwatchStylesRaw.cssText);\n\nconst UIStrings = {\n  /**\n   *@description Title in the styles tab for the icon button for jumping to the anchor node.\n   */\n  jumpToAnchorNode: 'Jump to anchor node',\n  /**\n   *@description Text displayed in a tooltip shown when hovering over a CSS property value references a name that's not\n   *             defined and can't be linked to.\n   *@example {--my-linkable-name} PH1\n   */\n  sIsNotDefined: '{PH1} is not defined',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/AnchorFunctionLinkSwatch.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html} = Lit;\n\n// Clang format is messing up the formatting of the functions below. It's best\n// to leave formatting off for this type declaration.\n// clang-format off\nexport interface AnchorFunctionLinkSwatchData {\n  onLinkActivate: () => void;\n  onMouseEnter: () => void;\n  onMouseLeave: () => void;\n  // The dashed identifier for the anchor function.\n  // It is undefined when we're rendering for implicit or default anchor cases.\n  identifier?: string;\n  // The anchor node, it is undefined when it is not resolved correctly.\n  anchorNode?: SDK.DOMModel.DOMNode;\n  // Whether to add a space after the link or not. This is needed because for some cases,\n  // even though the link swatch is created; there might not be any links rendered for it.\n  // So adding the space from the outside causes an unnecessary space to be rendered for these cases.\n  // That's the reason we're controlling space behavior from the inside.\n  // However for `position-anchor: --dashed-ident` case, there is no space needed at all.\n  // That's why we need the parameter so that we don't render a space for that case.\n  needsSpace?: boolean;\n}\n// clang-format on\n\nexport class AnchorFunctionLinkSwatch extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #data: AnchorFunctionLinkSwatchData;\n\n  constructor(data: AnchorFunctionLinkSwatchData) {\n    super();\n    this.#data = data;\n  }\n\n  dataForTest(): AnchorFunctionLinkSwatchData {\n    return this.#data;\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [anchorFunctionLinkSwatchStyles];\n    this.render();\n  }\n\n  set data(data: AnchorFunctionLinkSwatchData) {\n    this.#data = data;\n    this.render();\n  }\n\n  #handleIconClick(ev: MouseEvent): void {\n    ev.stopPropagation();\n    this.#data.onLinkActivate();\n  }\n\n  protected render(): void {\n    if (!this.#data.identifier && !this.#data.anchorNode) {\n      return;\n    }\n\n    if (this.#data.identifier) {\n      render(\n          // clang-format off\n          html`<devtools-link-swatch\n                @mouseenter=${this.#data.onMouseEnter}\n                @mouseleave=${this.#data.onMouseLeave}\n                .data=${{\n                  text: this.#data.identifier,\n                  tooltip: this.#data.anchorNode ? undefined :\n                   {title:  i18nString(UIStrings.sIsNotDefined, {PH1: this.#data.identifier})},\n                  isDefined: Boolean(this.#data.anchorNode),\n                  jslogContext: 'anchor-link',\n                  onLinkActivate: this.#data.onLinkActivate,\n                } as InlineEditor.LinkSwatch.LinkSwatchRenderData}\n                ></devtools-link-swatch>${this.#data.needsSpace ? ' ' : ''}`,\n          // clang-format on\n          this.#shadow, {host: this});\n    } else {\n      // clang-format off\n      render(html`<devtools-icon\n                   role='button'\n                   title=${i18nString(UIStrings.jumpToAnchorNode)}\n                   class='icon-link'\n                   name='open-externally'\n                   jslog=${VisualLogging.action('jump-to-anchor-node').track({click: true})}\n                   @mouseenter=${this.#data.onMouseEnter}\n                   @mouseleave=${this.#data.onMouseLeave}\n                   @mousedown=${(ev: MouseEvent) => ev.stopPropagation()}\n                   @click=${this.#handleIconClick}\n                  ></devtools-icon>${this.#data.needsSpace ? ' ' : ''}`, this.#shadow, {host: this});\n      // clang-format on\n    }\n  }\n}\n\ncustomElements.define('devtools-anchor-function-link-swatch', AnchorFunctionLinkSwatch);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-anchor-function-link-swatch': AnchorFunctionLinkSwatch;\n  }\n}\n"]}