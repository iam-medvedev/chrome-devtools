{"version":3,"file":"AccessibilityTreeNode.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/AccessibilityTreeNode.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Platform from '../../../core/platform/platform.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport * as RenderCoordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\nimport {html, nothing, render} from '../../../ui/lit/lit.js';\n\nimport accessibilityTreeNodeStylesRaw from './accessibilityTreeNode.css.js';\n\n// TODO(crbug.com/391381439): Fully migrate off of constructed style sheets.\nconst accessibilityTreeNodeStyles = new CSSStyleSheet();\naccessibilityTreeNodeStyles.replaceSync(accessibilityTreeNodeStylesRaw.cssContent);\n\nconst UIStrings = {\n  /**\n   *@description Ignored node element text content in Accessibility Tree View of the Elements panel\n   */\n  ignored: 'Ignored',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/AccessibilityTreeNode.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\n// TODO(jobay) move this to Platform.StringUtilities if still needed.\n// This function is a variant of setTextContentTruncatedIfNeeded found in DOMExtension.\nfunction truncateTextIfNeeded(text: string): string {\n  const maxTextContentLength = 10000;\n\n  if (text.length > maxTextContentLength) {\n    return Platform.StringUtilities.trimMiddle(text, maxTextContentLength);\n  }\n  return text;\n}\n\nfunction isPrintable(valueType: Protocol.Accessibility.AXValueType): boolean {\n  switch (valueType) {\n    case Protocol.Accessibility.AXValueType.Boolean:\n    case Protocol.Accessibility.AXValueType.BooleanOrUndefined:\n    case Protocol.Accessibility.AXValueType.String:\n    case Protocol.Accessibility.AXValueType.Number:\n      return true;\n    default:\n      return false;\n  }\n}\n\nexport interface AccessibilityTreeNodeData {\n  ignored: boolean;\n  name: string;\n  role: string;\n  properties: Protocol.Accessibility.AXProperty[];\n  id: string;\n}\n\nexport class AccessibilityTreeNode extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  #ignored = true;\n  #name = '';\n  #role = '';\n  #properties: Protocol.Accessibility.AXProperty[] = [];\n  #id = '';\n\n  set data(data: AccessibilityTreeNodeData) {\n    this.#ignored = data.ignored;\n    this.#name = data.name;\n    this.#role = data.role;\n    this.#properties = data.properties;\n    this.#id = data.id;\n    void this.#render();\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [accessibilityTreeNodeStyles];\n  }\n\n  async #render(): Promise<void> {\n    const role = html`<span class='role-value'>${truncateTextIfNeeded(this.#role)}</span>`;\n    const name = html`\"<span class='attribute-value'>${this.#name}</span>\"`;\n    const properties = this.#properties.map(\n        ({name, value}) => isPrintable(value.type) ?\n            html` <span class='attribute-name'>${name}</span>:&nbsp;<span class='attribute-value'>${\n                value.value}</span>` :\n            nothing);\n    const content =\n        this.#ignored ? html`<span>${i18nString(UIStrings.ignored)}</span>` : html`${role}&nbsp;${name}${properties}`;\n    await RenderCoordinator.write(`Accessibility node ${this.#id} render`, () => {\n      // clang-format off\n      render(\n        html`<div class='container'>${content}</div>`,\n        this.#shadow,\n        {host: this});\n      // clang-format on\n    });\n  }\n}\n\ncustomElements.define('devtools-accessibility-tree-node', AccessibilityTreeNode);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-accessibility-tree-node': AccessibilityTreeNode;\n  }\n}\n"]}