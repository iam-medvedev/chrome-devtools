{"version":3,"file":"CSSPropertyDocsView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/elements/components/CSSPropertyDocsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n/* eslint-disable rulesdir/no-lit-render-outside-of-view */\n\nimport '../../../ui/legacy/legacy.js';\n\nimport * as Common from '../../../core/common/common.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport {html, nothing, render} from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport CSSPropertyDocsViewStyles from './cssPropertyDocsView.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Text for button that redirects to CSS property documentation.\n   */\n  learnMore: 'Learn more',\n  /**\n   * @description Text for a checkbox to turn off the CSS property documentation.\n   */\n  dontShow: 'Don\\'t show',\n  /**\n   * @description Text indicating that the CSS property has limited availability across major browsers.\n   */\n  limitedAvailability: 'Limited availability across major browsers',\n  /**\n   * @description Text indicating that the CSS property has limited availability across major browsers, with a list of unsupported browsers.\n   * @example {Firefox} PH1\n   * @example {Safari on iOS} PH1\n   * @example {Chrome, Firefox on Android, or Safari} PH1\n   */\n  limitedAvailabilityInBrowsers: 'Limited availability across major browsers (not fully implemented in {PH1})',\n  /**\n   * @description Text to display a combination of browser name and platform name.\n   * @example {Safari} PH1\n   * @example {iOS} PH2\n   */\n  browserOnPlatform: '{PH1} on {PH2}',\n  /**\n   * @description Text indicating that the CSS property is newly available across major browsers since a certain time.\n   * @example {September 2015} PH1\n   */\n  newlyAvailableSince: 'Newly available across major browsers (`Baseline` since {PH1})',\n  /**\n   * @description Text indicating that the CSS property is widely available across major browsers since a certain time.\n   * @example {September 2015} PH1\n   * @example {an unknown date} PH1\n   */\n  widelyAvailableSince: 'Widely available across major browsers (`Baseline` since {PH1})',\n  /**\n   * @description Text indicating that a specific date is not known.\n   */\n  unknownDate: 'an unknown date',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/elements/components/CSSPropertyDocsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst BASELINE_HIGH_AVAILABILITY_ICON =\n    '../../../Images/baseline-high-availability.svg' as Platform.DevToolsPath.RawPathString;\nconst BASELINE_LOW_AVAILABILITY_ICON =\n    '../../../Images/baseline-low-availability.svg' as Platform.DevToolsPath.RawPathString;\nconst BASELINE_LIMITED_AVAILABILITY_ICON =\n    '../../../Images/baseline-limited-availability.svg' as Platform.DevToolsPath.RawPathString;\n\nconst getBaselineIconPath = (baseline: Baseline): Platform.DevToolsPath.UrlString => {\n  let relativePath: string;\n  switch (baseline.status) {\n    case BaselineStatus.HIGH:\n      relativePath = BASELINE_HIGH_AVAILABILITY_ICON;\n      break;\n    case BaselineStatus.LOW:\n      relativePath = BASELINE_LOW_AVAILABILITY_ICON;\n      break;\n    default:\n      relativePath = BASELINE_LIMITED_AVAILABILITY_ICON;\n  }\n  return new URL(relativePath, import.meta.url).toString() as Platform.DevToolsPath.UrlString;\n};\n\nconst enum BrowserId {\n  C = 'C',\n  CA = 'CA',\n  E = 'E',\n  FF = 'FF',\n  FFA = 'FFA',\n  S = 'S',\n  SM = 'SM',\n}\nconst allBrowserIds = new Set<BrowserId>(\n    [BrowserId.C, BrowserId.CA, BrowserId.E, BrowserId.FF, BrowserId.FFA, BrowserId.S, BrowserId.SM]);\nconst enum BrowserPlatform {\n  DESKTOP = 'desktop',\n  ANDROID = 'Android',\n  MACOS = 'macOS',\n  IOS = 'iOS',\n}\nconst browserIdToNameAndPlatform = new Map([\n  [BrowserId.C, {name: 'Chrome', platform: BrowserPlatform.DESKTOP}],\n  [BrowserId.CA, {name: 'Chrome', platform: BrowserPlatform.ANDROID}],\n  [BrowserId.E, {name: 'Edge', platform: BrowserPlatform.DESKTOP}],\n  [BrowserId.FF, {name: 'Firefox', platform: BrowserPlatform.DESKTOP}],\n  [BrowserId.FFA, {name: 'Firefox', platform: BrowserPlatform.ANDROID}],\n  [BrowserId.S, {name: 'Safari', platform: BrowserPlatform.MACOS}],\n  [BrowserId.SM, {name: 'Safari', platform: BrowserPlatform.IOS}],\n]);\n\nfunction formatBrowserList(browserNames: Map<string, BrowserPlatform[]>): string {\n  const formatter = new Intl.ListFormat(i18n.DevToolsLocale.DevToolsLocale.instance().locale, {\n    style: 'long',\n    type: 'disjunction',\n  });\n  return formatter.format(browserNames.entries().map(\n      ([name, platforms]) => platforms.length !== 1 || platforms[0] === BrowserPlatform.DESKTOP ?\n          name :\n          i18nString(UIStrings.browserOnPlatform, {PH1: name, PH2: platforms[0]})));\n}\n\nconst formatBaselineDate = (date?: string): string => {\n  if (!date) {\n    return i18nString(UIStrings.unknownDate);\n  }\n  const parsedDate = new Date(date);\n  const formatter = new Intl.DateTimeFormat(i18n.DevToolsLocale.DevToolsLocale.instance().locale, {\n    month: 'long',\n    year: 'numeric',\n  });\n  return formatter.format(parsedDate);\n};\n\nconst getBaselineMissingBrowsers = (browsers: string[]): Map<string, BrowserPlatform[]> => {\n  const browserIds = browsers.map(v => v.replace(/\\d*$/, ''));\n  const missingBrowserIds = allBrowserIds.difference(new Set(browserIds));\n  const missingBrowsers = new Map();\n  for (const id of missingBrowserIds) {\n    const browserInfo = browserIdToNameAndPlatform.get(id);\n    if (browserInfo) {\n      const {name, platform} = browserInfo;\n      missingBrowsers.set(name, [...(missingBrowsers.get(name) ?? []), platform]);\n    }\n  }\n  return missingBrowsers;\n};\n\nconst getBaselineText = (baseline: Baseline, browsers?: string[]): string => {\n  if (baseline.status === BaselineStatus.LIMITED) {\n    const missingBrowsers = browsers && getBaselineMissingBrowsers(browsers);\n    if (missingBrowsers) {\n      return i18nString(UIStrings.limitedAvailabilityInBrowsers, {PH1: formatBrowserList(missingBrowsers)});\n    }\n    return i18nString(UIStrings.limitedAvailability);\n  }\n\n  if (baseline.status === BaselineStatus.LOW) {\n    return i18nString(UIStrings.newlyAvailableSince, {PH1: formatBaselineDate(baseline.baseline_low_date)});\n  }\n  return i18nString(UIStrings.widelyAvailableSince, {PH1: formatBaselineDate(baseline.baseline_high_date)});\n};\n\nexport const enum BaselineStatus {\n  LIMITED = 'false',\n  LOW = 'low',\n  HIGH = 'high',\n}\n\n/**\n * An object containing Baseline (https://web.dev/baseline,\n * https://web-platform-dx.github.io/web-features/) information about the feature's browser\n * compatibility.\n */\ninterface Baseline {\n  /**\n   * The Baseline status of the feature:\n   * - `\"false\"` — limited availability across major browsers\n   * - `\"low\"` — newly available across major browsers\n   * - `\"high\"` — widely available across major browsers\n   */\n  status: BaselineStatus;\n  /**\n   * A date in the format `YYYY-MM-DD` representing when the feature became newly available,\n   * or `undefined` if it hasn't yet reached that status.\n   */\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  baseline_low_date?: string;\n  /**\n   * A date in the format `YYYY-MM-DD` representing when the feature became widely available,\n   * or `undefined` if it hasn't yet reached that status.\n   *\n   * The widely available date is always 30 months after the newly available date.\n   */\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  baseline_high_date?: string;\n}\n\nexport interface CSSProperty {\n  name: string;\n  description?: string;\n  baseline?: Baseline;\n  browsers?: string[];\n  references?: Array<{\n    name: string,\n    url: string,\n  }>;\n}\n\nexport class CSSPropertyDocsView extends HTMLElement {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  readonly #cssProperty: CSSProperty;\n\n  constructor(cssProperty: CSSProperty) {\n    super();\n    this.#cssProperty = cssProperty;\n    this.#render();\n  }\n\n  #dontShowChanged(e: Event): void {\n    const showDocumentation = !(e.target as HTMLInputElement).checked;\n    Common.Settings.Settings.instance()\n        .moduleSetting('show-css-property-documentation-on-hover')\n        .set(showDocumentation);\n  }\n\n  #render(): void {\n    const {description, references, baseline, browsers} = this.#cssProperty;\n    const link = references?.[0].url;\n\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    render(html`\n      <style>${CSSPropertyDocsViewStyles}</style>\n      <div class=\"docs-popup-wrapper\">\n        ${description ? html`\n          <div id=\"description\">\n            ${description}\n          </div>\n        ` : nothing}\n        ${baseline ? html`\n          <div id=\"baseline\" class=\"docs-popup-section\">\n            <img\n              id=\"baseline-icon\"\n              src=${getBaselineIconPath(baseline)}\n              role=\"presentation\"\n            >\n            <span>\n              ${getBaselineText(baseline, browsers)}\n            </span>\n          </div>\n        ` : nothing}\n        ${link ? html`\n          <div class=\"docs-popup-section footer\">\n            <x-link\n              id=\"learn-more\"\n              href=${link}\n              class=\"clickable underlined unbreakable-text\"\n            >\n              ${i18nString(UIStrings.learnMore)}\n            </x-link>\n            <devtools-checkbox\n              @change=${this.#dontShowChanged}\n              jslog=${VisualLogging.toggle('css-property-doc').track({ change: true })}>\n              ${i18nString(UIStrings.dontShow)}\n            </devtools-checkbox>\n          </div>\n        ` : nothing}\n      </div>\n    `, this.#shadow, {\n        host: this,\n      });\n    // clang-format on\n  }\n}\n\ncustomElements.define('devtools-css-property-docs-view', CSSPropertyDocsView);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-css-property-docs-view': CSSPropertyDocsView;\n  }\n}\n"]}