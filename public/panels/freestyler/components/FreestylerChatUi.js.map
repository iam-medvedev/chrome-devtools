{"version":3,"file":"FreestylerChatUi.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/freestyler/components/FreestylerChatUi.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport type * as SDK from '../../../core/sdk/sdk.js';\nimport * as Marked from '../../../third_party/marked/marked.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as MarkdownView from '../../../ui/components/markdown_view/markdown_view.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\nimport {\n  type ActionStepData,\n  type CommonStepData,\n  type QueryStepData,\n  Step,\n  type StepData,\n  type ThoughtStepData,\n} from '../FreestylerAgent.js';\n\nimport freestylerChatUiStyles from './freestylerChatUi.css.js';\nimport {ProvideFeedback, type ProvideFeedbackProps} from './ProvideFeedback.js';\n\nconst DOGFOOD_FEEDBACK_URL = 'https://goo.gle/freestyler-feedback' as Platform.DevToolsPath.UrlString;\nexport const DOGFOOD_INFO = 'https://goo.gle/freestyler-dogfood' as Platform.DevToolsPath.UrlString;\n\n/*\n  * TODO(nvitkov): b/346933425\n  * Temporary string that should not be translated\n  * as they may change often during development.\n  */\nconst UIStringsTemp = {\n  /**\n   *@description Placeholder text for the chat UI input.\n   */\n  inputPlaceholder: 'Ask a question about the selected element',\n  /**\n   *@description Disclaimer text right after the chat input.\n   */\n  inputDisclaimer:\n      'Chat messages and data from this page will be sent to Google, reviewed by humans, and used to improve the feature. Do not use on pages with personal or sensitive information. AI assistant may display inaccurate information.',\n  /**\n   *@description Title for the send icon button.\n   */\n  sendButtonTitle: 'Send',\n  /**\n   *@description Title for the cancel icon button.\n   */\n  cancelButtonTitle: 'Cancel',\n  /**\n   *@description Label for the \"select an element\" button.\n   */\n  selectAnElement: 'Select an element',\n  /**\n   *@description Text for the empty state of the Freestyler panel.\n   */\n  emptyStateText: 'How can I help you?',\n  /**\n   * @description The title of the button that allows submitting positive\n   * feedback about the response for freestyler.\n   */\n  thumbsUp: 'Thumbs up',\n  /**\n   * @description The title of the button that allows submitting negative\n   * feedback about the response for freestyler.\n   */\n  thumbsDown: 'Thumbs down',\n  /**\n   * @description The error message when the user is not logged in into Chrome.\n   */\n  notLoggedIn: 'This feature is only available when you sign into Chrome with your Google account',\n  /**\n   * @description The error message when the user is not logged in into Chrome.\n   */\n  syncIsOff: 'This feature requires you to turn on Chrome sync',\n  /**\n   * @description Message shown when the user is offline.\n   */\n  offline: 'Check your internet connection and try again',\n  /**\n   *@description Heading for the consent view.\n   */\n  consentScreenHeading: 'Things to consider',\n  /**\n   *@description Title of the button for accepting in the consent screen.\n   */\n  acceptButtonTitle: 'Accept',\n  /**\n   *@description Consent view main text\n   */\n  consentTextAiDisclaimer: 'This feature uses AI and might produce inaccurate information.',\n  /**\n   *@description Consent view data collection text\n   */\n  consentTextDataDisclaimer:\n      'Your inputs and the information from the page you are using this feature for are sent to Google.',\n  /**\n   *@description Consent view data collection text\n   */\n  consentTextDoNotUseDisclaimer: 'Do not use on pages with personal or sensitive information.',\n  /**\n   *@description Consent view data visibility text\n   */\n  consentTextVisibilityDisclaimer: 'Data may be seen by human reviewers and can be used to improve this feature.',\n  /**\n   * @description Side effect confirmation text\n   */\n  sideEffectConfirmationDescription: 'The code contains side effects. Do you wish to continue?',\n  /**\n   * @description Side effect confirmation text for the button that says \"Execute\"\n   */\n  positiveSideEffectConfirmation: 'Execute',\n  /**\n   * @description Side effect confirmation text for the button that says \"Cancel\"\n   */\n  negativeSideEffectConfirmation: 'Cancel',\n  /**\n   *@description Name of the dogfood program.\n   */\n  dogfood: 'Dogfood',\n  /**\n   *@description Link text for redirecting to feedback form\n   */\n  feedbackLink: 'Send feedback',\n  /**\n   *@description Button text for \"Fix this issue\" button\n   */\n  fixThisIssue: 'Fix this issue',\n  /**\n   *@description The name of the CSS assistant that helps you debug CSS issues\n   */\n  cssAssistant: 'CSS assistant',\n  /**\n   *@description The fallback text when we can't find the user full name\n   */\n  you: 'You',\n};\n// const str_ = i18n.i18n.registerUIStrings('panels/freestyler/components/FreestylerChatUi.ts', UIStrings);\n// const i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n/* eslint-disable  rulesdir/l10n_i18nString_call_only_with_uistrings */\nconst i18nString = i18n.i18n.lockedString;\n\nfunction getInputPlaceholderString(aidaAvailability: Host.AidaClient.AidaAccessPreconditions): string {\n  switch (aidaAvailability) {\n    case Host.AidaClient.AidaAccessPreconditions.AVAILABLE:\n      return i18nString(UIStringsTemp.inputPlaceholder);\n    case Host.AidaClient.AidaAccessPreconditions.NO_ACCOUNT_EMAIL:\n      return i18nString(UIStringsTemp.notLoggedIn);\n    case Host.AidaClient.AidaAccessPreconditions.NO_ACTIVE_SYNC:\n      return i18nString(UIStringsTemp.syncIsOff);\n    case Host.AidaClient.AidaAccessPreconditions.NO_INTERNET:\n      return i18nString(UIStringsTemp.offline);\n  }\n}\n\ninterface ConfirmSideEffectDialog {\n  code: string;\n  onAnswer: (result: boolean) => void;\n}\n\nexport const enum ChatMessageEntity {\n  MODEL = 'model',\n  USER = 'user',\n}\n\nexport interface UserChatMessage {\n  entity: ChatMessageEntity.USER;\n  text: string;\n}\nexport interface ModelChatMessage {\n  entity: ChatMessageEntity.MODEL;\n  suggestingFix: boolean;\n  steps: Map<string, ActionStepData|CommonStepData|ThoughtStepData|QueryStepData>;\n  rpcId?: number;\n}\n\nexport type ChatMessage = UserChatMessage|ModelChatMessage;\n\nexport const enum State {\n  CONSENT_VIEW = 'consent-view',\n  CHAT_VIEW = 'chat-view',\n}\n\nexport interface Props {\n  onTextSubmit: (text: string) => void;\n  onInspectElementClick: () => void;\n  onFeedbackSubmit: (rpcId: number, rate: Host.AidaClient.Rating, feedback?: string) => void;\n  onAcceptConsentClick: () => void;\n  onCancelClick: () => void;\n  onFixThisIssueClick: () => void;\n  inspectElementToggled: boolean;\n  state: State;\n  aidaAvailability: Host.AidaClient.AidaAccessPreconditions;\n  messages: ChatMessage[];\n  selectedNode: SDK.DOMModel.DOMNode|null;\n  isLoading: boolean;\n  canShowFeedbackForm: boolean;\n  // If there is a `confirmSideEffectDialog`, we show the\n  // confirmation dialog for executing that specific code.\n  confirmSideEffectDialog?: ConfirmSideEffectDialog;\n  userInfo: Pick<Host.InspectorFrontendHostAPI.SyncInformation, 'accountImage'>;\n}\n\n// The model returns multiline code blocks in an erroneous way with the language being in new line.\n// This renderer takes that into account and correctly updates the parsed multiline token with the language\n// correctly identified and stripped from the content.\n// Example:\n// ```\n// css <-- This should have been on the first line.\n// * {\n//   color: red;\n// }\n// ```\nclass MarkdownRendererWithCodeBlock extends MarkdownView.MarkdownView.MarkdownInsightRenderer {\n  override templateForToken(token: Marked.Marked.Token): LitHtml.TemplateResult|null {\n    if (token.type === 'code') {\n      const lines = (token.text as string).split('\\n');\n      if (lines[0]?.trim() === 'css') {\n        token.lang = 'css';\n        token.text = lines.slice(1).join('\\n');\n      }\n    }\n\n    return super.templateForToken(token);\n  }\n}\n\nexport class FreestylerChatUi extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-freestyler-chat-ui`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  readonly #markdownRenderer = new MarkdownRendererWithCodeBlock();\n  #props: Props;\n\n  constructor(props: Props) {\n    super();\n    this.#props = props;\n  }\n\n  set props(props: Props) {\n    this.#props = props;\n    this.#render();\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [freestylerChatUiStyles];\n    this.#render();\n  }\n\n  focusTextInput(): void {\n    const input = this.#shadow.querySelector('.chat-input') as HTMLInputElement;\n    if (!input) {\n      return;\n    }\n\n    input.focus();\n  }\n\n  scrollToLastMessage(): void {\n    const message = this.#shadow.querySelector('.chat-message:last-child') as HTMLDivElement;\n    if (!message) {\n      return;\n    }\n    message.scrollIntoViewIfNeeded();\n  }\n\n  #handleSubmit = (ev: SubmitEvent): void => {\n    ev.preventDefault();\n    const input = this.#shadow.querySelector('.chat-input') as HTMLInputElement;\n    if (!input || !input.value) {\n      return;\n    }\n    this.#props.onTextSubmit(input.value);\n    input.value = '';\n  };\n\n  #handleCancel = (ev: SubmitEvent): void => {\n    ev.preventDefault();\n\n    if (!this.#props.isLoading) {\n      return;\n    }\n\n    this.#props.onCancelClick();\n  };\n\n  #renderRateButtons(rpcId: number): LitHtml.TemplateResult {\n    // clang-format off\n    return LitHtml.html`<${ProvideFeedback.litTagName}\n      .props=${{\n        onFeedbackSubmit: (rating, feedback) => {\n          this.#props.onFeedbackSubmit(rpcId, rating, feedback);\n        },\n        canShowFeedbackForm: this.#props.canShowFeedbackForm,\n      } as ProvideFeedbackProps}\n      ></${ProvideFeedback.litTagName}>`;\n    // clang-format on\n  }\n\n  #renderTextAsMarkdown(text: string): LitHtml.TemplateResult {\n    let tokens = [];\n    try {\n      tokens = Marked.Marked.lexer(text);\n      for (const token of tokens) {\n        // Try to render all the tokens to make sure that\n        // they all have a template defined for them. If there\n        // isn't any template defined for a token, we'll fallback\n        // to rendering the text as plain text instead of markdown.\n        this.#markdownRenderer.renderToken(token);\n      }\n    } catch (err) {\n      // The tokens were not parsed correctly or\n      // one of the tokens are not supported, so we\n      // continue to render this as text.\n      return LitHtml.html`${text}`;\n    }\n\n    // clang-format off\n    return LitHtml.html`<${MarkdownView.MarkdownView.MarkdownView.litTagName}\n      .data=${{tokens, renderer: this.#markdownRenderer} as MarkdownView.MarkdownView.MarkdownViewData}>\n    </${MarkdownView.MarkdownView.MarkdownView.litTagName}>`;\n    // clang-format on\n  }\n\n  #renderStepDetails(step: ActionStepData|CommonStepData|ThoughtStepData|QueryStepData): LitHtml.LitTemplate {\n    switch (step.step) {\n      case Step.THOUGHT: {\n        const maybeTextWithTitle = step.title ? `**${step.title}**\\n\\n${step.text}` : step.text;\n        return LitHtml.html`<p>${this.#renderTextAsMarkdown(maybeTextWithTitle)}</p>`;\n      }\n      case Step.ACTION:\n        // clang-format off\n        return LitHtml.html`<div class=\"action-result\">\n              <${MarkdownView.CodeBlock.CodeBlock.litTagName}\n                .code=${step.code.trim()}\n                .codeLang=${'js'}\n                .displayToolbar=${false}\n                .displayNotice=${true}\n              ></${MarkdownView.CodeBlock.CodeBlock.litTagName}>\n              <div class=\"js-code-output\">${step.output}</div>\n            </div>`;\n        // clang-format on\n    }\n\n    // TODO: remove this when adding types\n    return LitHtml.nothing;\n  }\n\n  #renderStep(step: StepData, options: {showLoading: boolean}): LitHtml.LitTemplate {\n    // TODO: Use correct loading image\n    const iconName = options.showLoading ? 'dots-horizontal' : 'checkmark';\n    const iconClasses = LitHtml.Directives.classMap({\n      'loading': options.showLoading,\n    });\n\n    switch (step.step) {\n      case Step.ERROR:\n        return LitHtml.html`<p class=\"error-step\">${this.#renderTextAsMarkdown(step.text)}</p>`;\n\n      case Step.QUERYING:\n      case Step.THOUGHT:\n      case Step.ACTION:\n        // clang-format off\n        return LitHtml.html`\n          <details class=\"thought\" open>\n            <summary>\n              <${IconButton.Icon.Icon.litTagName}\n                class=${iconClasses}\n                .name=${iconName}\n              ></${IconButton.Icon.Icon.litTagName}>\n              ${step.step.toUpperCase()}\n            </summary>\n            ${this.#renderStepDetails(step)}\n          </details>\n        `;\n        // clang-format on\n\n      case Step.ANSWER:\n        return LitHtml.html`<p class=\"answer-step\">${this.#renderTextAsMarkdown(step.text)}</p>`;\n    }\n  }\n\n  #renderSideEffectConfirmationUi(confirmSideEffectDialog: ConfirmSideEffectDialog): LitHtml.TemplateResult {\n    // clang-format off\n    return LitHtml.html`<div\n      class=\"side-effect-confirmation\"\n      jslog=${VisualLogging.section('side-effect-confirmation')}\n    >\n      <p>${i18nString(UIStringsTemp.sideEffectConfirmationDescription)}</p>\n      <${MarkdownView.CodeBlock.CodeBlock.litTagName}\n        .code=${confirmSideEffectDialog.code}\n        .codeLang=${'js'}\n        .displayToolbar=${false}\n      ></${MarkdownView.CodeBlock.CodeBlock.litTagName}>\n      <div class=\"side-effect-buttons-container\">\n        <${Buttons.Button.Button.litTagName}\n          .data=${\n            {\n              variant: Buttons.Button.Variant.PRIMARY,\n              jslogContext: 'accept-execute-code',\n            } as Buttons.Button.ButtonData\n          }\n          @click=${() => confirmSideEffectDialog.onAnswer(true)}\n          >${\n            i18nString(UIStringsTemp.positiveSideEffectConfirmation)\n          }</${Buttons.Button.Button.litTagName}>\n        <${Buttons.Button.Button.litTagName}\n          .data=${\n            {\n              variant: Buttons.Button.Variant.OUTLINED,\n              jslogContext: 'decline-execute-code',\n            } as Buttons.Button.ButtonData\n          }\n          @click=${() => confirmSideEffectDialog.onAnswer(false)}\n        >${i18nString(\n          UIStringsTemp.negativeSideEffectConfirmation,\n        )}</${Buttons.Button.Button.litTagName}>\n      </div>\n    </div>`;\n    // clang-format on\n  }\n\n  #renderChatMessage = (message: ChatMessage, {isLast}: {isLast: boolean}): LitHtml.TemplateResult => {\n    if (message.entity === ChatMessageEntity.USER) {\n      // TODO(b/359768313):\n      const name = i18nString(UIStringsTemp.you);\n      // clang-format off\n      return LitHtml.html`<div\n        class=\"chat-message query\"\n        jslog=${VisualLogging.section('question')}\n      >\n        <div class=\"message-info\">\n          <img src=\"data:image/png;base64, ${this.#props.userInfo.accountImage}\" alt=\"Account avatar\" />\n          <div class=\"message-name\">\n            <span>${name}</span>\n          </div>\n        </div>\n        <div>${\n          message.text\n        }</div>\n      </div>`;\n      // clang-format on\n    }\n\n    const shouldShowFixThisIssueButton = !this.#props.isLoading && isLast && message.suggestingFix;\n    const shouldShowRating = !isLast || (!this.#props.confirmSideEffectDialog && isLast);\n    const shouldShowLoading = this.#props.isLoading && isLast && !this.#props.confirmSideEffectDialog;\n\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"chat-message answer\" jslog=${VisualLogging.section('answer')}>\n        <div class=\"message-info\">\n          <${IconButton.Icon.Icon.litTagName}\n            name=\"pen-spark\"\n          ></${IconButton.Icon.Icon.litTagName}>\n          <div class=\"message-name\">\n            <span>${i18nString(UIStringsTemp.cssAssistant)}</span>\n          </div>\n        </div>\n        <div>\n          ${LitHtml.Directives.repeat(\n            message.steps.values(),\n            step => step.id,\n            step => {\n              return this.#renderStep(\n                step,\n                {\n                  showLoading: [...message.steps.values()].at(-1) === step && shouldShowLoading,\n                },\n              );\n            },\n          )}\n        </div>\n        ${this.#props.confirmSideEffectDialog && isLast\n            ? this.#renderSideEffectConfirmationUi(this.#props.confirmSideEffectDialog)\n            : LitHtml.nothing\n        }\n        <div class=\"actions\">\n          ${\n            shouldShowRating && message.rpcId !== undefined\n              ? this.#renderRateButtons(message.rpcId)\n              : LitHtml.nothing\n          }\n          ${\n            shouldShowFixThisIssueButton\n              ? LitHtml.html`<${Buttons.Button.Button.litTagName}\n                  .data=${{\n                      variant: Buttons.Button.Variant.OUTLINED,\n                      jslogContext: 'fix-this-issue',\n                  } as Buttons.Button.ButtonData}\n                  @click=${this.#props.onFixThisIssueClick}\n                >${i18nString(\n                  UIStringsTemp.fixThisIssue,\n                )}</${Buttons.Button.Button.litTagName}>`\n              : LitHtml.nothing\n          }\n        </div>\n      </div>\n    `;\n    // clang-format on\n  };\n\n  #renderSelectAnElement = (): LitHtml.TemplateResult => {\n    const data: Omit<Buttons.Button.ButtonData, 'variant'> = {\n      size: Buttons.Button.Size.SMALL,\n      iconName: 'select-element',\n      toggledIconName: 'select-element',\n      toggleType: Buttons.Button.ToggleType.PRIMARY,\n      toggled: this.#props.inspectElementToggled,\n      title: i18nString(UIStringsTemp.selectAnElement),\n      jslogContext: 'select-element',\n    };\n\n    // clang-format off\n    return this.#props.selectedNode\n      ? LitHtml.html`\n        <${Buttons.Button.Button.litTagName}\n          .data=${{\n            variant: Buttons.Button.Variant.ICON_TOGGLE,\n            ...data,\n          } as Buttons.Button.ButtonData}\n          @click=${this.#props.onInspectElementClick}\n        ></${Buttons.Button.Button.litTagName}>\n        ${LitHtml.Directives.until(\n          Common.Linkifier.Linkifier.linkify(this.#props.selectedNode),\n        )}`\n      : LitHtml.html`\n        <${Buttons.Button.Button.litTagName}\n          .data=${{\n            variant: Buttons.Button.Variant.TEXT,\n            ...data,\n          } as Buttons.Button.ButtonData}\n          @click=${this.#props.onInspectElementClick}\n        ><span class=\"select-an-element-text\">${i18nString(\n          UIStringsTemp.selectAnElement,\n        )}</span></${Buttons.Button.Button.litTagName}>`;\n    // clang-format on\n  };\n\n  #renderFeedbackLink = (): LitHtml.TemplateResult => {\n    // clang-format off\n    return  LitHtml.html`\n        <${IconButton.Icon.Icon.litTagName}\n          name=\"dog-paw\"\n          class=\"feedback-icon\"\n        ></${IconButton.Icon.Icon.litTagName}>\n        <span>${i18nString(UIStringsTemp.dogfood)}</span>\n        <span>-</span>\n        <x-link href=${DOGFOOD_FEEDBACK_URL}\n          class=\"link\"\n          jslog=${VisualLogging.link('freestyler.feedback').track({\n          click: true,\n        })}>${\n          i18nString(UIStringsTemp.feedbackLink)\n        }</x-link>`;\n    // clang-format on\n  };\n\n  #renderMessages = (): LitHtml.TemplateResult => {\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"messages-scroll-container\">\n        <div class=\"messages-container\">\n          ${this.#props.messages.map((message, _, array) =>\n            this.#renderChatMessage(message, {\n              isLast: array.at(-1) === message,\n            }),\n          )}\n        </div>\n      </div>\n    `;\n    // clang-format on\n  };\n\n  #renderEmptyState = (): LitHtml.TemplateResult => {\n    // clang-format off\n    return LitHtml.html`<div class=\"empty-state-container\">\n      <${IconButton.Icon.Icon.litTagName} name=\"spark\" style=\"width: 36px; height: 36px;\"></${IconButton.Icon.Icon.litTagName}>\n      ${i18nString(UIStringsTemp.emptyStateText)}\n    </div>`;\n    // clang-format on\n  };\n\n  #renderChatUi = (): LitHtml.TemplateResult => {\n    // TODO(ergunsh): Show a better UI for the states where Aida client is not available.\n    const isAidaAvailable = this.#props.aidaAvailability === Host.AidaClient.AidaAccessPreconditions.AVAILABLE;\n    const isInputDisabled =\n        !Boolean(this.#props.selectedNode) || !isAidaAvailable || Boolean(this.#props.confirmSideEffectDialog);\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"chat-ui\">\n        ${\n          this.#props.messages.length > 0\n            ? this.#renderMessages()\n            : this.#renderEmptyState()\n        }\n        <form class=\"input-form\" @submit=${this.#handleSubmit}>\n          <div class=\"input-header\">\n            <div class=\"header-link-container\">\n              ${this.#renderSelectAnElement()}\n            </div>\n            <div class=\"header-link-container\">\n              ${this.#renderFeedbackLink()}\n            </div>\n          </div>\n          <div class=\"chat-input-container\">\n            <input type=\"text\" class=\"chat-input\" .disabled=${isInputDisabled}\n              placeholder=${getInputPlaceholderString(\n                this.#props.aidaAvailability,\n              )}\n              jslog=${VisualLogging.textField('query').track({ keydown: 'Enter' })}\n            >${\n                this.#props.isLoading\n                  ? LitHtml.html`\n                    <${Buttons.Button.Button.litTagName}\n                      class=\"step-actions\"\n                      aria-label=${i18nString(UIStringsTemp.cancelButtonTitle)}\n                      @click=${this.#handleCancel}\n                      .data=${\n                        {\n                          variant: Buttons.Button.Variant.PRIMARY,\n                          size: Buttons.Button.Size.SMALL,\n                          disabled: isInputDisabled,\n                          iconName: 'stop',\n                          title: i18nString(UIStringsTemp.cancelButtonTitle),\n                          jslogContext: 'stop',\n                        } as Buttons.Button.ButtonData\n                      }\n                    ></${Buttons.Button.Button.litTagName}>`\n                  : LitHtml.html`\n                    <${Buttons.Button.Button.litTagName}\n                      class=\"step-actions\"\n                      aria-label=${i18nString(UIStringsTemp.sendButtonTitle)}\n                      .data=${\n                        {\n                          type: 'submit',\n                          variant: Buttons.Button.Variant.ICON,\n                          size: Buttons.Button.Size.SMALL,\n                          disabled: isInputDisabled,\n                          iconName: 'send',\n                          title: i18nString(UIStringsTemp.sendButtonTitle),\n                          jslogContext: 'send',\n                        } as Buttons.Button.ButtonData\n                      }\n                    ></${Buttons.Button.Button.litTagName}>`\n              }\n          </div>\n          <span class=\"chat-input-disclaimer\">${i18nString(\n            UIStringsTemp.inputDisclaimer,\n          )} See <x-link\n              class=\"link\"\n              href=${DOGFOOD_INFO}\n              jslog=${VisualLogging.link('freestyler.dogfood-info').track({\n                click: true,\n              })}\n            >dogfood terms</x-link>.</span>\n        </form>\n      </div>\n    `;\n    // clang-format on\n  };\n\n  #renderConsentView = (): LitHtml.TemplateResult => {\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"consent-view\">\n        <h2 tabindex=\"-1\">\n          ${i18nString(UIStringsTemp.consentScreenHeading)}\n        </h2>\n        <main>\n          ${i18nString(UIStringsTemp.consentTextAiDisclaimer)}\n          <ul>\n            <li>${i18nString(UIStringsTemp.consentTextDataDisclaimer)}</li>\n            <li>${i18nString(UIStringsTemp.consentTextVisibilityDisclaimer)}</li>\n            <li>${i18nString(UIStringsTemp.consentTextDoNotUseDisclaimer)}</li>\n            <li>See <x-link\n              class=\"link\"\n              href=${DOGFOOD_INFO}\n              jslog=${VisualLogging.link('freestyler.dogfood-info').track({\n                click: true,\n              })}\n            >dogfood terms</x-link>.</li>\n          </ul>\n          <${Buttons.Button.Button.litTagName}\n            class=\"accept-button\"\n            @click=${this.#props.onAcceptConsentClick}\n            .data=${{\n              variant: Buttons.Button.Variant.PRIMARY,\n              jslogContext: 'accept',\n            } as Buttons.Button.ButtonData}\n          >${\n            i18nString(UIStringsTemp.acceptButtonTitle)\n          }</${Buttons.Button.Button.litTagName}>\n        </main>\n      </div>\n    `;\n    // clang-format on\n  };\n\n  #render(): void {\n    switch (this.#props.state) {\n      case State.CHAT_VIEW:\n        LitHtml.render(this.#renderChatUi(), this.#shadow, {host: this});\n        break;\n      case State.CONSENT_VIEW:\n        LitHtml.render(this.#renderConsentView(), this.#shadow, {host: this});\n        break;\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-freestyler-chat-ui': FreestylerChatUi;\n  }\n}\n\nexport const FOR_TEST = {\n  MarkdownRendererWithCodeBlock,\n};\n\ncustomElements.define('devtools-freestyler-chat-ui', FreestylerChatUi);\n"]}