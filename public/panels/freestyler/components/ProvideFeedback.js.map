{"version":3,"file":"ProvideFeedback.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/freestyler/components/ProvideFeedback.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as Input from '../../../ui/components/input/input.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nimport provideFeedbackStyles from './provideFeedback.css.js';\n\n/*\n  * TODO(nvitkov): b/346933425\n  * Temporary string that should not be translated\n  * as they may change often during development.\n  */\nconst UIStringsTemp = {\n\n  /**\n   * @description The title of the button that allows submitting positive\n   * feedback about the response for freestyler.\n   */\n  thumbsUp: 'Thumbs up',\n  /**\n   * @description The title of the button that allows submitting negative\n   * feedback about the response for freestyler.\n   */\n  thumbsDown: 'Thumbs down',\n  /**\n   * @description The placeholder text for the feedback input.\n   */\n  provideFeedbackPlaceholder: 'Provide additional feedback',\n  /**\n   * @description The disclaimer text that tells the user what will be shared\n   * and what will be stored.\n   */\n  disclaimer: 'Feedback submitted will also include your conversation.',\n  /**\n   * @description The button text for the action of submitting feedback.\n   */\n  submit: 'Submit',\n  /**\n   * @description The header of the feedback form asking.\n   */\n  whyThisRating: 'Why did you choose this rating? (optional)',\n  /**\n   * @description The button text for the action that hides the feedback form.\n   */\n  close: 'Close',\n  /**\n   * @description The title of the button that opens a page to report a legal\n   * issue with the Freestyler message.\n   */\n  report: 'Report legal issue',\n};\n// const str_ = i18n.i18n.registerUIStrings('panels/freestyler/components/AiRatings.ts', UIStrings);\n// const i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n/* eslint-disable  rulesdir/l10n_i18nString_call_only_with_uistrings */\nconst i18nString = i18n.i18n.lockedString;\n\nconst REPORT_URL = 'https://support.google.com/legal/troubleshooter/1114905?hl=en#ts=1115658%2C13380504' as\n    Platform.DevToolsPath.UrlString;\nexport interface ProvideFeedbackProps {\n  onFeedbackSubmit: (rate: Host.AidaClient.Rating, feedback?: string) => void;\n  canShowFeedbackForm: boolean;\n}\n\nexport class ProvideFeedback extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-provide-feedback`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #props: ProvideFeedbackProps;\n  #isShowingFeedbackForm = false;\n  #currentRating?: Host.AidaClient.Rating;\n\n  constructor(props: ProvideFeedbackProps) {\n    super();\n    this.#props = props;\n  }\n\n  set props(props: ProvideFeedbackProps) {\n    this.#props = props;\n    this.#render();\n  }\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [provideFeedbackStyles, Input.textInputStyles];\n    this.#render();\n  }\n\n  #handleRateClick(rating: Host.AidaClient.Rating): void {\n    if (this.#currentRating === rating) {\n      return;\n    }\n\n    this.#currentRating = rating;\n    this.#isShowingFeedbackForm = this.#props.canShowFeedbackForm;\n    this.#props.onFeedbackSubmit(this.#currentRating);\n    this.#render();\n  }\n\n  #handleClose = (): void => {\n    this.#isShowingFeedbackForm = false;\n    this.#render();\n  };\n\n  #handleSubmit = (ev: SubmitEvent): void => {\n    ev.preventDefault();\n    const input = this.#shadow.querySelector('.feedback-input') as HTMLInputElement;\n    if (!this.#currentRating || !input || !input.value) {\n      return;\n    }\n    this.#props.onFeedbackSubmit(this.#currentRating, input.value);\n    this.#isShowingFeedbackForm = false;\n    this.#render();\n  };\n\n  #handleReportClick = (): void => {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(REPORT_URL);\n  };\n\n  #renderButtons(): LitHtml.TemplateResult {\n    // clang-format off\n    return LitHtml.html`\n      <${Buttons.Button.Button.litTagName}\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'thumb-up',\n          active: this.#currentRating === Host.AidaClient.Rating.POSITIVE,\n          title: i18nString(UIStringsTemp.thumbsUp),\n          jslogContext: 'thumbs-up',\n        } as Buttons.Button.ButtonData}\n        @click=${() => this.#handleRateClick(Host.AidaClient.Rating.POSITIVE)}\n      ></${Buttons.Button.Button.litTagName}>\n      <${Buttons.Button.Button.litTagName}\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'thumb-down',\n          active: this.#currentRating === Host.AidaClient.Rating.NEGATIVE,\n          title: i18nString(UIStringsTemp.thumbsDown),\n          jslogContext: 'thumbs-down',\n        } as Buttons.Button.ButtonData}\n        @click=${() => this.#handleRateClick(Host.AidaClient.Rating.NEGATIVE)}\n      ></${Buttons.Button.Button.litTagName}>\n      <div class=\"vertical-separator\"></div>\n      <${Buttons.Button.Button.litTagName}\n        .data=${\n          {\n            variant: Buttons.Button.Variant.ICON,\n            size: Buttons.Button.Size.SMALL,\n            title: i18nString(UIStringsTemp.report),\n            iconName: 'report',\n            jslogContext: 'report',\n          } as Buttons.Button.ButtonData\n        }\n        @click=${this.#handleReportClick}\n      ></${Buttons.Button.Button.litTagName}>\n    `;\n    // clang-format on\n  }\n\n  #renderFeedbackForm(): LitHtml.LitTemplate {\n    // clang-format off\n    return LitHtml.html`\n      <form class=\"feedback\" @submit=${this.#handleSubmit}>\n        <div class=\"feedback-header\">\n          <h4 class=\"feedback-title\">${i18nString(\n              UIStringsTemp.whyThisRating,\n          )}</h4>\n          <${Buttons.Button.Button.litTagName}\n            aria-label=${i18nString(UIStringsTemp.close)}\n            @click=${this.#handleClose}\n            .data=${\n              {\n                variant: Buttons.Button.Variant.ICON,\n                iconName: 'cross',\n                size: Buttons.Button.Size.SMALL,\n                title: i18nString(UIStringsTemp.close),\n                jslogContext: 'close',\n              } as Buttons.Button.ButtonData\n            }\n          ></${Buttons.Button.Button.litTagName}>\n        </div>\n        <input\n          type=\"text\"\n          class=\"devtools-text-input feedback-input\"\n          placeholder=${i18nString(\n           UIStringsTemp.provideFeedbackPlaceholder,\n          )}\n        >\n        <span class=\"feedback-disclaimer\">${\n          i18nString(UIStringsTemp.disclaimer)\n        }</span>\n        <${Buttons.Button.Button.litTagName}\n        aria-label=${i18nString(UIStringsTemp.submit)}\n        .data=${\n          {\n              type: 'submit',\n              variant: Buttons.Button.Variant.OUTLINED,\n              size: Buttons.Button.Size.SMALL,\n              title: i18nString(UIStringsTemp.submit),\n              jslogContext: 'send',\n            } as Buttons.Button.ButtonData\n          }\n        >${\n          i18nString(UIStringsTemp.submit)\n        }</${Buttons.Button.Button.litTagName}>\n      </div>\n    `;\n    // clang-format on\n  }\n\n  #render(): void {\n    // clang-format off\n    LitHtml.render(\n      LitHtml.html`\n        <div class=\"rate-buttons\">\n          ${this.#renderButtons()}\n          ${this.#isShowingFeedbackForm\n            ? this.#renderFeedbackForm()\n            : LitHtml.nothing\n          }\n        </div>`,\n      this.#shadow,\n      {host: this},\n    );\n    // clang-format on\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-provide-feedback': ProvideFeedback;\n  }\n}\n\ncustomElements.define('devtools-provide-feedback', ProvideFeedback);\n"]}