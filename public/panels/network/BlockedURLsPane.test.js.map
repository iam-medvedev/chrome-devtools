{"version":3,"file":"BlockedURLsPane.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/BlockedURLsPane.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,QAAQ,MAAM,iCAAiC,CAAC;AAC5D,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAE7C,OAAO,KAAK,IAAI,MAAM,2BAA2B,CAAC;AAClD,OAAO,EAAC,gBAAgB,EAAE,kBAAkB,EAAE,oBAAoB,EAAC,MAAM,6BAA6B,CAAC;AACvG,OAAO,EAAC,YAAY,EAAE,mBAAmB,EAAE,gBAAgB,EAAC,MAAM,qCAAqC,CAAC;AACxG,OAAO,EAAC,0BAA0B,EAAE,gCAAgC,EAAC,MAAM,iCAAiC,CAAC;AAC7G,OAAO,EAAC,sBAAsB,EAAC,MAAM,sCAAsC,CAAC;AAE5E,OAAO,KAAK,OAAO,MAAM,cAAc,CAAC;AAExC,MAAM,EAAC,SAAS,EAAC,GAAG,QAAQ,CAAC,YAAY,CAAC;AAE1C,0BAA0B,CAAC,iBAAiB,EAAE,GAAG,EAAE;IACjD,UAAU,CAAC,GAAG,EAAE;QACd,gCAAgC,CAAC,iBAAiB,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAChE,gCAAgC,CAAC,uBAAuB,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACtE,mBAAmB,CAAC;YAClB,8CAA8C;YAC9C,sDAAsD;SACvD,CAAC,CAAC;QACH,GAAG,CAAC,cAAc,CAAC,yBAAyB,CAAC,QAAQ,CAAC,EAAC,QAAQ,EAAE,IAAI,EAAC,CAAC,CAAC,iBAAiB,CAAC,iBAAiB;YACvG,CAAC,IAAI,CAAC,CAAC;IACb,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qBAAqB,EAAE,KAAK,IAAI,EAAE;QACnC,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;QACtE,oBAAoB,CAAC,eAAe,CAAC,CAAC;QACtC,MAAM,eAAe,CAAC,cAAc,CAAC;QACrC,MAAM,cAAc,GAAG,eAAe,CAAC,cAAc,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;QACrF,MAAM,WAAW,GAAG,cAAc,EAAE,UAAU,EAAE,aAAa,CAAC,cAAc,CAAC,CAAC;QAC9E,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAC3B,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,aAAa,CAAC,qBAAqB,CAAC,EAAE,WAAW,EAAE,6BAA6B,CAAC,CAAC;QAC/G,MAAM,CAAC,SAAS,CACZ,WAAW,CAAC,aAAa,CAAC,iCAAiC,CAAC,EAAE,WAAW,EACzE,oFAAoF,CAAC,CAAC;QAE1F,MAAM,gBAAgB,CAAC,oCAAoC,CAAC,CAAC;IAC/D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;QACnE,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;QACtE,oBAAoB,CAAC,eAAe,CAAC,CAAC;QACtC,MAAM,eAAe,CAAC,cAAc,CAAC;QACrC,MAAM,cAAc,GAAG,eAAe,CAAC,cAAc,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC;QACrF,MAAM,IAAI,GAAG,cAAc,EAAE,UAAU,EAAE,aAAa,CAAC,OAAO,CAAC,CAAC;QAChE,MAAM,WAAW,GAAG,IAAI,EAAE,aAAa,CAAC,cAAc,CAAC,CAAC;QAExD,MAAM,MAAM,GAAG,WAAW,EAAE,aAAa,CAAC,iBAAiB,CAAC,CAAC;QAC7D,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAEtB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC;QACtD,kBAAkB,CAAC,MAAM,CAAC,CAAC;QAC3B,MAAM,eAAe,CAAC,cAAc,CAAC;QACrC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC;QAEtD,MAAM,gBAAgB,CAAC,+BAA+B,CAAC,CAAC;IAC1D,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,QAAQ,EAAE,GAAG,EAAE;QACtB,MAAM,6BAA6B,GAAG,CAAC,OAAgB,EAAE,EAAE,CAAC,KAAK,IAAI,EAAE;YACrE,MAAM,MAAM,GAAG,YAAY,EAAE,CAAC;YAC9B,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,QAAQ,EAAE,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YACnF,MAAM,cAAc,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;YAEvE,GAAG,CAAC,cAAc,CAAC,yBAAyB,CAAC,QAAQ,EAAE,CAAC,iBAAiB,CAAC,GAAG,CACzE,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;YACtF,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,oBAAoB,CAAC,eAAe,CAAC,CAAC;YACtC,MAAM,eAAe,CAAC,cAAc,CAAC;YACrC,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;YAC9B,MAAM,UAAU,GAAG,KAAK,CAAC,GAAG,CAAC,eAAe,EAAE,eAAe,CAAC,CAAC;YAE/D,MAAM,OAAO,GAAG,IAAI,GAAG,CAAC,cAAc,CAAC,cAAc,CACjD,EAAE,EAAE,SAAS,EAAE,SAAS,CAAA,oBAAoB,EAAE,SAAS,CAAA,oBAAoB,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;YACnG,OAAO,CAAC,gBAAgB,4DAA0C,CAAC;YAEnE,cAAc,CAAC,wBAAwB,CAAC,GAAG,CAAC,cAAc,CAAC,MAAM,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC;YAE5F,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;YACnD,IAAI,OAAO,EAAE,CAAC;gBACZ,MAAM,eAAe,CAAC,cAAc,CAAC;gBACrC,MAAM,gBAAgB,CAAC,wCAAwC,CAAC,CAAC;YACnE,CAAC;iBAAM,CAAC;gBACN,MAAM,gBAAgB,CAAC,4CAA4C,CAAC,CAAC;YACvE,CAAC;QACH,CAAC,CAAC;QAEF,EAAE,CAAC,gEAAgE,EAAE,6BAA6B,CAAC,IAAI,CAAC,CAAC,CAAC;QAC1G,EAAE,CAAC,oEAAoE,EAAE,6BAA6B,CAAC,KAAK,CAAC,CAAC,CAAC;QAE/G,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,YAAY,GAAG,sBAAsB,CAAC,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC;YACrF,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;YACrE,MAAM,YAAY,CAAC,SAAS,CAAC;YAE7B,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC,wBAAwB,CAC1D,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,EAAC,gBAAgB,EAAE,IAAI,EAAC,CAAC,CAAC;YAC5D,MAAM,YAAY,CAAC,SAAS,CAAC;QAC/B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,kEAAkE,EAAE,GAAG,EAAE;QAChF,UAAU,CAAC,GAAG,EAAE;YACd,gBAAgB,CAAC,EAAC,mCAAmC,EAAE,EAAC,OAAO,EAAE,IAAI,EAAC,EAAC,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gCAAgC,EAAE,GAAG,EAAE;YACxC,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,MAAM,KAAK,GAAG,CAAC,CAAC;YAChB,MAAM,IAAI,GAAG,eAAe,CAAC,UAAU,CACnC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC;gBACpD,UAAU,EAAE,yBAA2E;gBACvF,OAAO,EAAE,IAAI;gBACb,UAAU,EAAE,eAA4D;aACzE,CAAC;YACF,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAChC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,CAAC,CAAC;YACtD,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,6BAA6B,KAAK,GAAG,CAAC,CAAC;YAC1E,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,yBAAyB,CAAC,CAAC;YACnE,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,mCAAmC,KAAK,GAAG,CAAC,CAAC;YAChF,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CACd,OAAO,CAAC,WAAW,EACnB,0GAA0G,CAAC,CAAC;QAClH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kDAAkD,EAAE,GAAG,EAAE;YAC1D,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,MAAM,KAAK,GAAG,CAAC,CAAC;YAChB,MAAM,IAAI,GAAG,eAAe,CAAC,UAAU,CACnC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,kBAAkB,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC;YAC/F,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAChC,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,6BAA6B,KAAK,GAAG,CAAC,CAAC;YAC1E,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,uBAAuB,CAAC,CAAC;YACjE,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,oCAAoC,CAAC,CAAC,CAAC;YACxE,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,2CAA2C,KAAK,GAAG,CAAC,CAAC;YACxF,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,mDAAmD,CAAC,CAAC;QAC/F,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,GAAG,EAAE;YACvD,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,MAAM,KAAK,GAAG,CAAC,CAAC;YAChB,MAAM,IAAI,GAAG,eAAe,CAAC,UAAU,CACnC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC,EAAE,cAAc,CAAC,IAAI,EAC7G,KAAK,CAAC,CAAC;YACX,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;YACrD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,yCAAyC,CAAC,CAAC,CAAC;YAC7E,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,yCAAyC,KAAK,GAAG,CAAC,CAAC;YACtF,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,wDAAwD,CAAC,CAAC;QACpG,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;YACnE,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YACtE,MAAM,KAAK,GAAG,CAAC,CAAC;YAChB,MAAM,IAAI,GAAG,eAAe,CAAC,UAAU,CACnC,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC;YAC9F,cAAc,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;YAChC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,QAAQ,CAAC,CAAC;YACrD,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,yCAAyC,CAAC,CAAC,CAAC;YAC7E,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,yCAAyC,KAAK,GAAG,CAAC,CAAC;YACtF,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACvB,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,WAAW,EAAE,yCAAyC,CAAC,CAAC;QACrF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,uFAAuF,EAAE,GAAG,EAAE;YAC/F,MAAM,eAAe,GAAG,IAAI,OAAO,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;YAEtE,MAAM,mBAAmB,GAAG,eAAe,CAAC,SAAS,CACjD,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,iBAAiB,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;YACpG,mBAAmB,CAAC,iBAAiB,EAAE,CAAC;YACxC,MAAM,CAAC,WAAW,CACd,mBAAmB,CAAC,OAAO,CAAC,aAAa,CAAC,qCAAqC,CAAC,EAAE,WAAW,EAC7F,+BAA+B,CAAC,CAAC;YAErC,MAAM,oBAAoB,GAAG,eAAe,CAAC,SAAS,CAClD,GAAG,CAAC,cAAc,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,EAAC,GAAG,EAAE,WAAW,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC,CAAC;YAC9F,oBAAoB,CAAC,iBAAiB,EAAE,CAAC;YACzC,MAAM,CAAC,WAAW,CACd,oBAAoB,CAAC,OAAO,CAAC,aAAa,CAAC,qCAAqC,CAAC,EAAE,WAAW,EAC9F,8CAA8C,CAAC,CAAC;QACtD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as Logs from '../../models/logs/logs.js';\nimport {assertScreenshot, dispatchClickEvent, renderElementIntoDOM} from '../../testing/DOMHelpers.js';\nimport {createTarget, registerNoopActions, updateHostConfig} from '../../testing/EnvironmentHelpers.js';\nimport {describeWithMockConnection, setMockConnectionResponseHandler} from '../../testing/MockConnection.js';\nimport {createViewFunctionStub} from '../../testing/ViewFunctionHelpers.js';\n\nimport * as Network from './network.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribeWithMockConnection('BlockedURLsPane', () => {\n  beforeEach(() => {\n    setMockConnectionResponseHandler('Debugger.enable', () => ({}));\n    setMockConnectionResponseHandler('Storage.getStorageKey', () => ({}));\n    registerNoopActions([\n      'network.add-network-request-blocking-pattern',\n      'network.remove-all-network-request-blocking-patterns',\n    ]);\n    SDK.NetworkManager.MultitargetNetworkManager.instance({forceNew: true}).requestConditions.conditionsEnabled =\n        (true);\n  });\n\n  it('shows a placeholder', async () => {\n    const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n    renderElementIntoDOM(blockedURLsPane);\n    await blockedURLsPane.updateComplete;\n    const blockedElement = blockedURLsPane.contentElement.querySelector('.blocked-urls');\n    const placeholder = blockedElement?.shadowRoot?.querySelector('.empty-state');\n    assert.exists(placeholder);\n    assert.deepEqual(placeholder.querySelector('.empty-state-header')?.textContent, 'No blocked network requests');\n    assert.deepEqual(\n        placeholder.querySelector('.empty-state-description > span')?.textContent,\n        'Add a pattern to block network requests by clicking on the \\\"Add pattern\\\" button.');\n\n    await assertScreenshot('request_conditions/placeholder.png');\n  });\n\n  it('Add pattern button triggers showing the editor view', async () => {\n    const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n    renderElementIntoDOM(blockedURLsPane);\n    await blockedURLsPane.updateComplete;\n    const blockedElement = blockedURLsPane.contentElement.querySelector('.blocked-urls');\n    const list = blockedElement?.shadowRoot?.querySelector('.list');\n    const placeholder = list?.querySelector('.empty-state');\n\n    const button = placeholder?.querySelector('devtools-button');\n    assert.exists(button);\n\n    assert.isNull(list?.querySelector('.editor-content'));\n    dispatchClickEvent(button);\n    await blockedURLsPane.updateComplete;\n    assert.exists(list?.querySelector('.editor-content'));\n\n    await assertScreenshot('request_conditions/editor.png');\n  });\n\n  describe('update', () => {\n    const updatesOnRequestFinishedEvent = (inScope: boolean) => async () => {\n      const target = createTarget();\n      SDK.TargetManager.TargetManager.instance().setScopeTarget(inScope ? target : null);\n      const networkManager = target.model(SDK.NetworkManager.NetworkManager);\n\n      SDK.NetworkManager.MultitargetNetworkManager.instance().requestConditions.add(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: '*', enabled: true}));\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      renderElementIntoDOM(blockedURLsPane);\n      await blockedURLsPane.updateComplete;\n      assert.exists(networkManager);\n      const updateStub = sinon.spy(blockedURLsPane, 'requestUpdate');\n\n      const request = new SDK.NetworkRequest.NetworkRequest(\n          '', undefined, urlString`http://example.com`, urlString`http://example.com`, null, null, null);\n      request.setBlockedReason(Protocol.Network.BlockedReason.Inspector);\n\n      networkManager.dispatchEventToListeners(SDK.NetworkManager.Events.RequestFinished, request);\n\n      assert.strictEqual(updateStub.calledOnce, inScope);\n      if (inScope) {\n        await blockedURLsPane.updateComplete;\n        await assertScreenshot(`request_conditions/blocked-matched.png`);\n      } else {\n        await assertScreenshot(`request_conditions/blocked-not-matched.png`);\n      }\n    };\n\n    it('is called upon RequestFinished event (when target is in scope)', updatesOnRequestFinishedEvent(true));\n    it('is called upon RequestFinished event (when target is out of scope)', updatesOnRequestFinishedEvent(false));\n\n    it('is called upon Reset event', async () => {\n      const viewFunction = createViewFunctionStub(Network.BlockedURLsPane.BlockedURLsPane);\n      new Network.BlockedURLsPane.BlockedURLsPane(undefined, viewFunction);\n      await viewFunction.nextInput;\n\n      Logs.NetworkLog.NetworkLog.instance().dispatchEventToListeners(\n          Logs.NetworkLog.Events.Reset, {clearIfPreserved: true});\n      await viewFunction.nextInput;\n    });\n  });\n\n  describe('shows information for upgrading wildcard patterns to URLPatterns', () => {\n    beforeEach(() => {\n      updateHostConfig({devToolsIndividualRequestThrottling: {enabled: true}});\n    });\n\n    it('shows the URLPattern breakdown', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      const index = 0;\n      const item = blockedURLsPane.renderItem(\n          SDK.NetworkManager.RequestCondition.createFromSetting({\n            urlPattern: 'http://example.com/*bar' as SDK.NetworkManager.URLPatternConstructorString,\n            enabled: true,\n            conditions: 'NO_THROTTLING' as SDK.NetworkManager.ThrottlingConditionKey,\n          }),\n          /* editable=*/ true, index);\n      assert.notExists(item.querySelector('devtools-icon'));\n      const hovered = item.querySelector(`[aria-details=url-pattern-${index}]`);\n      assert.exists(hovered);\n      assert.strictEqual(hovered.textContent, 'http://example.com/*bar');\n      const tooltip = item.querySelector(`devtools-tooltip[id=url-pattern-${index}]`);\n      assert.exists(tooltip);\n      assert.strictEqual(\n          tooltip.textContent,\n          'hash: *hostname: example.compassword: *pathname: /*barport: protocol: httpsearch: *username: *Learn more');\n    });\n\n    it('shows a warning icon when a pattern was upgraded', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      const index = 1;\n      const item = blockedURLsPane.renderItem(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: 'example.com/*bar', enabled: true}),\n          /* editable=*/ true, index);\n      const hovered = item.querySelector(`[aria-details=url-pattern-${index}]`);\n      assert.exists(hovered);\n      assert.strictEqual(hovered.textContent, '*://example.com/*bar*');\n      assert.exists(item.querySelector('devtools-icon[name=warning-filled]'));\n      const tooltip = item.querySelector(`devtools-tooltip[id=url-pattern-warning-${index}]`);\n      assert.exists(tooltip);\n      assert.strictEqual(tooltip.textContent, 'This pattern was upgraded from \"example.com/*bar\"');\n    });\n\n    it('shows an error icon when a pattern is invalid', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      const index = 3;\n      const item = blockedURLsPane.renderItem(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: 'ht tp://*', enabled: true}), /* editable=*/ true,\n          index);\n      assert.isTrue(item.querySelector('input')?.disabled);\n      assert.exists(item.querySelector('devtools-icon[name=cross-circle-filled]'));\n      const tooltip = item.querySelector(`devtools-tooltip[id=url-pattern-error-${index}]`);\n      assert.exists(tooltip);\n      assert.strictEqual(tooltip.textContent, 'This pattern failed to parse as a URLPatternLearn more');\n    });\n\n    it('shows an error icon when a pattern contains regexp groups', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n      const index = 0;\n      const item = blockedURLsPane.renderItem(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: 'http://*/(\\\\d+)', enabled: true}),\n          /* editable=*/ true, index);\n      assert.isTrue(item.querySelector('input')?.disabled);\n      assert.exists(item.querySelector('devtools-icon[name=cross-circle-filled]'));\n      const tooltip = item.querySelector(`devtools-tooltip[id=url-pattern-error-${index}]`);\n      assert.exists(tooltip);\n      assert.strictEqual(tooltip.textContent, 'RegExp groups are not allowedLearn more');\n    });\n\n    it('shows an error message in the editor when the pattern is invalid or has regexp groups', () => {\n      const blockedURLsPane = new Network.BlockedURLsPane.BlockedURLsPane();\n\n      const regexpPatternEditor = blockedURLsPane.beginEdit(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: 'http://*/(\\\\d+)', enabled: true}));\n      regexpPatternEditor.requestValidation();\n      assert.strictEqual(\n          regexpPatternEditor.element.querySelector('.list-widget-input-validation-error')?.textContent,\n          'RegExp groups are not allowed');\n\n      const invalidPatternEditor = blockedURLsPane.beginEdit(\n          SDK.NetworkManager.RequestCondition.createFromSetting({url: 'ht tp://*', enabled: true}));\n      invalidPatternEditor.requestValidation();\n      assert.strictEqual(\n          invalidPatternEditor.element.querySelector('.list-widget-input-validation-error')?.textContent,\n          'This pattern failed to parse as a URLPattern');\n    });\n  });\n});\n"]}