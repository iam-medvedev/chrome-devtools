{"version":3,"file":"RequestInitiatorView.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/network/RequestInitiatorView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport {assertScreenshot, renderElementIntoDOM} from '../../testing/DOMHelpers.js';\nimport {setupLocaleHooks} from '../../testing/LocaleHelpers.js';\nimport {StubStackTrace} from '../../testing/StackTraceHelpers.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport * as Network from './network.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribe('RequestInitiatorView', () => {\n  setupLocaleHooks();\n\n  it('renders empty request initiator view correctly', async () => {\n    const component = document.createElement('div');\n    renderElementIntoDOM(component);\n\n    const request = SDK.NetworkRequest.NetworkRequest.create(\n        'requestId' as Protocol.Network.RequestId, urlString`https://example.com/foo.js`,\n        urlString`https://example.com`, null, null, null);\n\n    const initiatorGraph = {initiators: new Set<SDK.NetworkRequest.NetworkRequest>(), initiated: new Map()};\n\n    const linkifier = new Components.Linkifier.Linkifier();\n\n    Network.RequestInitiatorView.DEFAULT_VIEW(\n        {\n          initiatorGraph,\n          stackTrace: null,\n          request,\n          linkifier,\n        },\n        undefined, component);\n\n    await assertScreenshot('network/request-initiator-view-empty.png');\n  });\n\n  it('renders the initiator view with stack trace correctly', async () => {\n    const component = document.createElement('div');\n    renderElementIntoDOM(component);\n\n    const request = SDK.NetworkRequest.NetworkRequest.create(\n        'requestId' as Protocol.Network.RequestId, urlString`https://example.com/foo.js`,\n        urlString`https://example.com`, null, null, {\n          type: Protocol.Network.InitiatorType.Script,\n        });\n\n    const initiatorGraph = {initiators: new Set<SDK.NetworkRequest.NetworkRequest>(), initiated: new Map()};\n\n    const linkifier = new Components.Linkifier.Linkifier();\n\n    Network.RequestInitiatorView.DEFAULT_VIEW(\n        {\n          initiatorGraph,\n          stackTrace: StubStackTrace.create(['https://example.com/foo.js:foo:10:5']),\n          request,\n          linkifier,\n        },\n        undefined, component);\n\n    await Promise.resolve();  // Trigger MutationObserver (which requests widget updates).\n    await UI.Widget.Widget.allUpdatesComplete;\n\n    await assertScreenshot('network/request-initiator-view-stack.png');\n  });\n\n  it('renders the initiator view with initiator chain correctly', async () => {\n    const component = document.createElement('div');\n    renderElementIntoDOM(component);\n\n    const request = SDK.NetworkRequest.NetworkRequest.create(\n        'requestId' as Protocol.Network.RequestId, urlString`https://example.com/foo.js`,\n        urlString`https://example.com`, null, null, null);\n\n    const initiator = SDK.NetworkRequest.NetworkRequest.create(\n        'initiatorId' as Protocol.Network.RequestId, urlString`https://example.com/initiator.js`,\n        urlString`https://example.com`, null, null, null);\n\n    const initiatorGraph = {initiators: new Set([initiator, request]), initiated: new Map()};\n\n    const linkifier = new Components.Linkifier.Linkifier();\n\n    Network.RequestInitiatorView.DEFAULT_VIEW(\n        {\n          initiatorGraph,\n          stackTrace: null,\n          request,\n          linkifier,\n        },\n        undefined, component);\n\n    await assertScreenshot('network/request-initiator-view-chain.png');\n  });\n\n  it('renders the initiator view with both stack trace and initiator chain correctly', async () => {\n    const component = document.createElement('div');\n    renderElementIntoDOM(component);\n\n    const request = SDK.NetworkRequest.NetworkRequest.create(\n        'requestId' as Protocol.Network.RequestId, urlString`https://example.com/foo.js`,\n        urlString`https://example.com`, null, null, {\n          type: Protocol.Network.InitiatorType.Script,\n        });\n\n    const initiator = SDK.NetworkRequest.NetworkRequest.create(\n        'initiatorId' as Protocol.Network.RequestId, urlString`https://example.com/initiator.js`,\n        urlString`https://example.com`, null, null, null);\n\n    const initiatorGraph = {initiators: new Set([initiator, request]), initiated: new Map()};\n\n    const linkifier = new Components.Linkifier.Linkifier();\n\n    Network.RequestInitiatorView.DEFAULT_VIEW(\n        {\n          initiatorGraph,\n          stackTrace: StubStackTrace.create(['https://example.com/foo.js:foo:10:5']),\n          request,\n          linkifier,\n        },\n        undefined, component);\n\n    await Promise.resolve();  // Trigger MutationObserver (which requests widget updates).\n    await UI.Widget.Widget.allUpdatesComplete;\n\n    await assertScreenshot('network/request-initiator-view-chain-and-stack.png');\n  });\n});\n"]}