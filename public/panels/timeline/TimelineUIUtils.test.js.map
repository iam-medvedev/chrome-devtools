{"version":3,"file":"TimelineUIUtils.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/TimelineUIUtils.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport {assertNotNullOrUndefined} from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as Bindings from '../../models/bindings/bindings.js';\nimport * as TimelineModel from '../../models/timeline_model/timeline_model.js';\nimport * as TraceEngine from '../../models/trace/trace.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as Elements from '../../panels/elements/elements.js';\nimport {doubleRaf, renderElementIntoDOM} from '../../testing/DOMHelpers.js';\nimport {createTarget} from '../../testing/EnvironmentHelpers.js';\nimport {\n  clearMockConnectionResponseHandler,\n  describeWithMockConnection,\n  setMockConnectionResponseHandler,\n} from '../../testing/MockConnection.js';\nimport {\n  loadBasicSourceMapExample,\n  setupPageResourceLoaderForSourceMap,\n} from '../../testing/SourceMapHelpers.js';\nimport {\n  getMainThread,\n  makeCompleteEvent,\n  makeMockSamplesHandlerData,\n  makeProfileCall,\n} from '../../testing/TraceHelpers.js';\nimport {TraceLoader} from '../../testing/TraceLoader.js';\nimport * as Components from '../../ui/legacy/components/utils/utils.js';\n\nimport * as Timeline from './timeline.js';\n\nconst {assert} = chai;\n\ndescribeWithMockConnection('TimelineUIUtils', function() {\n  let tracingModel: TraceEngine.Legacy.TracingModel;\n  let process: TraceEngine.Legacy.Process;\n  let thread: TraceEngine.Legacy.Thread;\n  let target: SDK.Target.Target;\n  // Trace events contain script ids as strings. However, the linkifier\n  // utilities assume it is a number because that's how it's defined at\n  // the protocol level. For practicality, we declare these two\n  // variables so that we can satisfy type checking throughout the tests.\n  const SCRIPT_ID_NUMBER = 1;\n  const SCRIPT_ID_STRING = String(SCRIPT_ID_NUMBER) as Protocol.Runtime.ScriptId;\n\n  beforeEach(() => {\n    target = createTarget();\n    tracingModel = new TraceEngine.Legacy.TracingModel();\n    process = new TraceEngine.Legacy.Process(tracingModel, 1);\n    thread = new TraceEngine.Legacy.Thread(process, 1);\n\n    const workspace = Workspace.Workspace.WorkspaceImpl.instance();\n    const targetManager = SDK.TargetManager.TargetManager.instance();\n    const resourceMapping = new Bindings.ResourceMapping.ResourceMapping(targetManager, workspace);\n    const debuggerWorkspaceBinding = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance({\n      forceNew: true,\n      resourceMapping,\n      targetManager,\n    });\n    Bindings.IgnoreListManager.IgnoreListManager.instance({forceNew: true, debuggerWorkspaceBinding});\n  });\n\n  afterEach(() => {\n    clearMockConnectionResponseHandler('DOM.pushNodesByBackendIdsToFrontend');\n  });\n\n  it('creates top frame location text for function calls', async function() {\n    const event = new TraceEngine.Legacy.ConstructedEvent(\n        'devtools.timeline', 'FunctionCall', TraceEngine.Types.TraceEvents.Phase.COMPLETE, 10, thread);\n\n    event.addArgs({\n      data: {\n        functionName: 'test',\n        url: 'test.js',\n        scriptId: SCRIPT_ID_STRING,\n        lineNumber: 0,\n        columnNumber: 0,\n      },\n    });\n    assert.strictEqual(\n        'test.js:1:1', await Timeline.TimelineUIUtils.TimelineUIUtils.buildDetailsTextForTraceEvent(event));\n  });\n\n  it('creates top frame location text as a fallback', async function() {\n    // 'TimerInstall' is chosen such that we run into the 'default' case.\n    const event = new TraceEngine.Legacy.ConstructedEvent(\n        'devtools.timeline', 'TimerInstall', TraceEngine.Types.TraceEvents.Phase.COMPLETE, 10, thread);\n\n    event.addArgs({\n      data: {\n        stackTrace: [\n          {\n            functionName: 'test',\n            url: 'test.js',\n            scriptId: SCRIPT_ID_STRING,\n            lineNumber: 0,\n            columnNumber: 0,\n          },\n        ],\n      },\n    });\n    const data = TimelineModel.TimelineModel.EventOnTimelineData.forEvent(event);\n    data.stackTrace = event.args.data.stackTrace;\n    assert.strictEqual(\n        'test.js:1:1', await Timeline.TimelineUIUtils.TimelineUIUtils.buildDetailsTextForTraceEvent(event));\n  });\n\n  describe('script location as an URL', function() {\n    let event: TraceEngine.Legacy.ConstructedEvent;\n    beforeEach(() => {\n      event = new TraceEngine.Legacy.ConstructedEvent(\n          'devtools.timeline', TimelineModel.TimelineModel.RecordType.FunctionCall,\n          TraceEngine.Types.TraceEvents.Phase.COMPLETE, 10, thread);\n\n      event.addArgs({\n        data: {\n          functionName: 'test',\n          url: 'https://google.com/test.js',\n          scriptId: SCRIPT_ID_STRING,\n          lineNumber: 0,\n          columnNumber: 0,\n        },\n      });\n    });\n    it('makes the script location of a call frame a full URL when the inspected target is not the same the call frame was taken from (e.g. a loaded file)',\n       async function() {\n         target.setInspectedURL('https://not-google.com' as Platform.DevToolsPath.UrlString);\n         const node = await Timeline.TimelineUIUtils.TimelineUIUtils.buildDetailsNodeForTraceEvent(\n             event, target, new Components.Linkifier.Linkifier());\n         if (!node) {\n           throw new Error('Node was unexpectedly null');\n         }\n         assert.strictEqual(node.textContent, 'test @ google.com/test.js:1:1');\n       });\n\n    it('makes the script location of a call frame a script name when the inspected target is the one the call frame was taken from',\n       async function() {\n         target.setInspectedURL('https://google.com' as Platform.DevToolsPath.UrlString);\n         const node = await Timeline.TimelineUIUtils.TimelineUIUtils.buildDetailsNodeForTraceEvent(\n             event, target, new Components.Linkifier.Linkifier());\n         if (!node) {\n           throw new Error('Node was unexpectedly null');\n         }\n         assert.strictEqual(node.textContent, 'test @ /test.js:1:1');\n       });\n  });\n\n  describe('mapping to authored script when recording is fresh', function() {\n    beforeEach(async () => {\n      // Register mock script and source map.\n\n      const sourceMapContent = JSON.stringify({\n        'version': 3,\n        'names': ['unminified', 'par1', 'par2', 'console', 'log'],\n        'sources': [\n          '/original-script.ts',\n        ],\n        'file': '/test.js',\n        'sourcesContent': ['function unminified(par1, par2) {\\n  console.log(par1, par2);\\n}\\n'],\n        'mappings': 'AAAA,SAASA,EAAWC,EAAMC,GACxBC,QAAQC,IAAIH,EAAMC',\n      });\n      setupPageResourceLoaderForSourceMap(sourceMapContent);\n      target.setInspectedURL('https://google.com' as Platform.DevToolsPath.UrlString);\n      const scriptUrl = 'https://google.com/script.js' as Platform.DevToolsPath.UrlString;\n      const sourceMapUrl = 'script.js.map' as Platform.DevToolsPath.UrlString;\n      const debuggerModel = target.model(SDK.DebuggerModel.DebuggerModel);\n      assert.isNotNull(debuggerModel);\n      if (debuggerModel === null) {\n        return;\n      }\n      const sourceMapManager = debuggerModel.sourceMapManager();\n      const script = debuggerModel.parsedScriptSource(\n          SCRIPT_ID_STRING, scriptUrl, 0, 0, 0, 0, 0, '', undefined, false, sourceMapUrl, true, false, length, false,\n          null, null, null, null, null);\n      await sourceMapManager.sourceMapForClientPromise(script);\n    });\n    it('maps to the authored script when a call frame is provided', async function() {\n      const linkifier = new Components.Linkifier.Linkifier();\n      const node = Timeline.TimelineUIUtils.TimelineUIUtils.linkifyLocation({\n        scriptId: SCRIPT_ID_STRING,\n        url: 'https://google.com/test.js',\n        lineNumber: 0,\n        columnNumber: 0,\n        isFreshRecording: true,\n        target,\n        linkifier,\n      });\n      if (!node) {\n        throw new Error('Node was unexpectedly null');\n      }\n      // Wait for the location to be resolved using the registered source map.\n      await Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance().pendingLiveLocationChangesPromise();\n\n      assert.strictEqual(node.textContent, 'original-script.ts:1:1');\n    });\n\n    it('maps to the authored script when a trace event from the new engine with a stack trace is provided',\n       async function() {\n         const functionCallEvent = makeCompleteEvent('FunctionCall', 10, 100);\n         functionCallEvent.args = ({\n           data: {\n             stackTrace: [{\n               functionName: 'test',\n               url: 'https://google.com/test.js',\n               scriptId: SCRIPT_ID_NUMBER,\n               lineNumber: 0,\n               columnNumber: 0,\n             }],\n           },\n         });\n         const linkifier = new Components.Linkifier.Linkifier();\n         const node =\n             Timeline.TimelineUIUtils.TimelineUIUtils.linkifyTopCallFrame(functionCallEvent, target, linkifier, true);\n         if (!node) {\n           throw new Error('Node was unexpectedly null');\n         }\n         // Wait for the location to be resolved using the registered source map.\n         await Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance()\n             .pendingLiveLocationChangesPromise();\n\n         assert.strictEqual(node.textContent, 'original-script.ts:1:1');\n       });\n  });\n\n  describe('mapping to authored function name when recording is fresh', function() {\n    it('maps to the authored name and script of a profile call', async function() {\n      const {script} = await loadBasicSourceMapExample(target);\n      // Ideally we would get a column number we can use from the source\n      // map however the current status of the source map helpers makes\n      // it difficult to do so.\n      const columnNumber = 51;\n      const profileCall = makeProfileCall(\n          'function', 10, 100, TraceEngine.Types.TraceEvents.ProcessID(1), TraceEngine.Types.TraceEvents.ThreadID(1));\n\n      profileCall.callFrame = {\n        'columnNumber': columnNumber,\n        'functionName': 'minified',\n        'lineNumber': 0,\n        'scriptId': script.scriptId,\n        'url': 'file://gen.js',\n      };\n      const workersData: TraceEngine.Handlers.ModelHandlers.Workers.WorkersData = {\n        workerSessionIdEvents: [],\n        workerIdByThread: new Map(),\n        workerURLById: new Map(),\n      };\n      // This only includes data used in the SourceMapsResolver\n      const traceParsedData = {\n        Samples: makeMockSamplesHandlerData([profileCall]),\n        Workers: workersData,\n      } as TraceEngine.Handlers.Types.TraceParseData;\n\n      const resolver = new Timeline.SourceMapsResolver.SourceMapsResolver(traceParsedData);\n      await resolver.install();\n\n      const linkifier = new Components.Linkifier.Linkifier();\n      const node = await Timeline.TimelineUIUtils.TimelineUIUtils.buildDetailsNodeForTraceEvent(\n          profileCall, target, linkifier, true);\n      if (!node) {\n        throw new Error('Node was unexpectedly null');\n      }\n      assert.isTrue(node.textContent?.startsWith('someFunction @'));\n    });\n  });\n  describe('adjusting timestamps for events and navigations', function() {\n    it('adjusts the time for a DCL event after a navigation', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev.json.gz');\n\n      const mainFrameID = traceParsedData.Meta.mainFrameId;\n\n      const dclEvent = traceParsedData.PageLoadMetrics.allMarkerEvents.find(event => {\n        return TraceEngine.Types.TraceEvents.isTraceEventMarkDOMContent(event) &&\n            event.args.data?.frame === mainFrameID;\n      });\n      if (!dclEvent) {\n        throw new Error('Could not find DCL event');\n      }\n\n      const traceMinBound = traceParsedData.Meta.traceBounds.min;\n\n      // Round the time to 2DP to avoid needlessly long expectation numbers!\n      const unadjustedStartTimeMilliseconds =\n          TraceEngine.Helpers.Timing\n              .microSecondsToMilliseconds(\n                  TraceEngine.Types.Timing.MicroSeconds(dclEvent.ts - traceMinBound),\n                  )\n              .toFixed(2);\n      assert.strictEqual(unadjustedStartTimeMilliseconds, String(190.79));\n\n      const adjustedTime =\n          Timeline.TimelineUIUtils.timeStampForEventAdjustedForClosestNavigationIfPossible(dclEvent, traceParsedData);\n      assert.strictEqual(adjustedTime.toFixed(2), String(178.92));\n    });\n\n    it('can adjust the times for events that are not PageLoad markers', async function() {\n      const traceParsedData = await TraceLoader.traceEngine(this, 'user-timings.json.gz');\n      // Use a performance.mark event. Exact event is unimportant except that\n      // it should not be a Page Load event as those are covered by the tests\n      // above.\n      const userMark = traceParsedData.UserTimings.performanceMarks.find(event => event.name === 'mark1');\n      if (!userMark) {\n        throw new Error('Could not find user mark');\n      }\n\n      const adjustedMarkTime =\n          Timeline.TimelineUIUtils.timeStampForEventAdjustedForClosestNavigationIfPossible(userMark, traceParsedData);\n      assert.strictEqual(adjustedMarkTime.toFixed(2), String(79.88));\n    });\n  });\n\n  function getRowDataForDetailsElement(details: DocumentFragment) {\n    return Array.from(details.querySelectorAll<HTMLDivElement>('.timeline-details-view-row')).map(row => {\n      const title = row.querySelector<HTMLDivElement>('.timeline-details-view-row-title')?.innerText;\n      const value = row.querySelector<HTMLDivElement>('.timeline-details-view-row-value')?.innerText;\n      return {title, value};\n    });\n  }\n\n  function getPieChartDataForDetailsElement(details: DocumentFragment) {\n    const pieChartComp = details.querySelector<HTMLDivElement>('devtools-perf-piechart');\n    if (!pieChartComp?.shadowRoot) {\n      return [];\n    }\n    return Array.from(pieChartComp.shadowRoot.querySelectorAll<HTMLElement>('.pie-chart-legend-row')).map(row => {\n      const title = row.querySelector<HTMLDivElement>('.pie-chart-name')?.innerText;\n      const value = row.querySelector<HTMLDivElement>('.pie-chart-size')?.innerText;\n      return {title, value};\n    });\n  }\n\n  describe('colors', function() {\n    before(() => {\n      // Rather than use the real colours here and burden the test with having to\n      // inject loads of CSS, we fake out the colours. this is fine for our tests as\n      // the exact value of the colours is not important; we just make sure that it\n      // parses them out correctly. Each variable is given a different rgb() value to\n      // ensure we know the code is working and using the right one.\n      const styleElement = document.createElement('style');\n      styleElement.id = 'fake-perf-panel-colors';\n      styleElement.textContent = `\n:root {\n  --app-color-loading: rgb(0 0 0);\n  --app-color-loading-children: rgb(1 1 1);\n  --app-color-scripting: rgb(2 2 2);\n  --app-color-scripting-children: rgb(3 3 3);\n  --app-color-rendering: rgb(4 4 4);\n  --app-color-rendering-children: rgb(5 5 5);\n  --app-color-painting: rgb(6 6 6);\n  --app-color-painting-children: rgb(7 7 7);\n  --app-color-task: rgb(8 8 8);\n  --app-color-task-children: rgb(9 9 9);\n  --app-color-system: rgb(10 10 10);\n  --app-color-system-children: rgb(11 11 11);\n  --app-color-idle: rgb(12 12 12);\n  --app-color-idle-children: rgb(13 13 13);\n  --app-color-async: rgb(14 14 14);\n  --app-color-async-children: rgb(15 15 15);\n  --app-color-other: rgb(16 16 16);\n}\n`;\n      document.documentElement.appendChild(styleElement);\n    });\n\n    after(() => {\n      const styleElementToRemove = document.documentElement.querySelector('#fake-perf-panel-colors');\n      if (styleElementToRemove) {\n        document.documentElement.removeChild(styleElementToRemove);\n      }\n    });\n\n    it('should return the correct rgb value for a corresponding CSS variable', function() {\n      const parsedColor = Timeline.TimelineUIUtils.TimelineUIUtils.categories().scripting.getComputedColorValue();\n      assert.strictEqual('rgb(2 2 2)', parsedColor);\n    });\n\n    it('should return the color as a CSS variable', function() {\n      const cssVariable = Timeline.TimelineUIUtils.TimelineUIUtils.categories().scripting.getCSSValue();\n      assert.strictEqual('var(--app-color-scripting)', cssVariable);\n    });\n\n    it('treats the v8.parseOnBackgroundWaiting as scripting even though it would usually be idle', function() {\n      const event = new TraceEngine.Legacy.ConstructedEvent(\n          'v8,devtools.timeline,disabled-by-default-v8.compile',\n          TimelineModel.TimelineModel.RecordType.StreamingCompileScriptWaiting,\n          TraceEngine.Types.TraceEvents.Phase.COMPLETE, 10, thread);\n\n      assert.strictEqual('rgb(2 2 2)', Timeline.TimelineUIUtils.TimelineUIUtils.eventColor(event));\n    });\n\n    it('assigns the correct color to the swatch of an event\\'s title', async function() {\n      const data = await TraceLoader.allModels(this, 'lcp-web-font.json.gz');\n      const events = data.traceParsedData.Renderer.allTraceEntries;\n      const task = events.find(event => {\n        return event.name.includes('RunTask');\n      });\n      if (!task) {\n        throw new Error('Could not find expected event.');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          task,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n      );\n      const titleSwatch: HTMLElement|null = details.querySelector('.timeline-details-chip-title div');\n      assert.strictEqual(titleSwatch?.style.backgroundColor, 'rgb(10, 10, 10)');\n    });\n    it('assigns the correct color to the swatch of a network request title', async function() {\n      const data = await TraceLoader.allModels(this, 'lcp-web-font.json.gz');\n      const networkRequests = data.traceParsedData.NetworkRequests.byTime;\n      const cssRequest = networkRequests.find(request => {\n        return request.args.data.url === 'http://localhost:3000/app.css';\n      });\n      if (!cssRequest) {\n        throw new Error('Could not find expected network request.');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildSyntheticNetworkRequestDetails(\n          cssRequest,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n      );\n      const titleSwatch: HTMLElement|null = details.querySelector('.timeline-details-chip-title div');\n      assert.strictEqual(titleSwatch?.style.backgroundColor, 'rgb(4, 4, 4)');\n    });\n  });\n\n  describe('testContentMatching', () => {\n    it('matches call frame events based on a regular expression and the contents of the event', async function() {\n      const data = await TraceLoader.allModels(this, 'react-hello-world.json.gz');\n      // Find an event from the trace that represents some work that React did. This\n      // event is not chosen for any particular reason other than it was the example\n      // used in the bug report: crbug.com/1484504\n      const mainThread = getMainThread(data.traceParsedData.Renderer);\n      const performConcurrentWorkEvent = mainThread.entries.find(entry => {\n        if (TraceEngine.Types.TraceEvents.isProfileCall(entry)) {\n          return entry.callFrame.functionName === 'performConcurrentWorkOnRoot';\n        }\n        return false;\n      });\n      if (!performConcurrentWorkEvent) {\n        throw new Error('Could not find expected event');\n      }\n      assert.isTrue(Timeline.TimelineUIUtils.TimelineUIUtils.testContentMatching(\n          performConcurrentWorkEvent, /perfo/, data.traceParsedData));\n    });\n  });\n\n  describe('traceEventDetails', function() {\n    it('shows the interaction ID and INP breakdown metrics for a given interaction', async function() {\n      const data = await TraceLoader.allModels(this, 'one-second-interaction.json.gz');\n      const interactionEvent = data.traceParsedData.UserInteractions.interactionEventsWithNoNesting.find(entry => {\n        return entry.dur === 979974 && entry.type === 'click';\n      });\n      if (!interactionEvent) {\n        throw new Error('Could not find expected event');\n      }\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          interactionEvent,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(rowData, [\n        {\n          title: 'Warning',\n          value: 'Long interaction is indicating poor page responsiveness.',\n        },\n        {\n          title: 'ID',\n          value: '4122',\n        },\n        {\n          title: 'Input delay',\n          value: '1ms',\n        },\n        {\n          title: 'Processing time',\n          value: '977ms',\n        },\n        {\n          title: 'Presentation delay',\n          value: '1.974ms',\n        },\n      ]);\n    });\n\n    it('renders all event data for a generic trace', async function() {\n      const data = await TraceLoader.allModels(this, 'generic-about-tracing.json.gz');\n      const event = data.traceParsedData.Renderer.allTraceEntries.find(entry => {\n        return entry.name === 'ThreadControllerImpl::RunTask';\n      });\n      if (!event) {\n        throw new Error('Could not find event.');\n      }\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          event,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(rowData, [\n        {\n          title: 'chrome_task_annotator',\n          value: '{\"delay_policy\":\"PRECISE\",\"task_delay_us\":7159}',\n        },\n        {\n          title: 'src_file',\n          value: '\"cc/scheduler/scheduler.cc\"',\n        },\n        {\n          title: 'src_func',\n          value: '\"ScheduleBeginImplFrameDeadline\"',\n        },\n      ]);\n    });\n\n    it('renders invalidations correctly', async function() {\n      const data = await TraceLoader.allModels(this, 'style-invalidation-change-attribute.json.gz');\n\n      // Set up a fake DOM so that we can request nodes by backend Ids (even\n      // though we return none, we need to mock these calls else the frontend\n      // will not work.)\n      const documentNode = {nodeId: 1 as Protocol.DOM.BackendNodeId};\n      setMockConnectionResponseHandler('DOM.getDocument', () => ({root: documentNode}));\n      setMockConnectionResponseHandler('DOM.pushNodesByBackendIdsToFrontend', () => {\n        return {\n          nodeIds: [],\n        };\n      });\n\n      const updateLayoutTreeEvent = data.traceParsedData.Renderer.allTraceEntries.find(event => {\n        return TraceEngine.Types.TraceEvents.isTraceEventUpdateLayoutTree(event) &&\n            event.args.beginData?.stackTrace?.[0].functionName === 'testFuncs.changeAttributeAndDisplay';\n      });\n      if (!updateLayoutTreeEvent) {\n        throw new Error('Could not find update layout tree event');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          updateLayoutTreeEvent,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(rowData, [\n        {\n          title: 'Elements Affected',\n          value: '3',\n        },\n        {\n          // The \"Recalculation forced\" Stack trace output would be here but the detailRow helper is\n          // unable to parse it, hence why this returns undefined.\n          title: undefined,\n          value: undefined,\n        },\n        {\n          title: 'Initiated by',\n          value: 'Schedule Style Recalculation',\n        },\n        {\n          title: 'Pending for',\n          value: '7.1 ms',\n        },\n        {\n          title: 'PseudoClass:active',\n          value: 'BUTTON id=\\'changeAttributeAndDisplay\\'',\n        },\n        {\n          title: 'Attribute (dir)',\n          value:\n              'DIV id=\\'testElementFour\\' at chromedevtools.github.io/performance-stories/style-invalidations/app.js:46',\n        },\n        {\n          title: 'Attribute (dir)',\n          value:\n              'DIV id=\\'testElementFive\\' at chromedevtools.github.io/performance-stories/style-invalidations/app.js:47',\n        },\n        {\n          title: 'Element has pending invalidation list',\n          value: 'DIV id=\\'testElementFour\\'',\n        },\n        {\n          title: 'Element has pending invalidation list',\n          value: 'DIV id=\\'testElementFive\\'',\n        },\n      ]);\n    });\n\n    it('renders details for a v8.compile (\"Compile Script\") event', async function() {\n      const data = await TraceLoader.allModels(this, 'user-timings.json.gz');\n      const compileEvent =\n          data.traceParsedData.Renderer.allTraceEntries.find(TraceEngine.Types.TraceEvents.isTraceEventV8Compile);\n      if (!compileEvent) {\n        throw new Error('Could not find expected event');\n      }\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          compileEvent,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(rowData, [\n        {\n          title: 'Script',\n          // URL plus line/col number\n          value: 'chrome-extension://blijaeebfebmkmekmdnehcmmcjnblkeo/lib/utils.js:1:1',\n        },\n        {\n          title: 'Streamed',\n          value: 'false: inline script',\n        },\n        {title: 'Compilation cache status', value: 'script not eligible'},\n      ]);\n    });\n\n    it('renders the details for a layout shift properly', async function() {\n      // Set related CDP methods responses to return our mock document and node.\n      const domModel = target.model(SDK.DOMModel.DOMModel);\n      assertNotNullOrUndefined(domModel);\n      const documentNode = {nodeId: 1 as Protocol.DOM.NodeId};\n      const docc = new SDK.DOMModel.DOMNode(domModel) as SDK.DOMModel.DOMDocument;\n      const domNode2 = new SDK.DOMModel.DOMNode(domModel);\n      const domID = 58 as Protocol.DOM.NodeId;\n      domNode2.id = domID;\n\n      setMockConnectionResponseHandler('DOM.pushNodesByBackendIdsToFrontend', () => ({nodeIds: [domID]}));\n\n      setMockConnectionResponseHandler('DOM.getDocument', () => ({root: documentNode}));\n      await domModel.requestDocument();\n      domModel.registerNode(domNode2);\n      domNode2.init(docc, false, {nodeName: 'A test node name', nodeId: domID} as Protocol.DOM.Node);\n      const data = await TraceLoader.allModels(this, 'cls-single-frame.json.gz');\n      const layoutShift = data.traceParsedData.LayoutShifts.clusters[0].events[0];\n      Common.Linkifier.registerLinkifier({\n        contextTypes() {\n          return [Timeline.CLSLinkifier.CLSRect];\n        },\n        async loadLinkifier() {\n          return Timeline.CLSLinkifier.Linkifier.instance();\n        },\n      });\n      Common.Linkifier.registerLinkifier({\n        contextTypes() {\n          return [\n            SDK.DOMModel.DOMNode,\n          ];\n        },\n        async loadLinkifier() {\n          return Elements.DOMLinkifier.Linkifier.instance();\n        },\n      });\n\n      if (!layoutShift) {\n        throw new Error('Could not find LayoutShift event.');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          layoutShift,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(\n          rowData,\n          [\n            {\n              title: 'Warning',\n              value: 'Cumulative Layout Shifts can result in poor user experiences. It has recently evolved.',\n            },\n            {title: 'Score', value: '0.04218'},\n            {title: 'Cumulative Score', value: '0.04218'},\n            {title: 'Current Cluster ID', value: '1'},\n            {title: 'Current Cluster Score', value: '0.2952'},\n            {title: 'Had recent input', value: 'No'},\n            {title: 'Moved from', value: 'Location: [120,670], Size: [900x900]'},\n            {title: 'Moved to', value: 'Location: [120,1270], Size: [900x478]'},\n            // The related node link value is under shadow root so it\n            // can't be accessed at this point.\n            {title: 'Related Node', value: ''},\n          ],\n      );\n      // Test the related node link.\n      const relatedNodeRow =\n          details.querySelector('.timeline-details-view-row:nth-of-type(9) .timeline-details-view-row-value span')\n              ?.shadowRoot;\n      relatedNodeRow?.querySelector<HTMLDivElement>('div')?.innerText;\n      assert.strictEqual(relatedNodeRow?.querySelector<HTMLDivElement>('div')?.innerText, 'A test node name');\n    });\n\n    it('renders the details for a profile call properly', async function() {\n      Common.Linkifier.registerLinkifier({\n        contextTypes() {\n          return [Timeline.CLSLinkifier.CLSRect];\n        },\n        async loadLinkifier() {\n          return Timeline.CLSLinkifier.Linkifier.instance();\n        },\n      });\n\n      const data = await TraceLoader.allModels(this, 'simple-js-program.json.gz');\n      const rendererHandler = data.traceParsedData.Renderer;\n      if (!rendererHandler) {\n        throw new Error('RendererHandler is undefined');\n      }\n      const [process] = rendererHandler.processes.values();\n      const [thread] = process.threads.values();\n      const profileCalls = thread.entries.filter(entry => TraceEngine.Types.TraceEvents.isProfileCall(entry));\n\n      if (!profileCalls) {\n        throw new Error('Could not find renderer events');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          profileCalls[0],\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(\n          rowData,\n          [\n            {\n              title: 'Function',\n              value: '(anonymous) @ www.google.com:21:17',\n            },\n          ],\n      );\n    });\n\n    it('renders the warning for a trace event in its details', async function() {\n      const data = await TraceLoader.allModels(this, 'simple-js-program.json.gz');\n\n      const events = data.traceParsedData.Renderer?.allTraceEntries;\n      if (!events) {\n        throw new Error('Could not find renderer events');\n      }\n\n      const longTask = events.find(e => (e.dur || 0) > 1_000_000);\n      if (!longTask) {\n        throw new Error('Could not find Long Task event.');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          longTask,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          false,\n          data.traceParsedData,\n      );\n      const rowData = getRowDataForDetailsElement(details);\n      assert.deepEqual(\n          rowData,\n          [\n            {\n              title: 'Warning',\n              value: 'Long task took 1.30\\u00A0s.',\n            },\n          ],\n      );\n    });\n\n    it('shows information for the WebSocketCreate initiator when viewing a WebSocketSendHandshakeRequest event',\n       async function() {\n         const data = await TraceLoader.allModels(this, 'web-sockets.json.gz');\n         const events = data.traceParsedData.Renderer?.allTraceEntries;\n         if (!events) {\n           throw new Error('Could not find renderer events');\n         }\n\n         const sendHandshake = events.find(TraceEngine.Types.TraceEvents.isTraceEventWebSocketSendHandshakeRequest);\n         if (!sendHandshake) {\n           throw new Error('Could not find handshake event.');\n         }\n\n         const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n             sendHandshake,\n             data.timelineModel,\n             new Components.Linkifier.Linkifier(),\n             false,\n             data.traceParsedData,\n         );\n         const rowData = getRowDataForDetailsElement(details);\n         const expectedRowData = [\n           {title: 'URL', value: 'wss://socketsbay.com/wss/v2/1/demo/'},\n           {\n             // The 'First Invalidated' Stack trace output would be here but the detailRow helper is\n             // unable to parse it, hence why this returns undefined.\n             title: undefined,\n             value: undefined,\n           },\n           {title: 'Initiated by', 'value': 'Create WebSocket'},\n           {title: 'Pending for', value: '72.0 ms'},\n         ];\n         assert.deepEqual(\n             rowData,\n             expectedRowData,\n         );\n       });\n\n    it('shows information for the events initiated by WebSocketCreate when viewing a WebSocketCreate event',\n       async function() {\n         const data = await TraceLoader.allModels(this, 'web-sockets.json.gz');\n         const events = data.traceParsedData.Renderer?.allTraceEntries;\n         if (!events) {\n           throw new Error('Could not find renderer events');\n         }\n\n         const sendHandshake = events.find(TraceEngine.Types.TraceEvents.isTraceEventWebSocketCreate);\n         if (!sendHandshake) {\n           throw new Error('Could not find handshake event.');\n         }\n\n         const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n             sendHandshake,\n             data.timelineModel,\n             new Components.Linkifier.Linkifier(),\n             false,\n             data.traceParsedData,\n         );\n         const rowData = getRowDataForDetailsElement(details);\n         const expectedRowData = [\n           {title: 'URL', value: 'wss://socketsbay.com/wss/v2/1/demo/'},\n           // This value looks odd, but it is because the initiator stack trace cannot be\n           // easily represented as a string, so this is OK.\n           {title: undefined, value: undefined},\n           // The 2 entries under \"Initiator for\" are displayed as seperate links and in the UI it is obvious they are seperate\n           {title: 'Initiator for', 'value': 'Send WebSocket Handshake Receive WebSocket Handshake'},\n         ];\n         assert.deepEqual(\n             rowData,\n             expectedRowData,\n         );\n       });\n\n    it('shows the aggregated time information for an event', async function() {\n      const data = await TraceLoader.allModels(this, 'web-dev.json.gz');\n      const event =\n          data.traceParsedData.Renderer?.allTraceEntries.find(e => e.ts === 1020034919877 && e.name === 'RunTask');\n      if (!event) {\n        throw new Error('Could not find renderer events');\n      }\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildTraceEventDetails(\n          event,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n          true,\n          data.traceParsedData,\n      );\n      const pieChartData = getPieChartDataForDetailsElement(details);\n\n      const expectedPieChartData = [\n        {title: 'System (self)', value: '2\\u00A0ms'},\n        {title: 'System (children)', value: '2\\u00A0ms'},\n        {title: 'Rendering', value: '28\\u00A0ms'},\n        {title: 'Painting', value: '2\\u00A0ms'},\n        {title: 'Total', value: '34\\u00A0ms'},\n      ];\n      assert.deepEqual(\n          pieChartData,\n          expectedPieChartData,\n      );\n    });\n  });\n\n  it('can generate details for a frame', async function() {\n    const traceParsedData = await TraceLoader.traceEngine(this, 'web-dev-with-commit.json.gz');\n    const frame = traceParsedData.Frames.frames.at(0);\n    if (!frame) {\n      throw new Error('Could not find expected frame');\n    }\n    const filmStrip = TraceEngine.Extras.FilmStrip.fromTraceData(traceParsedData);\n    const details =\n        Timeline.TimelineUIUtils.TimelineUIUtils.generateDetailsContentForFrame(frame, filmStrip, filmStrip.frames[0]);\n    const container = document.createElement('div');\n    renderElementIntoDOM(container);\n    container.appendChild(details);\n    // Give the image element time to render and load.\n    await doubleRaf();\n    const img = container.querySelector<HTMLImageElement>('.timeline-filmstrip-preview img');\n    assert.isTrue(img?.currentSrc.includes(filmStrip.frames[0].screenshotEvent.args.dataUri));\n\n    const durationRow = container.querySelector<HTMLElement>('[data-row-title=\"Duration\"]');\n    const durationValue = durationRow?.querySelector<HTMLSpanElement>('.timeline-details-view-row-value span');\n    if (!durationValue) {\n      throw new Error('Could not find duration');\n    }\n    // Strip the unicode spaces out and replace with simple spaces for easy\n    // assertions.\n    const value = (durationValue.innerText.replaceAll(/\\s/g, ' '));\n    assert.strictEqual(value, '37.85 ms (at 109.82 ms)');\n  });\n\n  describe('buildNetworkRequestDetails', function() {\n    it('renders the right details for a network event from TraceEngine', async function() {\n      const data = await TraceLoader.allModels(this, 'lcp-web-font.json.gz');\n      const networkRequests = data.traceParsedData.NetworkRequests.byTime;\n      const cssRequest = networkRequests.find(request => {\n        return request.args.data.url === 'http://localhost:3000/app.css';\n      });\n      if (!cssRequest) {\n        throw new Error('Could not find expected network request.');\n      }\n\n      const details = await Timeline.TimelineUIUtils.TimelineUIUtils.buildSyntheticNetworkRequestDetails(\n          cssRequest,\n          data.timelineModel,\n          new Components.Linkifier.Linkifier(),\n      );\n\n      const rowData = getRowDataForDetailsElement(details);\n\n      assert.deepEqual(\n          rowData,\n          [\n            {title: 'URL', value: 'localhost:3000/app.css'},\n            {title: 'Duration', value: '4.075ms (3.08ms network transfer + 995μs resource loading)'},\n            {title: 'Request Method', value: 'GET'},\n            {title: 'Initial Priority', value: 'Highest'},\n            {title: 'Priority', value: 'Highest'},\n            {title: 'Mime Type', value: 'text/css'},\n            {title: 'Encoded Data', value: '402 B'},\n            {title: 'Decoded Body', value: '96 B'},\n          ],\n      );\n    });\n  });\n\n  describe('eventTitle', function() {\n    it('renders the correct title for an EventTiming interaction event', async function() {\n      const data = await TraceLoader.allModels(this, 'slow-interaction-button-click.json.gz');\n      const interactionEvent = data.traceParsedData.UserInteractions.interactionEventsWithNoNesting[0];\n      const details = Timeline.TimelineUIUtils.TimelineUIUtils.eventTitle(interactionEvent);\n      assert.deepEqual(details, 'Pointer');\n    });\n\n    it('will use the resolved function name for a profile node that has a sourcemap', async function() {\n      // Timeline.SourceMapsResolver.SourceMapsResolver.\n      const traceParsedData = await TraceLoader.traceEngine(this, 'slow-interaction-button-click.json.gz');\n\n      const mainThread = getMainThread(traceParsedData.Renderer);\n      const profileEntry = mainThread.entries.find(entry => {\n        return TraceEngine.Types.TraceEvents.isProfileCall(entry);\n      });\n      if (!profileEntry || !TraceEngine.Types.TraceEvents.isProfileCall(profileEntry)) {\n        throw new Error('Could not find a profile entry');\n      }\n\n      // Fake that we resolved the entry's name from a sourcemap.\n      Timeline.SourceMapsResolver.SourceMapsResolver.storeResolvedNodeNameForEntry(\n          profileEntry.pid, profileEntry.tid, profileEntry.nodeId, 'resolved-function-test');\n\n      const title = Timeline.TimelineUIUtils.TimelineUIUtils.eventTitle(profileEntry);\n      assert.strictEqual(title, 'resolved-function-test');\n    });\n  });\n\n  describe('eventStyle', function() {\n    it('returns the correct style for profile calls', async function() {\n      const data = await TraceLoader.allModels(this, 'simple-js-program.json.gz');\n      const rendererHandler = data.traceParsedData.Renderer;\n      if (!rendererHandler) {\n        throw new Error('RendererHandler is undefined');\n      }\n      const [process] = rendererHandler.processes.values();\n      const [thread] = process.threads.values();\n      const profileCalls = thread.entries.filter(entry => TraceEngine.Types.TraceEvents.isProfileCall(entry));\n      const style = Timeline.TimelineUIUtils.TimelineUIUtils.eventStyle(profileCalls[0]);\n      assert.strictEqual(style.category.name, 'scripting');\n      assert.strictEqual(style.category.color, 'rgb(250 204 21 / 100%)');\n    });\n  });\n});\n"]}