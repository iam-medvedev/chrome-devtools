{"version":3,"file":"Initiators.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/timeline/Initiators.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Trace from '../../models/trace/trace.js';\nimport {describeWithEnvironment} from '../../testing/EnvironmentHelpers.js';\nimport {TraceLoader} from '../../testing/TraceLoader.js';\n\nimport * as Timeline from './timeline.js';\n\ndescribeWithEnvironment('Initiators', () => {\n  it('returns the initiator data', async function() {\n    const {parsedTrace} = await TraceLoader.traceEngine(this, 'set-timeout-long-task.json.gz');\n\n    const timerFireEvent =\n        Array.from(parsedTrace.Initiators.eventToInitiator.keys()).find(Trace.Types.Events.isTimerFire);\n    assert.exists(timerFireEvent);\n    const timerInstallEvent = parsedTrace.Initiators.eventToInitiator.get(timerFireEvent);\n    assert.exists(timerInstallEvent);\n    const initiatorData = Timeline.Initiators.initiatorsDataToDraw(parsedTrace, timerFireEvent, [], []);\n\n    assert.deepEqual(initiatorData, [{\n                       event: timerFireEvent,\n                       initiator: timerInstallEvent,\n                     }]);\n  });\n\n  it('returns the initiator data for network requests', async function() {\n    const {parsedTrace} = await TraceLoader.traceEngine(this, 'network-requests-initiators.json.gz');\n\n    // Find the network request to test, it is initiated by `youtube.com`.\n    const event = parsedTrace.NetworkRequests.byTime.find(event => event.ts === 1491680762420);\n    assert.exists(event);\n    // Find the `youtube.com` network request.\n    const initiator = parsedTrace.NetworkRequests.byTime.find(event => event.ts === 1491680629144);\n    assert.exists(initiator);\n    const initiatorData = Timeline.Initiators.initiatorsDataToDrawForNetwork(parsedTrace, event);\n\n    assert.deepEqual(initiatorData, [{event, initiator}]);\n  });\n\n  it('can walk up the tree to find the first parent with an initiator', async function() {\n    const {parsedTrace} = await TraceLoader.traceEngine(this, 'set-timeout-long-task.json.gz');\n\n    // Find any of the fibonnaci() calls; they have a parent\n    // event (TimerFire) that has an initiator.\n    const fibonacciCall = parsedTrace.Renderer.allTraceEntries.find(entry => {\n      return Trace.Types.Events.isProfileCall(entry) && entry.callFrame.functionName === 'fibonacci';\n    });\n    assert.exists(fibonacciCall);\n\n    const timerFireEvent =\n        Array.from(parsedTrace.Initiators.eventToInitiator.keys()).find(Trace.Types.Events.isTimerFire);\n    assert.exists(timerFireEvent);\n    const timerInstallEvent = parsedTrace.Initiators.eventToInitiator.get(timerFireEvent);\n    assert.exists(timerInstallEvent);\n\n    // Find the initator data but starting at the fibonacci()\n    // call.\n    const initiatorsData = Timeline.Initiators.initiatorsDataToDraw(parsedTrace, fibonacciCall, [], []);\n\n    assert.deepEqual(initiatorsData, [{\n                       event: timerFireEvent,\n                       initiator: timerInstallEvent,\n                     }]);\n  });\n\n  it('will walk back through the initiators to find the entire chain', async function() {\n    const {parsedTrace} = await TraceLoader.traceEngine(this, 'nested-initiators.json.gz');\n\n    // Find any of the fibonnaci() calls; they have a parent\n    // event (TimerFire) that has an initiator.\n    const fibonacciCall = parsedTrace.Renderer.allTraceEntries.find(entry => {\n      return Trace.Types.Events.isProfileCall(entry) && entry.callFrame.functionName === 'fibonacci';\n    });\n    assert.exists(fibonacciCall);\n\n    // Find the initators data but starting at the fibonacci()\n    // call. We expect to find two initiatorData objects here:\n    // 1. fibonacci() ===> TimerFire caused by TimerInstall\n    // 2. The TimerInstall from (1), caused by a prior TimerInstall.\n    const initiatorsData = Timeline.Initiators.initiatorsDataToDraw(parsedTrace, fibonacciCall, [], []);\n\n    assert.lengthOf(initiatorsData, 2);\n    for (const initiatorData of initiatorsData) {\n      // Ensure each initiatorData object has TimerInstall>TimerFire event to initiator.\n      assert.strictEqual(initiatorData.event.name, Trace.Types.Events.Name.TIMER_FIRE);\n      assert.strictEqual(initiatorData.initiator.name, Trace.Types.Events.Name.TIMER_INSTALL);\n    }\n  });\n\n  it('will walk forward to find the events initiated by the selected entry', async function() {\n    const {parsedTrace} = await TraceLoader.traceEngine(this, 'nested-initiators.json.gz');\n\n    // Find any of the InstallTimer calls; they initiate other events.\n    const timerInstall = parsedTrace.Renderer.allTraceEntries.find(entry => {\n      return entry.name === Trace.Types.Events.Name.TIMER_INSTALL;\n    });\n    assert.exists(timerInstall);\n\n    // Find the initatorData objects starting at the TimerInstall\n    // call. We expect to find one initatorData here:\n    // TimerFire that was initiated by the entry we found - TimerInstall\n\n    const initatorsData = Timeline.Initiators.initiatorsDataToDraw(parsedTrace, timerInstall, [], []);\n\n    assert.lengthOf(initatorsData, 1);\n    for (const initatorData of initatorsData) {\n      // Ensure each initiatorData object has TimerInstall>TimerFire event to initiator.\n      assert.strictEqual(initatorData.event.name, Trace.Types.Events.Name.TIMER_FIRE);\n      assert.strictEqual(initatorData.initiator.name, Trace.Types.Events.Name.TIMER_INSTALL);\n    }\n  });\n\n  it('will return the closest expandable ancestor as an initiator in a pair if the initiator itself is hidden',\n     async function() {\n       const {parsedTrace} = await TraceLoader.traceEngine(this, 'nested-initiators.json.gz');\n\n       // Find any of the InstallTimer calls; they initiate other events.\n       const timerInstall = parsedTrace.Renderer.allTraceEntries.find(entry => {\n         return entry.name === Trace.Types.Events.Name.TIMER_INSTALL;\n       });\n       assert.exists(timerInstall);\n       // Get the parent of InstallTimer to add to the expandable events array.\n       // When we add TimerInstall to hidden entries list, it will be the closest expandable parent and the initiator should point to it.\n       const timerInstallParent = parsedTrace.Renderer.entryToNode.get(timerInstall)?.parent;\n       assert.exists(timerInstallParent);\n\n       // Find the initatorData objects starting at the TimerInstall\n       // call. We expect to find one initatorData here:\n       // TimerFire that was initiated by the entry we found - Parent of TimerInstall because TimerInstall is hidden\n       const initiatorsData = Timeline.Initiators.initiatorsDataToDraw(\n           parsedTrace, timerInstall, [timerInstall], [timerInstallParent?.entry]);\n\n       assert.lengthOf(initiatorsData, 1);\n       // Ensure each initiatorData object has TimerInstall>TimerFire event to initiator.\n       for (const initiatorData of initiatorsData) {\n         assert.strictEqual(initiatorData.event.name, Trace.Types.Events.Name.TIMER_FIRE);\n         assert.strictEqual(initiatorData.initiator, timerInstallParent.entry);\n         // Ensure the expandable entry is marked as hidden\n         assert.strictEqual(initiatorData.isInitiatorHidden, true);\n       }\n     });\n\n  it('will return the closest expandable ancestor as an initiated event in a pair if the event itself is hidden',\n     async function() {\n       const {parsedTrace} = await TraceLoader.traceEngine(this, 'nested-initiators.json.gz');\n\n       // Find any of the fibonnaci() calls; they have a parent\n       // event (TimerFire) that has an initiator.\n       const fibonacciCall = parsedTrace.Renderer.allTraceEntries.find(entry => {\n         return Trace.Types.Events.isProfileCall(entry) && entry.callFrame.functionName === 'fibonacci';\n       });\n       assert.exists(fibonacciCall);\n\n       // Find the initatorData objects but starting at the fibonacci()\n       // call. We expect to find two initiatorData objects here:\n       // 1. fibonacci() ===> TimerFire caused by TimerInstall\n       // 2. The TimerInstall from (1), caused by a prior TimerInstall.\n       let initiatorsData = Timeline.Initiators.initiatorsDataToDraw(parsedTrace, fibonacciCall, [], []);\n\n       assert.lengthOf(initiatorsData, 2);\n       // Save the parents of initiated events and the events themselves to get initiators again with those as expandable and hidden\n       const timerFireParents: Trace.Types.Events.Event[] = [];\n       const initiatedEvents: Trace.Types.Events.Event[] = [];\n\n       for (const initiatorData of initiatorsData) {\n         // Ensure each initiatorData object has TimerInstall>TimerFire event to initiator.\n         assert.strictEqual(initiatorData.event.name, Trace.Types.Events.Name.TIMER_FIRE);\n         assert.strictEqual(initiatorData.initiator.name, Trace.Types.Events.Name.TIMER_INSTALL);\n         const parentEvent = parsedTrace.Renderer.entryToNode.get(initiatorData.event)?.parent?.entry;\n         if (parentEvent) {\n           timerFireParents.push(parentEvent);\n           initiatedEvents.push(initiatorData.event);\n         }\n       }\n\n       // Get initiatorData object again, now with the previously initiated events hidden and parents marked as expandable\n       initiatorsData =\n           Timeline.Initiators.initiatorsDataToDraw(parsedTrace, fibonacciCall, initiatedEvents, timerFireParents);\n       // The length should not change, just the inititated events.\n       assert.lengthOf(initiatorsData, 2);\n       for (let i = 0; i < initiatorsData.length; i++) {\n         const initiatorData = initiatorsData[i];\n         // Ensure each initiatorData object has TimerInstall>TimerFire event to initiator.\n         assert.strictEqual(initiatorData.event, timerFireParents[i]);\n         assert.strictEqual(initiatorData.initiator.name, Trace.Types.Events.Name.TIMER_INSTALL);\n         // Ensure the expandable entry is marked as hidden\n         assert.strictEqual(initiatorData.isEntryHidden, true);\n       }\n     });\n});\n"]}