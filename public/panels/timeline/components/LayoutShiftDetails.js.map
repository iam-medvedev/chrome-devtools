{"version":3,"file":"LayoutShiftDetails.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/LayoutShiftDetails.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport type * as Protocol from '../../../generated/protocol.js';\nimport * as Helpers from '../../../models/trace/helpers/helpers.js';\nimport * as Trace from '../../../models/trace/trace.js';\nimport * as LegacyComponents from '../../../ui/legacy/components/utils/utils.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nimport * as EntryName from './EntryName.js';\nimport * as Insights from './insights/insights.js';\nimport layoutShiftDetailsStyles from './layoutShiftDetails.css.js';\n\nconst MAX_URL_LENGTH = 20;\n\nconst UIStrings = {\n  /**\n   * @description Text indicating an insight.\n   */\n  insight: 'Insight',\n  /**\n   * @description Title indicating the Layout shift culprits insight.\n   */\n  layoutShiftCulprits: 'Layout shift culprits',\n  /**\n   * @description Text referring to the start time of a given event.\n   */\n  startTime: 'Start time',\n  /**\n   * @description Text for a table header referring to the score of a Layout Shift event.\n   */\n  shiftScore: 'Shift score',\n  /**\n   * @description Text for a table header referring to the elements shifted for a Layout Shift event.\n   */\n  elementsShifted: 'Elements shifted',\n  /**\n   * @description Text for a table header referring to the culprit of a Layout Shift event.\n   */\n  culprit: 'Culprit',\n  /**\n   * @description Text for a culprit type of Injected iframe.\n   */\n  injectedIframe: 'Injected iframe',\n  /**\n   * @description Text for a culprit type of Font request.\n   */\n  fontRequest: 'Font request',\n  /**\n   * @description Text for a culprit type of non-composited animation.\n   */\n  nonCompositedAnimation: 'Non-composited animation',\n  /**\n   * @description Text referring to an animation.\n   */\n  animation: 'Animation',\n  /**\n   * @description Text referring to the duration of a given event.\n   */\n  duration: 'Duration',\n  /**\n   * @description Text referring to a parent cluster.\n   */\n  parentCluster: 'Parent cluster',\n  /**\n   * @description Text referring to a layout shift cluster and its start time.\n   * @example {32 ms} PH1\n   */\n  cluster: 'Layout shift cluster @ {PH1}',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/components/LayoutShiftDetails.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class LayoutShiftDetails extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-performance-layout-shift-details`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  #event: Trace.Types.Events.SyntheticLayoutShift|Trace.Types.Events.SyntheticLayoutShiftCluster|null = null;\n  #traceInsightsSets: Trace.Insights.Types.TraceInsightSets|null = null;\n  #parsedTrace: Trace.Handlers.Types.ParsedTrace|null = null;\n  #isFreshRecording: Boolean = false;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [layoutShiftDetailsStyles];\n    // Styles for linkifier button.\n    UI.UIUtils.injectTextButtonStyles(this.#shadow);\n    this.#render();\n  }\n\n  setData(\n      event: Trace.Types.Events.SyntheticLayoutShift|Trace.Types.Events.SyntheticLayoutShiftCluster,\n      traceInsightsSets: Trace.Insights.Types.TraceInsightSets|null, parsedTrace: Trace.Handlers.Types.ParsedTrace|null,\n      isFreshRecording: Boolean): void {\n    if (this.#event === event) {\n      return;\n    }\n    this.#event = event;\n    this.#traceInsightsSets = traceInsightsSets;\n    this.#parsedTrace = parsedTrace;\n    this.#isFreshRecording = isFreshRecording;\n    this.#render();\n  }\n\n  #renderInsightChip(): LitHtml.TemplateResult|null {\n    if (!this.#event) {\n      return null;\n    }\n\n    // clang-format off\n    return LitHtml.html`\n      <div class=\"insight-chip\">\n        <div class=\"insight-keyword\">${i18nString(UIStrings.insight)} </div>${i18nString(UIStrings.layoutShiftCulprits)}</div>\n    `;\n    // clang-format on\n  }\n\n  #renderTitle(event: Trace.Types.Events.SyntheticLayoutShift|\n               Trace.Types.Events.SyntheticLayoutShiftCluster): LitHtml.TemplateResult {\n    const title = EntryName.nameForEntry(event);\n    return LitHtml.html`\n      <div class=\"layout-shift-details-title\">\n        <div class=\"layout-shift-event-title\"></div>\n        ${title}\n      </div>\n    `;\n  }\n\n  #renderShiftedElements(elementsShifted: Trace.Types.Events.TraceImpactedNode[]|undefined): LitHtml.LitTemplate {\n    // clang-format off\n    return LitHtml.html`\n      ${elementsShifted?.map(el => {\n        if (el.node_id !== undefined) {\n          return LitHtml.html`\n            <${Insights.NodeLink.NodeLink.litTagName}\n              .data=${{\n                backendNodeId: el.node_id,\n              } as Insights.NodeLink.NodeLinkData}>\n            </${Insights.NodeLink.NodeLink.litTagName}>`;\n        }\n          return LitHtml.nothing;\n      })}`;\n    // clang-format on\n  }\n\n  #renderIframe(iframeId: string): LitHtml.TemplateResult|null {\n    const domLoadingId = iframeId as Protocol.Page.FrameId;\n    if (!domLoadingId) {\n      return null;\n    }\n\n    const domLoadingFrame = SDK.FrameManager.FrameManager.instance().getFrame(domLoadingId);\n    if (!domLoadingFrame) {\n      return null;\n    }\n    const el = LegacyComponents.Linkifier.Linkifier.linkifyRevealable(domLoadingFrame, domLoadingFrame.displayName());\n    // clang-format off\n    return LitHtml.html`\n    <span class=\"culprit\"><span class=\"culprit-type\">${i18nString(UIStrings.injectedIframe)}: </span><span class=\"culprit-value\">${el}</span></span>`;\n    // clang-format on\n  }\n\n  #renderFontRequest(request: Trace.Types.Events.SyntheticNetworkRequest): LitHtml.TemplateResult|null {\n    const options = {\n      tabStop: true,\n      showColumnNumber: false,\n      inlineFrameIndex: 0,\n      maxLength: MAX_URL_LENGTH,\n    };\n\n    const linkifiedURL = LegacyComponents.Linkifier.Linkifier.linkifyURL(\n        request.args.data.url as Platform.DevToolsPath.UrlString, options);\n\n    // clang-format off\n    return LitHtml.html`\n    <span class=\"culprit\"><span class=\"culprit-type\">${i18nString(UIStrings.fontRequest)}: </span><span class=\"culprit-value\">${linkifiedURL}</span></span>`;\n    // clang-format on\n  }\n\n  #clickEvent(event: Trace.Types.Events.Event): void {\n    this.dispatchEvent(new Insights.Helpers.EventReferenceClick(event));\n  }\n\n  #renderAnimation(failure: Trace.Insights.InsightRunners.CumulativeLayoutShift.NoncompositedAnimationFailure):\n      LitHtml.TemplateResult|null {\n    const event = failure.animation;\n    if (!event) {\n      return null;\n    }\n    // clang-format off\n    return LitHtml.html`\n      ${LitHtml.html`\n        <span class=\"culprit\">\n        <span class=\"culprit-type\">${i18nString(UIStrings.nonCompositedAnimation)}: </span>\n        <span class=\"culprit-value devtools-link\" @click=${() => this.#clickEvent(event)}>${i18nString(UIStrings.animation)}</span>\n      </span>`\n    }`;\n    // clang-format on\n  }\n\n  #renderRootCauseValues(rootCauses: Trace.Insights.InsightRunners.CumulativeLayoutShift.LayoutShiftRootCausesData|\n                         undefined): LitHtml.TemplateResult|null {\n    return LitHtml.html`\n      ${rootCauses?.fontRequests.map(fontReq => this.#renderFontRequest(fontReq))}\n      ${rootCauses?.iframeIds.map(iframe => this.#renderIframe(iframe))}\n      ${rootCauses?.nonCompositedAnimations.map(failure => this.#renderAnimation(failure))}\n    `;\n  }\n\n  #renderParentCluster(\n      cluster: Trace.Types.Events.SyntheticLayoutShiftCluster|undefined,\n      parsedTrace: Trace.Handlers.Types.ParsedTrace): LitHtml.TemplateResult|null {\n    if (!cluster) {\n      return null;\n    }\n    const ts = Trace.Types.Timing.MicroSeconds(cluster.ts - (parsedTrace?.Meta.traceBounds.min ?? 0));\n    const clusterTs = i18n.TimeUtilities.formatMicroSecondsTime(ts);\n\n    // clang-format off\n    return LitHtml.html`\n      <span class=\"parent-cluster\">${i18nString(UIStrings.parentCluster)}:\n         <span class=\"devtools-link\" @click=${() => this.#clickEvent(cluster)}>${i18nString(UIStrings.cluster, {PH1: clusterTs})}</span>\n      </span>`;\n    // clang-format on\n  }\n\n  #renderShiftDetails(\n      layoutShift: Trace.Types.Events.SyntheticLayoutShift,\n      traceInsightsSets: Trace.Insights.Types.TraceInsightSets|null,\n      parsedTrace: Trace.Handlers.Types.ParsedTrace,\n      ): LitHtml.TemplateResult|null {\n    if (!traceInsightsSets) {\n      return null;\n    }\n    const score = layoutShift.args.data?.weighted_score_delta;\n    if (!score) {\n      return null;\n    }\n\n    const ts = Trace.Types.Timing.MicroSeconds(layoutShift.ts - parsedTrace.Meta.traceBounds.min);\n    const insightsId = layoutShift.args.data?.navigationId ?? Trace.Types.Events.NO_NAVIGATION;\n    const clsInsight = traceInsightsSets.get(insightsId)?.data.CumulativeLayoutShift;\n    if (clsInsight instanceof Error) {\n      return null;\n    }\n\n    const rootCauses = clsInsight?.shifts?.get(layoutShift);\n    const elementsShifted = layoutShift.args.data?.impacted_nodes;\n    const hasCulprits = rootCauses &&\n        (rootCauses.fontRequests.length || rootCauses.iframeIds.length || rootCauses.nonCompositedAnimations.length);\n    const hasShiftedElements = elementsShifted?.length;\n\n    const parentCluster = clsInsight?.clusters.find(cluster => {\n      return cluster.events.find(event => event === layoutShift);\n    });\n\n    // clang-format off\n    return LitHtml.html`\n      <table class=\"layout-shift-details-table\">\n        <thead class=\"table-title\">\n          <tr>\n            <th>${i18nString(UIStrings.startTime)}</th>\n            <th>${i18nString(UIStrings.shiftScore)}</th>\n            ${hasShiftedElements && this.#isFreshRecording ? LitHtml.html`\n              <th>${i18nString(UIStrings.elementsShifted)}</th>` : LitHtml.nothing}\n            ${hasCulprits && this.#isFreshRecording ? LitHtml.html`\n              <th>${i18nString(UIStrings.culprit)}</th> ` : LitHtml.nothing}\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td>${i18n.TimeUtilities.preciseMillisToString(Helpers.Timing.microSecondsToMilliseconds(ts))}</td>\n            <td>${(score.toPrecision(4))}</td>\n            ${this.#isFreshRecording ? LitHtml.html`\n              <td>\n                <div class=\"elements-shifted\">\n                  ${this.#renderShiftedElements(elementsShifted)}\n                </div>\n              </td>` : LitHtml.nothing}\n            ${this.#isFreshRecording ? LitHtml.html`\n              <td class=\"culprits\">\n                ${this.#renderRootCauseValues(rootCauses)}\n              </td>` : LitHtml.nothing}\n          </tr>\n        </tbody>\n      </table>\n      ${this.#renderParentCluster(parentCluster, parsedTrace)}\n    `;\n    // clang-format on\n  }\n\n  #renderClusterDetails(\n      cluster: Trace.Types.Events.SyntheticLayoutShiftCluster,\n      parsedTrace: Trace.Handlers.Types.ParsedTrace): LitHtml.TemplateResult|null {\n    const ts = Trace.Types.Timing.MicroSeconds(cluster.ts - parsedTrace.Meta.traceBounds.min);\n    const dur = cluster.dur ?? Trace.Types.Timing.MicroSeconds(0);\n\n    // clang-format off\n    return LitHtml.html`\n        <div class=\"cluster-details\">\n            <div class=\"details-row\"><div class=\"title\">${i18nString(UIStrings.startTime)}</div><div class=\"value\">${i18n.TimeUtilities.preciseMillisToString(Helpers.Timing.microSecondsToMilliseconds(ts))}</div></div>\n            <div class=\"details-row\"><div class=\"title\">${i18nString(UIStrings.duration)}</div><div class=\"value\">${i18n.TimeUtilities.preciseMillisToString(Helpers.Timing.microSecondsToMilliseconds(dur))}</div></div>\n        </div>\n    `;\n    // clang-format on\n  }\n\n  #renderDetails(\n      event: Trace.Types.Events.SyntheticLayoutShift|Trace.Types.Events.SyntheticLayoutShiftCluster,\n      traceInsightsSets: Trace.Insights.Types.TraceInsightSets|null,\n      parsedTrace: Trace.Handlers.Types.ParsedTrace,\n      ): LitHtml.TemplateResult|null {\n    if (Trace.Types.Events.isSyntheticLayoutShift(event)) {\n      return this.#renderShiftDetails(event, traceInsightsSets, parsedTrace);\n    }\n    return this.#renderClusterDetails(event, parsedTrace);\n  }\n\n  #render(): void {\n    if (!this.#event || !this.#parsedTrace) {\n      return;\n    }\n    // clang-format off\n    const output = LitHtml.html`\n      <div class=\"layout-shift-summary-details\">\n        <div class=\"event-details\">\n          ${this.#renderTitle(this.#event)}\n          ${this.#renderDetails(this.#event, this.#traceInsightsSets, this.#parsedTrace)}\n        </div>\n        <div class=\"insight-categories\">\n          ${this.#renderInsightChip()}\n        </div>\n      </div>\n    `;\n    // clang-format on\n    LitHtml.render(output, this.#shadow, {host: this});\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-performance-layout-shift-details': LayoutShiftDetails;\n  }\n}\n\ncustomElements.define('devtools-performance-layout-shift-details', LayoutShiftDetails);\n"]}