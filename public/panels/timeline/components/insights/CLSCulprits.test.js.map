{"version":3,"file":"CLSCulprits.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/panels/timeline/components/insights/CLSCulprits.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,EACL,oCAAoC,EACpC,oBAAoB,GACrB,MAAM,mCAAmC,CAAC;AAC3C,OAAO,EAAC,uBAAuB,EAAC,MAAM,2CAA2C,CAAC;AAClF,OAAO,EAAC,WAAW,EAAC,MAAM,oCAAoC,CAAC;AAE/D,OAAO,KAAK,QAAQ,MAAM,eAAe,CAAC;AAE1C,uBAAuB,CAAC,uBAAuB,EAAE,GAAG,EAAE;IACpD,EAAE,CAAC,gCAAgC,EAAE,KAAK;QACxC,MAAM,SAAS,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,wBAAwB,CAAC,CAAC;QAChF,MAAM,gBAAgB,GAAG,SAAS,CAAC,QAAQ,EAAE,MAAM,EAAE,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC;QACpE,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAC9B,MAAM,QAAQ,GAAG,gBAAgB,CAAC,KAAK,CAAC,WAAW,CAAC;QACpD,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QACtB,MAAM,SAAS,GAAG,IAAI,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC;QACzD,SAAS,CAAC,KAAK,GAAG,QAAQ,CAAC;QAC3B,SAAS,CAAC,aAAa,GAAG,gBAAgB,CAAC,EAAE,CAAC;QAC9C,SAAS,CAAC,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;QACnD,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC;QAE1B,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAChC,MAAM,SAAS,CAAC,cAAc,CAAC;QAC/B,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;QAE1C,MAAM,SAAS,GAAG,oCAAoC,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;QACvG,MAAM,CAAC,WAAW,CAAC,SAAS,EAAE,uBAAuB,CAAC,CAAC;QAEvD,MAAM,gBAAgB,GAAG,oCAAoC,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;QAC9G,MAAM,CAAC,WAAW,CAAC,gBAAgB,EAAE,8CAA8C,CAAC,CAAC;QAErF,MAAM,YAAY,GAAG,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,aAAa,CAAc,iBAAiB,CAAC,CAAC;QAChG,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAC1B,MAAM,CAAC,WAAW,CACd,YAAY,CAAC,aAAa,EAAE,EAC5B,+CAA+C;YAC3C,6CAA6C,CAAC,CAAC;IACzD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {\n  getCleanTextContentFromSingleElement,\n  renderElementIntoDOM,\n} from '../../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../../testing/EnvironmentHelpers.js';\nimport {TraceLoader} from '../../../../testing/TraceLoader.js';\n\nimport * as Insights from './insights.js';\n\ndescribeWithEnvironment('CLSCulprits component', () => {\n  it('renders unsized image culprits', async function() {\n    const traceData = await TraceLoader.traceEngine(this, 'unsized-images.json.gz');\n    const firstNavInsights = traceData.insights?.values().next()?.value;\n    assert.isOk(firstNavInsights);\n    const clsModel = firstNavInsights.model.CLSCulprits;\n    assert.isOk(clsModel);\n    const component = new Insights.CLSCulprits.CLSCulprits();\n    component.model = clsModel;\n    component.insightSetKey = firstNavInsights.id;\n    component.bounds = traceData.data.Meta.traceBounds;\n    component.selected = true;\n\n    renderElementIntoDOM(component);\n    await component.updateComplete;\n    assert.isOk(component.element.shadowRoot);\n\n    const titleText = getCleanTextContentFromSingleElement(component.element.shadowRoot, '.insight-title');\n    assert.strictEqual(titleText, 'Layout shift culprits');\n\n    const worstClusterText = getCleanTextContentFromSingleElement(component.element.shadowRoot, '.worst-cluster');\n    assert.strictEqual(worstClusterText, 'Worst cluster: Layout shift cluster @ 1.37 s');\n\n    const culpritsList = component.element.shadowRoot.querySelector<HTMLElement>('.worst-culprits');\n    assert.isOk(culpritsList);\n    assert.strictEqual(\n        culpritsList.deepInnerText(),\n        'Unsized image element\\ncuzillion.…wfQ%3D%3D\\n' +\n            'Unsized image element\\ncuzillion.…wfQ%3D%3D');\n  });\n});\n"]}