{"version":3,"file":"OriginMap.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/OriginMap.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../../ui/components/icon_button/icon_button.js';\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as CrUXManager from '../../../models/crux-manager/crux-manager.js';\nimport * as RenderCoordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\n\nimport originMapStyles from './originMap.css.js';\n\nconst {html} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Title for a column in a data table representing a site origin used for development\n   */\n  developmentOrigin: 'Development origin',\n  /**\n   * @description Title for a column in a data table representing a site origin used by real users in a production environment\n   */\n  productionOrigin: 'Production origin',\n  /**\n   * @description Warning message explaining that an input origin is not a valid origin or URL.\n   * @example {http//malformed.com} PH1\n   */\n  invalidOrigin: '\"{PH1}\" is not a valid origin or URL.',\n  /**\n   * @description Warning message explaining that an development origin is already mapped to a productionOrigin.\n   * @example {https://example.com} PH1\n   */\n  alreadyMapped: '\"{PH1}\" is already mapped to a production origin.',\n  /**\n   * @description Warning message explaining that a page doesn't have enough real user data to show any information for. \"Chrome UX Report\" is a product name and should not be translated.\n   */\n  pageHasNoData: 'The Chrome UX Report does not have sufficient real user data for this page.',\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/timeline/components/OriginMap.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst DEV_ORIGIN_CONTROL = 'developmentOrigin';\nconst PROD_ORIGIN_CONTROL = 'productionOrigin';\n\ninterface ListItem extends CrUXManager.OriginMapping {\n  isTitleRow?: boolean;\n}\n\nexport class OriginMap extends UI.Widget.WidgetElement<UI.Widget.Widget> implements UI.ListWidget.Delegate<ListItem> {\n  #list: UI.ListWidget.ListWidget<ListItem>;\n  #editor?: UI.ListWidget.Editor<ListItem>;\n\n  constructor() {\n    super();\n\n    this.#list = new UI.ListWidget.ListWidget<ListItem>(this, false /* delegatesFocus */, true /* isTable */);\n\n    CrUXManager.CrUXManager.instance().getConfigSetting().addChangeListener(this.#updateListFromSetting, this);\n    this.#updateListFromSetting();\n  }\n\n  override createWidget(): UI.Widget.Widget {\n    const containerWidget = new UI.Widget.Widget(false, false, this);\n\n    this.#list.registerRequiredCSS(originMapStyles);\n    this.#list.show(containerWidget.contentElement);\n\n    return containerWidget;\n  }\n\n  #pullMappingsFromSetting(): ListItem[] {\n    return CrUXManager.CrUXManager.instance().getConfigSetting().get().originMappings || [];\n  }\n\n  #pushMappingsToSetting(originMappings: ListItem[]): void {\n    const setting = CrUXManager.CrUXManager.instance().getConfigSetting();\n    const settingCopy = {...setting.get()};\n    settingCopy.originMappings = originMappings;\n    setting.set(settingCopy);\n  }\n\n  #updateListFromSetting(): void {\n    const mappings = this.#pullMappingsFromSetting();\n    this.#list.clear();\n    this.#list.appendItem(\n        {\n          developmentOrigin: i18nString(UIStrings.developmentOrigin),\n          productionOrigin: i18nString(UIStrings.productionOrigin),\n          isTitleRow: true,\n        },\n        false);\n    for (const originMapping of mappings) {\n      this.#list.appendItem(originMapping, true);\n    }\n  }\n\n  #getOrigin(url: string): string|null {\n    try {\n      return new URL(url).origin;\n    } catch {\n      return null;\n    }\n  }\n\n  #renderOriginWarning(url: string): Promise<Lit.LitTemplate> {\n    return RenderCoordinator.write(async () => {\n      if (!CrUXManager.CrUXManager.instance().isEnabled()) {\n        return Lit.nothing;\n      }\n\n      const cruxManager = CrUXManager.CrUXManager.instance();\n      const result = await cruxManager.getFieldDataForPage(url);\n\n      const hasFieldData = Object.entries(result).some(([key, value]) => {\n        if (key === 'warnings') {\n          return false;\n        }\n        return Boolean(value);\n      });\n      if (hasFieldData) {\n        return Lit.nothing;\n      }\n\n      return html`\n        <devtools-icon\n          class=\"origin-warning-icon\"\n          name=\"warning-filled\"\n          title=${i18nString(UIStrings.pageHasNoData)}\n        ></devtools-icon>\n      `;\n    });\n  }\n\n  startCreation(): void {\n    const targetManager = SDK.TargetManager.TargetManager.instance();\n    const inspectedURL = targetManager.inspectedURL();\n    const currentOrigin = this.#getOrigin(inspectedURL) || '';\n\n    this.#list.addNewItem(-1, {\n      developmentOrigin: currentOrigin,\n      productionOrigin: '',\n    });\n  }\n\n  renderItem(originMapping: ListItem): Element {\n    const element = document.createElement('div');\n    element.classList.add('origin-mapping-row');\n    element.role = 'row';\n\n    let cellRole: 'columnheader'|'cell';\n    let warningIcon;\n    if (originMapping.isTitleRow) {\n      element.classList.add('header');\n      cellRole = 'columnheader';\n      warningIcon = Lit.nothing;\n    } else {\n      cellRole = 'cell';\n      warningIcon = Lit.Directives.until(this.#renderOriginWarning(originMapping.productionOrigin));\n    }\n\n    // clang-format off\n    Lit.render(html`\n      <div class=\"origin-mapping-cell development-origin\" role=${cellRole}>\n        <div class=\"origin\" title=${originMapping.developmentOrigin}>${originMapping.developmentOrigin}</div>\n      </div>\n      <div class=\"origin-mapping-cell production-origin\" role=${cellRole}>\n        ${warningIcon}\n        <div class=\"origin\" title=${originMapping.productionOrigin}>${originMapping.productionOrigin}</div>\n      </div>\n    `, element, {host: this});\n    // clang-format on\n    return element;\n  }\n\n  removeItemRequested(_item: ListItem, index: number): void {\n    const mappings = this.#pullMappingsFromSetting();\n\n    // `index` will be 1-indexed due to the header row\n    mappings.splice(index - 1, 1);\n\n    this.#pushMappingsToSetting(mappings);\n  }\n\n  commitEdit(originMapping: ListItem, editor: UI.ListWidget.Editor<ListItem>, isNew: boolean): void {\n    originMapping.developmentOrigin = this.#getOrigin(editor.control(DEV_ORIGIN_CONTROL).value) || '';\n    originMapping.productionOrigin = this.#getOrigin(editor.control(PROD_ORIGIN_CONTROL).value) || '';\n\n    const mappings = this.#pullMappingsFromSetting();\n    if (isNew) {\n      mappings.push(originMapping);\n    }\n    this.#pushMappingsToSetting(mappings);\n  }\n\n  beginEdit(originMapping: ListItem): UI.ListWidget.Editor<ListItem> {\n    const editor = this.#createEditor();\n    editor.control(DEV_ORIGIN_CONTROL).value = originMapping.developmentOrigin;\n    editor.control(PROD_ORIGIN_CONTROL).value = originMapping.productionOrigin;\n    return editor;\n  }\n\n  #developmentValidator(_item: ListItem, index: number, input: UI.ListWidget.EditorControl):\n      UI.ListWidget.ValidatorResult {\n    const origin = this.#getOrigin(input.value);\n\n    if (!origin) {\n      return {valid: false, errorMessage: i18nString(UIStrings.invalidOrigin, {PH1: input.value})};\n    }\n\n    const mappings = this.#pullMappingsFromSetting();\n    for (let i = 0; i < mappings.length; ++i) {\n      // `index` will be 1-indexed due to the header row\n      if (i === index - 1) {\n        continue;\n      }\n\n      const mapping = mappings[i];\n      if (mapping.developmentOrigin === origin) {\n        return {valid: true, errorMessage: i18nString(UIStrings.alreadyMapped, {PH1: origin})};\n      }\n    }\n\n    return {valid: true};\n  }\n\n  #productionValidator(_item: ListItem, _index: number, input: UI.ListWidget.EditorControl):\n      UI.ListWidget.ValidatorResult {\n    const origin = this.#getOrigin(input.value);\n\n    if (!origin) {\n      return {valid: false, errorMessage: i18nString(UIStrings.invalidOrigin, {PH1: input.value})};\n    }\n\n    return {valid: true};\n  }\n\n  #createEditor(): UI.ListWidget.Editor<ListItem> {\n    if (this.#editor) {\n      return this.#editor;\n    }\n\n    const editor = new UI.ListWidget.Editor<ListItem>();\n    this.#editor = editor;\n    const content = editor.contentElement().createChild('div', 'origin-mapping-editor');\n\n    const devInput = editor.createInput(\n        DEV_ORIGIN_CONTROL, 'text', i18nString(UIStrings.developmentOrigin), this.#developmentValidator.bind(this));\n    const prodInput = editor.createInput(\n        PROD_ORIGIN_CONTROL, 'text', i18nString(UIStrings.productionOrigin), this.#productionValidator.bind(this));\n\n    // clang-format off\n    Lit.render(html`\n      <label class=\"development-origin-input\">\n        ${i18nString(UIStrings.developmentOrigin)}\n        ${devInput}\n      </label>\n      <label class=\"production-origin-input\">\n        ${i18nString(UIStrings.productionOrigin)}\n        ${prodInput}\n      </label>\n    `, content, {host: this});\n    // clang-format on\n\n    return editor;\n  }\n}\n\ncustomElements.define('devtools-origin-map', OriginMap);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-origin-map': OriginMap;\n  }\n}\n"]}