{"version":3,"file":"LiveMetricsView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/LiveMetricsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport * as LiveMetrics from '../../../models/live-metrics/live-metrics.js';\nimport * as ComponentHelpers from '../../../ui/components/helpers/helpers.js';\nimport * as LitHtml from '../../../ui/lit-html/lit-html.js';\n\nconst {html, nothing, Directives} = LitHtml;\nconst {until} = Directives;\n\nexport class LiveMetricsView extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-live-metrics-view`;\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  #liveMetrics: LiveMetrics.LiveMetrics = new LiveMetrics.LiveMetrics();\n\n  #lcpValue?: LiveMetrics.LCPChangeEvent;\n  #clsValue?: LiveMetrics.CLSChangeEvent;\n  #inpValue?: LiveMetrics.INPChangeEvent;\n\n  #onReset = (): void => {\n    this.#lcpValue = undefined;\n    this.#clsValue = undefined;\n    this.#inpValue = undefined;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  };\n\n  #onLcpChange = (event: {data: LiveMetrics.LCPChangeEvent}): void => {\n    this.#lcpValue = event.data;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  };\n\n  #onClsChange = (event: {data: LiveMetrics.CLSChangeEvent}): void => {\n    this.#clsValue = event.data;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  };\n\n  #onInpChange = (event: {data: LiveMetrics.INPChangeEvent}): void => {\n    this.#inpValue = event.data;\n    void ComponentHelpers.ScheduledRender.scheduleRender(this, this.#render);\n  };\n\n  connectedCallback(): void {\n    this.#liveMetrics.addEventListener(LiveMetrics.Events.Reset, this.#onReset);\n    this.#liveMetrics.addEventListener(LiveMetrics.Events.LCPChanged, this.#onLcpChange);\n    this.#liveMetrics.addEventListener(LiveMetrics.Events.CLSChanged, this.#onClsChange);\n    this.#liveMetrics.addEventListener(LiveMetrics.Events.INPChanged, this.#onInpChange);\n  }\n\n  disconnectedCallback(): void {\n    this.#liveMetrics.removeEventListener(LiveMetrics.Events.Reset, this.#onReset);\n    this.#liveMetrics.removeEventListener(LiveMetrics.Events.LCPChanged, this.#onLcpChange);\n    this.#liveMetrics.removeEventListener(LiveMetrics.Events.CLSChanged, this.#onClsChange);\n    this.#liveMetrics.removeEventListener(LiveMetrics.Events.INPChanged, this.#onInpChange);\n  }\n\n  #renderLcpData(lcpValue: LiveMetrics.LCPChangeEvent): LitHtml.LitTemplate {\n    return html`\n      <div class=\"lcp-data\">\n        <span>LCP: ${Math.round(lcpValue.value)}</span>\n        ${lcpValue.node ? until(Common.Linkifier.Linkifier.linkify(lcpValue.node)) : nothing}\n      </div>\n    `;\n  }\n\n  #render = (): void => {\n    const output = html`\n      <div class=\"live-lcp\">\n        ${this.#lcpValue ? this.#renderLcpData(this.#lcpValue) : nothing}\n      </div>\n      <div class=\"live-cls\">\n        ${this.#clsValue ? html`<div class=\"cls-data\">CLS: ${this.#clsValue.value.toFixed(3)}</div>` : nothing}\n      </div>\n      <div class=\"live-inp\">\n        ${this.#inpValue ? html`<div class=\"inp-data\">INP: ${this.#inpValue.value}</div>` : nothing}\n      </div>\n    `;\n    LitHtml.render(output, this.#shadow, {host: this});\n  };\n}\n\ncustomElements.define('devtools-live-metrics-view', LiveMetricsView);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-live-metrics-view': LiveMetricsView;\n  }\n}\n"]}