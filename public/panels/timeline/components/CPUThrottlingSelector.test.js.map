{"version":3,"file":"CPUThrottlingSelector.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/timeline/components/CPUThrottlingSelector.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as MobileThrottling from '../../../panels/mobile_throttling/mobile_throttling.js';\nimport {renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport type * as Menus from '../../../ui/components/menus/menus.js';\nimport * as Coordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\n\nimport * as Components from './components.js';\n\ndescribeWithEnvironment('CPUThrottlingSelector', () => {\n  const coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n  let cpuThrottlingManager: SDK.CPUThrottlingManager.CPUThrottlingManager;\n\n  beforeEach(() => {\n    cpuThrottlingManager = SDK.CPUThrottlingManager.CPUThrottlingManager.instance({forceNew: true});\n    MobileThrottling.ThrottlingManager.ThrottlingManager.instance({forceNew: true});\n  });\n\n  it('renders all CPU throttling presets', async () => {\n    const view = new Components.CPUThrottlingSelector.CPUThrottlingSelector();\n    renderElementIntoDOM(view);\n\n    await coordinator.done();\n\n    const menuItems = view.shadowRoot!.querySelectorAll('devtools-menu-item') as NodeListOf<Menus.Menu.MenuItem>;\n\n    assert.lengthOf(menuItems, 4);\n\n    assert.strictEqual(menuItems[0].value, 1);\n    assert.isTrue(menuItems[0].selected);\n    assert.match(menuItems[0].innerText, /No throttling/);\n\n    assert.strictEqual(menuItems[1].value, 4);\n    assert.isFalse(menuItems[1].selected);\n    assert.match(menuItems[1].innerText, /4× slowdown/);\n\n    assert.strictEqual(menuItems[2].value, 6);\n    assert.isFalse(menuItems[2].selected);\n    assert.match(menuItems[2].innerText, /6× slowdown/);\n\n    assert.strictEqual(menuItems[3].value, 20);\n    assert.isFalse(menuItems[3].selected);\n    assert.match(menuItems[3].innerText, /20× slowdown/);\n  });\n\n  it('updates CPU throttling manager on change', async () => {\n    const view = new Components.CPUThrottlingSelector.CPUThrottlingSelector();\n    renderElementIntoDOM(view);\n\n    await coordinator.done();\n\n    const menuItems = view.shadowRoot!.querySelectorAll('devtools-menu-item') as NodeListOf<Menus.Menu.MenuItem>;\n\n    assert.isTrue(menuItems[0].selected);\n    assert.strictEqual(cpuThrottlingManager.cpuThrottlingRate(), 1);\n\n    menuItems[1].click();\n    await coordinator.done();\n\n    assert.isTrue(menuItems[1].selected);\n    assert.strictEqual(cpuThrottlingManager.cpuThrottlingRate(), 4);\n  });\n\n  it('reacts to changes in CPU throttling manager', async () => {\n    const view = new Components.CPUThrottlingSelector.CPUThrottlingSelector();\n    renderElementIntoDOM(view);\n\n    await coordinator.done();\n\n    const menuItems = view.shadowRoot!.querySelectorAll('devtools-menu-item') as NodeListOf<Menus.Menu.MenuItem>;\n\n    assert.isTrue(menuItems[0].selected);\n\n    cpuThrottlingManager.setCPUThrottlingRate(6);\n    await coordinator.done();\n\n    assert.isTrue(menuItems[2].selected);\n  });\n});\n"]}