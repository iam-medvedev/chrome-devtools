{"version":3,"file":"GdpSignUpDialog.js","sourceRoot":"","sources":["../../../../../../front_end/panels/common/GdpSignUpDialog.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport '../../ui/components/switch/switch.js';\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as Badges from '../../models/badges/badges.js';\nimport * as Geometry from '../../models/geometry/geometry.js';\nimport * as Buttons from '../../ui/components/buttons/buttons.js';\nimport * as Snackbars from '../../ui/components/snackbars/snackbars.js';\nimport type * as Switch from '../../ui/components/switch/switch.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {html, render} from '../../ui/lit/lit.js';\n\nimport styles from './gdpSignUpDialog.css.js';\n\nconst UIStrings = {\n  /**\n   * @description Aria label for the Google Developer Program sign up dialog\n   */\n  gdpDialogAriaLabel: 'Google Developer Program sign up dialog',\n  /**\n   *\n   * @description Button text for canceling GDP sign up.\n   */\n  cancel: 'Cancel',\n  /**\n   * @description Button text for confirming GDP sign up.\n   */\n  signUp: 'Sign up',\n  /**\n   * @description Title for the first section of the GDP sign up dialog.\n   */\n  designedForSuccess: 'Designed for your success',\n  /**\n   * @description Body for the first section of the GDP sign up dialog.\n   */\n  designedForSuccessBody: 'Grow your skills, build with AI, and earn badges you can showcase in your developer profile',\n  /**\n   * @description Title for the second section of the GDP sign up dialog.\n   */\n  keepUpdated: 'Keep me updated',\n  /**\n   * @description Body for the second section of the GDP sign up dialog.\n   */\n  keepUpdatedBody: 'The latest DevTools features, event invites, and tailored insights land directly in your inbox',\n  /**\n   * @description Title for the third section of the GDP sign up dialog.\n   */\n  tailorProfile: 'Tailor your profile',\n  /**\n   * @description Body for the third section of the GDP sign up dialog.\n   */\n  tailorProfileBody:\n      'The name on your Google Account and your interests will be used in your Google Developer Profile. Your name may appear where you contribute and can be changed at any time.',\n  /**\n   * @description Body for the third section of the GDP sign up dialog.\n   * @example {Content Policy} PH1\n   * @example {Terms of Service} PH2\n   * @example {Privacy Policy} PH3\n   */\n  tailorProfileBodyDisclaimer:\n      'By creating a Developer Profile, you agree to the {PH1}. Google’s {PH2} and {PH3} apply to your use of this service.',\n  /**\n   * @description Button text for learning more about the Google Developer Program.\n   */\n  learnMore: 'Learn more',\n  /**\n   * @description Accessible text for learning more about the Google Developer Program.\n   */\n  learnMoreAccessibleText: 'Learn more about the Google Developer Program',\n  /**\n   * @description Link text for Content Policy.\n   */\n  contentPolicy: 'Content Policy',\n  /**\n   * @description Link text for Terms of Service.\n   */\n  termsOfService: 'Terms of Service',\n  /**\n   * @description Link text for Privacy Policy.\n   */\n  privacyPolicy: 'Privacy Policy',\n  /**\n   * @description Error message shown in a snackbar when GDP sign up fails.\n   */\n  signUpFailed: 'Your Google Developer Program profile couldn’t be created. Please try again later.'\n} as const;\n\nconst str_ = i18n.i18n.registerUIStrings('panels/common/GdpSignUpDialog.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst TERMS_OF_SERVICE_URL = 'https://policies.google.com/terms';\nconst PRIVACY_POLICY_URL = 'https://policies.google.com/privacy';\nconst CONTENT_POLICY_URL = 'https://developers.google.com/profile/content-policy';\nconst GDP_PROGRAM_URL = 'https://developers.google.com/program';\n\ninterface ViewInput {\n  onSignUpClick: () => void;\n  onCancelClick: () => void;\n  keepMeUpdated: boolean;\n  onKeepMeUpdatedChange: (value: boolean) => void;\n  isSigningUp: boolean;\n}\n\ntype View = (input: ViewInput, output: undefined, target: HTMLElement) => void;\n\nexport const DEFAULT_VIEW: View = (input, _output, target): void => {\n  // clang-format off\n  render(\n    html`\n      <style>${styles}</style>\n      <div class=\"gdp-sign-up-dialog-header\" role=\"img\" aria-label=\"Google Developer Program\"></div>\n      <div class=\"main-content\">\n        <div class=\"section\">\n          <div class=\"icon-container\">\n            <devtools-icon name=\"trophy\"></devtools-icon>\n          </div>\n          <div class=\"text-container\">\n            <h2 class=\"section-title\">${i18nString(UIStrings.designedForSuccess)}</h2>\n            <div class=\"section-text\">${i18nString(UIStrings.designedForSuccessBody)}</div>\n          </div>\n        </div>\n        <div class=\"section\">\n          <div class=\"icon-container\">\n            <devtools-icon name=\"mark-email-unread\"></devtools-icon>\n          </div>\n          <div class=\"text-container\">\n            <h2 class=\"section-title\">${i18nString(UIStrings.keepUpdated)}</h2>\n            <div class=\"section-text\">${i18nString(UIStrings.keepUpdatedBody)}</div>\n          </div>\n          <div class=\"switch-container\">\n            <devtools-switch\n            .checked=${input.keepMeUpdated}\n            .jslogContext=${'keep-me-updated'}\n            .label=${i18nString(UIStrings.keepUpdated)}\n            @switchchange=${(e: Switch.Switch.SwitchChangeEvent) => input.onKeepMeUpdatedChange(e.checked)}\n          >\n            </devtools-switch>\n          </div>\n          </div>\n        <div class=\"section\">\n          <div class=\"icon-container\">\n            <devtools-icon name=\"google\"></devtools-icon>\n          </div>\n          <div class=\"text-container\">\n            <h2 class=\"section-title\">${i18nString(UIStrings.tailorProfile)}</h2>\n            <div class=\"section-text\">\n              <div>${i18nString(UIStrings.tailorProfileBody)}</div><br/>\n              <div>${i18n.i18n.getFormatLocalizedString(str_, UIStrings.tailorProfileBodyDisclaimer, {\n      PH1: UI.XLink.XLink.create(CONTENT_POLICY_URL, i18nString(UIStrings.contentPolicy), 'link', undefined, 'content-policy'),\n      PH2: UI.XLink.XLink.create(TERMS_OF_SERVICE_URL, i18nString(UIStrings.termsOfService), 'link',\n        undefined, 'terms-of-service'),\n      PH3: UI.XLink.XLink.create(PRIVACY_POLICY_URL, i18nString(UIStrings.privacyPolicy), 'link',\n        undefined, 'privacy-policy'),\n    })}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"buttons\">\n        <devtools-button\n          aria-label=${i18nString(UIStrings.learnMoreAccessibleText)}\n          .title=${i18nString(UIStrings.learnMoreAccessibleText)}\n          .variant=${Buttons.Button.Variant.OUTLINED}\n          .jslogContext=${'learn-more'}\n          @click=${() => UI.UIUtils.openInNewTab(GDP_PROGRAM_URL as Platform.DevToolsPath.UrlString)}>${i18nString(UIStrings.learnMore)}</devtools-button>\n        <div class=\"right-buttons\">\n          <devtools-button\n            .variant=${Buttons.Button.Variant.TONAL}\n            .jslogContext=${'cancel'}\n            @click=${input.onCancelClick}>${i18nString(UIStrings.cancel)}</devtools-button>\n          <devtools-button\n            .variant=${Buttons.Button.Variant.PRIMARY}\n            .jslogContext=${'sign-up'}\n            .spinner=${input.isSigningUp}\n            .disabled=${input.isSigningUp}\n            @click=${input.onSignUpClick}>${i18nString(UIStrings.signUp)}</devtools-button>\n        </div>\n      </div>\n    `,\n    target\n  );\n  // clang-format on\n};\n\nexport class GdpSignUpDialog extends UI.Widget.VBox {\n  #view: View;\n  #dialog: UI.Dialog.Dialog;\n  #keepMeUpdated = false;\n  #isSigningUp = false;\n  #onSuccess?: () => void;\n  #onCancel?: () => void;\n\n  constructor(\n      options: {\n        dialog: UI.Dialog.Dialog,\n        onSuccess?: () => void,\n        onCancel?: () => void,\n      },\n      view?: View) {\n    super();\n    this.#dialog = options.dialog;\n    this.#onSuccess = options.onSuccess;\n    this.#onCancel = options.onCancel;\n    this.#view = view ?? DEFAULT_VIEW;\n    this.requestUpdate();\n  }\n\n  async #onSignUpClick(): Promise<void> {\n    this.#isSigningUp = true;\n    this.requestUpdate();\n\n    const syncInfo = await new Promise<Host.InspectorFrontendHostAPI.SyncInformation>(\n        resolve => Host.InspectorFrontendHost.InspectorFrontendHostInstance.getSyncInformation(resolve));\n    const user = syncInfo.accountFullName ?? '';\n    const emailPreference =\n        this.#keepMeUpdated ? Host.GdpClient.EmailPreference.ENABLED : Host.GdpClient.EmailPreference.DISABLED;\n    const result = await Host.GdpClient.GdpClient.instance().createProfile({user, emailPreference});\n    if (result) {\n      Common.Settings.Settings.instance().moduleSetting('receive-gdp-badges').set(true);\n      await Badges.UserBadges.instance().initialize();\n      Badges.UserBadges.instance().recordAction(Badges.BadgeAction.GDP_SIGN_UP_COMPLETE);\n      this.#onSuccess?.();\n      this.#dialog.hide();\n    } else {\n      Snackbars.Snackbar.Snackbar.show({message: i18nString(UIStrings.signUpFailed)}, this.#dialog.contentElement);\n      this.#isSigningUp = false;\n      this.requestUpdate();\n    }\n  }\n\n  override performUpdate(): void {\n    const viewInput = {\n      onSignUpClick: this.#onSignUpClick.bind(this),\n      onCancelClick: () => {\n        this.#dialog.hide();\n        this.#onCancel?.();\n      },\n      keepMeUpdated: this.#keepMeUpdated,\n      onKeepMeUpdatedChange: (value: boolean) => {\n        this.#keepMeUpdated = value;\n        this.requestUpdate();\n      },\n      isSigningUp: this.#isSigningUp,\n    };\n\n    this.#view(viewInput, undefined, this.contentElement);\n  }\n\n  static show({onSuccess, onCancel}: {onSuccess?: () => void, onCancel?: () => void} = {}): void {\n    const dialog = new UI.Dialog.Dialog('gdp-sign-up-dialog');\n    dialog.setAriaLabel(i18nString(UIStrings.gdpDialogAriaLabel));\n    dialog.setMaxContentSize(new Geometry.Size(384, 500));\n    dialog.setSizeBehavior(UI.GlassPane.SizeBehavior.SET_EXACT_WIDTH_MAX_HEIGHT);\n    dialog.setDimmed(true);\n\n    new GdpSignUpDialog({dialog, onSuccess, onCancel}).show(dialog.contentElement);\n    dialog.show(undefined, /* stack */ true);\n  }\n}\n"]}