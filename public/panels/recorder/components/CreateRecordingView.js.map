{"version":3,"file":"CreateRecordingView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/CreateRecordingView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../../ui/kit/kit.js';\nimport './ControlButton.js';\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as Badges from '../../../models/badges/badges.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as Input from '../../../ui/components/input/input.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\nimport * as Models from '../models/models.js';\nimport * as Actions from '../recorder-actions/recorder-actions.js';\n\nimport createRecordingViewStyles from './createRecordingView.css.js';\n\nconst {html, Directives: {ref, createRef, repeat}} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description The label for the input where the user enters a name for the new recording.\n   */\n  recordingName: 'Recording name',\n  /**\n   * @description The button that start the recording with selected options.\n   */\n  startRecording: 'Start recording',\n  /**\n   * @description The title of the page that contains the form for creating a new recording.\n   */\n  createRecording: 'Create a new recording',\n  /**\n   * @description The error message that is shown if the user tries to create a recording without a name.\n   */\n  recordingNameIsRequired: 'Recording name is required',\n  /**\n   * @description The label for the input where the user enters an attribute to be used for selector generation.\n   */\n  selectorAttribute: 'Selector attribute',\n  /**\n   * @description The title for the close button where the user cancels a recording and returns back to previous view.\n   */\n  cancelRecording: 'Cancel recording',\n  /**\n   * @description Label indicating a CSS (Cascading Style Sheets) selector type\n   * (https://developer.mozilla.org/en-US/docs/Web/CSS). The label is used on a\n   * checkbox which users can tick if they are interesting in recording CSS\n   * selectors.\n   */\n  selectorTypeCSS: 'CSS',\n  /**\n   * @description Label indicating a piercing CSS (Cascading Style Sheets)\n   * selector type\n   * (https://pptr.dev/guides/query-selectors#pierce-selectors-pierce). These\n   * type of selectors behave like CSS selectors, but can pierce through\n   * ShadowDOM. The label is used on a checkbox which users can tick if they are\n   * interesting in recording CSS selectors.\n   */\n  selectorTypePierce: 'Pierce',\n  /**\n   * @description Label indicating a ARIA (Accessible Rich Internet\n   * Applications) selector type\n   * (https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA). The\n   * label is used on a checkbox which users can tick if they are interesting in\n   * recording ARIA selectors.\n   */\n  selectorTypeARIA: 'ARIA',\n  /**\n   * @description Label indicating a text selector type. The label is used on a\n   * checkbox which users can tick if they are interesting in recording text\n   * selectors.\n   */\n  selectorTypeText: 'Text',\n  /**\n   * @description Label indicating a XPath (XML Path Language) selector type\n   * (https://en.wikipedia.org/wiki/XPath). The label is used on a checkbox\n   * which users can tick if they are interesting in recording text selectors.\n   */\n  selectorTypeXPath: 'XPath',\n  /**\n   * @description The label for the input that allows specifying selector types\n   * that should be used during the recording.\n   */\n  selectorTypes: 'Selector types to record',\n  /**\n   * @description The error message that shows up if the user turns off\n   * necessary selectors.\n   */\n  includeNecessarySelectors:\n      'You must choose CSS, Pierce, or XPath as one of your options. Only these selectors are guaranteed to be recorded since ARIA and text selectors may not be unique.',\n  /**\n   * @description Title of a link to the developer documentation.\n   */\n  learnMore: 'Learn more',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings(\n    'panels/recorder/components/CreateRecordingView.ts',\n    UIStrings,\n);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface ViewInput {\n  name: string;\n  selectorAttribute: string;\n  selectorTypes: Array<{\n    selectorType: Models.Schema.SelectorType,\n    checked: boolean,\n  }>;\n  error?: Error;\n  onRecordingStarted: () => void;\n  onRecordingCancelled: () => void;\n  onErrorReset: () => void;\n  onUpdate: (update: {\n    selectorType: Models.Schema.SelectorType,\n    checked: boolean,\n  }|{\n    name: string,\n  }|{\n    selectorAttribute: string,\n  }) => void;\n}\n\nexport interface ViewOutput {\n  focusInput?: () => void;\n}\n\nexport const DEFAULT_VIEW = (input: ViewInput, output: ViewOutput, target: HTMLElement): void => {\n  const {\n    name,\n    selectorAttribute,\n    selectorTypes,\n    error,\n    onUpdate,\n    onRecordingStarted,\n    onRecordingCancelled,\n    onErrorReset\n  } = input;\n\n  const nameInputRef = createRef<HTMLInputElement>();\n\n  const onKeyDown = (event: KeyboardEvent): void => {\n    if (error) {\n      onErrorReset();\n    }\n\n    const keyboardEvent = event;\n    if (keyboardEvent.key === 'Enter') {\n      onRecordingStarted();\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  };\n\n  output.focusInput = () => {\n    nameInputRef.value?.focus();\n  };\n\n  const selectorTypeToLabel = new Map([\n    [Models.Schema.SelectorType.ARIA, i18nString(UIStrings.selectorTypeARIA)],\n    [Models.Schema.SelectorType.CSS, i18nString(UIStrings.selectorTypeCSS)],\n    [Models.Schema.SelectorType.Text, i18nString(UIStrings.selectorTypeText)],\n    [\n      Models.Schema.SelectorType.XPath,\n      i18nString(UIStrings.selectorTypeXPath),\n    ],\n    [\n      Models.Schema.SelectorType.Pierce,\n      i18nString(UIStrings.selectorTypePierce),\n    ],\n  ]);\n\n  // clang-format off\n  Lit.render(\n    html`\n      <style>${createRecordingViewStyles}</style>\n      <style>${Input.textInputStyles}</style>\n      <style>${Input.checkboxStyles}</style>\n      <div class=\"wrapper\" jslog=${VisualLogging.section('create-recording-view')}>\n        <div class=\"header-wrapper\">\n          <h1>${i18nString(UIStrings.createRecording)}</h1>\n          <devtools-button\n            title=${i18nString(UIStrings.cancelRecording)}\n            jslog=${VisualLogging.close().track({click: true})}\n            .data=${\n              {\n                variant: Buttons.Button.Variant.ICON,\n                size: Buttons.Button.Size.SMALL,\n                iconName: 'cross',\n              } as Buttons.Button.ButtonData\n            }\n            @click=${onRecordingCancelled}\n          ></devtools-button>\n        </div>\n        <label class=\"row-label\" for=\"user-flow-name\">${i18nString(\n          UIStrings.recordingName,\n        )}</label>\n        <input\n          value=${name}\n          @focus=${() => nameInputRef.value?.select()}\n          @keydown=${onKeyDown}\n          jslog=${VisualLogging.textField('user-flow-name').track({change: true})}\n          class=\"devtools-text-input\"\n          id=\"user-flow-name\"\n          ${ref(nameInputRef)}\n          @input=${(e:Event) => onUpdate({\n            name: (e.target as HTMLInputElement).value.trim()\n          })}\n        />\n        <label class=\"row-label\" for=\"selector-attribute\">\n          <span>${i18nString(UIStrings.selectorAttribute)}</span>\n          <x-link\n            class=\"link\" href=\"https://g.co/devtools/recorder#selector\"\n            title=${i18nString(UIStrings.learnMore)}\n            jslog=${VisualLogging.link('recorder-selector-help').track({click: true})}>\n            <devtools-icon name=\"help\">\n            </devtools-icon>\n          </x-link>\n        </label>\n        <input\n          value=${selectorAttribute}\n          placeholder=\"data-testid\"\n          @keydown=${onKeyDown}\n          jslog=${VisualLogging.textField('selector-attribute').track({change: true})}\n          class=\"devtools-text-input\"\n          id=\"selector-attribute\"\n          @input=${(e:Event) => onUpdate({\n            selectorAttribute: (e.target as HTMLInputElement).value.trim()\n          })}\n        />\n        <label class=\"row-label\">\n          <span>${i18nString(UIStrings.selectorTypes)}</span>\n          <x-link\n            class=\"link\" href=\"https://g.co/devtools/recorder#selector\"\n            title=${i18nString(UIStrings.learnMore)}\n            jslog=${VisualLogging.link('recorder-selector-help').track({click: true})}>\n            <devtools-icon name=\"help\">\n            </devtools-icon>\n          </x-link>\n        </label>\n        <div class=\"checkbox-container\">\n          ${repeat(selectorTypes, item => {\n            return html`\n              <label class=\"checkbox-label selector-type\">\n                <input\n                  @keydown=${onKeyDown}\n                  .value=${item.selectorType}\n                  jslog=${VisualLogging.toggle().track({click: true}).context(`selector-${item.selectorType}`)}\n                  ?checked=${item.checked}\n                  type=\"checkbox\"\n                  @change=${(e:Event) => onUpdate({\n                    selectorType: item.selectorType,\n                    checked: (e.target as HTMLInputElement).checked\n                  })}\n                />\n                ${selectorTypeToLabel.get(item.selectorType) || item.selectorType}\n              </label>\n            `;\n          })}\n        </div>\n        ${\n          error &&\n          html` <div class=\"error\" role=\"alert\"> ${error.message} </div>`\n        }\n      </div>\n      <div class=\"footer\">\n        <div class=\"controls\">\n          <devtools-control-button\n            @click=${onRecordingStarted}\n            .label=${i18nString(UIStrings.startRecording)}\n            .shape=${'circle'}\n            jslog=${VisualLogging.action(Actions.RecorderActions.START_RECORDING).track({click: true})}\n            title=${Models.Tooltip.getTooltipForActions(\n              i18nString(UIStrings.startRecording),\n              Actions.RecorderActions.START_RECORDING,\n            )}\n          ></devtools-control-button>\n        </div>\n      </div>\n    `,\n    target,\n  );\n  // clang-format on\n};\n\nexport class CreateRecordingView extends UI.Widget.Widget {\n  #error?: Error;\n  #name = '';\n  #selectorAttribute = '';\n  #selectorTypes: Array<{\n    selectorType: Models.Schema.SelectorType,\n    checked: boolean,\n  }> = [];\n  #view: typeof DEFAULT_VIEW;\n  #output: ViewOutput = {};\n  #recorderSettings?: Models.RecorderSettings.RecorderSettings;\n\n  onRecordingStarted:\n      (data: {name: string, selectorTypesToRecord: Models.Schema.SelectorType[], selectorAttribute?: string}) => void =\n          () => {};\n  onRecordingCancelled = (): void => {};\n\n  set recorderSettings(value: Models.RecorderSettings.RecorderSettings) {\n    this.#recorderSettings = value;\n    this.#name = this.#recorderSettings.defaultTitle;\n    this.#selectorAttribute = this.#recorderSettings.selectorAttribute;\n    this.#selectorTypes = Object.values(Models.Schema.SelectorType).map(selectorType => {\n      return {\n        selectorType,\n        checked: this.#recorderSettings?.getSelectorByType(selectorType) ?? true,\n      };\n    }),\n    this.requestUpdate();\n  }\n\n  constructor(element?: HTMLElement, view?: typeof DEFAULT_VIEW) {\n    super(element, {useShadowDom: true});\n    this.#view = view || DEFAULT_VIEW;\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    this.requestUpdate();\n    void this.updateComplete.then(() => this.#output.focusInput?.());\n  }\n\n  startRecording(): void {\n    if (!this.#recorderSettings) {\n      throw new Error('settings not set');\n    }\n\n    if (!this.#name.trim()) {\n      this.#error = new Error(i18nString(UIStrings.recordingNameIsRequired));\n      this.requestUpdate();\n      return;\n    }\n\n    const selectorTypesToRecord = this.#selectorTypes.filter(item => item.checked).map(item => item.selectorType);\n\n    if (!selectorTypesToRecord.includes(Models.Schema.SelectorType.CSS) &&\n        !selectorTypesToRecord.includes(Models.Schema.SelectorType.XPath) &&\n        !selectorTypesToRecord.includes(Models.Schema.SelectorType.Pierce)) {\n      this.#error = new Error(i18nString(UIStrings.includeNecessarySelectors));\n      this.requestUpdate();\n      return;\n    }\n\n    for (const selectorType of Object.values(Models.Schema.SelectorType)) {\n      this.#recorderSettings.setSelectorByType(\n          selectorType,\n          selectorTypesToRecord.includes(selectorType),\n      );\n    }\n\n    const selectorAttribute = this.#selectorAttribute.trim();\n    if (selectorAttribute) {\n      this.#recorderSettings.selectorAttribute = selectorAttribute;\n    }\n\n    this.onRecordingStarted({\n      name: this.#name,\n      selectorTypesToRecord,\n      selectorAttribute: this.#selectorAttribute ? this.#selectorAttribute : undefined,\n    });\n\n    Badges.UserBadges.instance().recordAction(Badges.BadgeAction.RECORDER_RECORDING_STARTED);\n  }\n\n  override performUpdate(): void {\n    this.#view(\n        {\n          name: this.#name,\n          selectorAttribute: this.#selectorAttribute,\n          selectorTypes: this.#selectorTypes,\n          error: this.#error,\n          onRecordingCancelled: this.onRecordingCancelled,\n          onUpdate: update => {\n            if ('name' in update) {\n              this.#name = update.name;\n            } else if ('selectorAttribute' in update) {\n              this.#selectorAttribute = update.selectorAttribute;\n            } else {\n              this.#selectorTypes = this.#selectorTypes.map(item => {\n                if (item.selectorType === update.selectorType) {\n                  return {\n                    ...item,\n                    checked: update.checked,\n                  };\n                }\n                return item;\n              });\n            }\n            this.requestUpdate();\n          },\n          onRecordingStarted: (): void => {\n            this.startRecording();\n          },\n          onErrorReset: () => {\n            this.#error = undefined;\n            this.requestUpdate();\n          },\n        },\n        this.#output, this.contentElement);\n  }\n}\n"]}