{"version":3,"file":"ReplaySection.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/ReplaySection.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {\n  describeWithEnvironment,\n  setupActionRegistry,\n} from '../../../testing/EnvironmentHelpers.js';\nimport {\n  createViewFunctionStub,\n  type ViewFunctionStub,\n} from '../../../testing/ViewFunctionHelpers.js';\nimport type * as Extensions from '../extensions/extensions.js';\nimport * as Models from '../models/models.js';\n\nimport * as RecorderComponents from './components.js';\n\ndescribeWithEnvironment('ReplaySection', () => {\n  setupActionRegistry();\n\n  let settings: Models.RecorderSettings.RecorderSettings;\n  const views: RecorderComponents.ReplaySection.ReplaySection[] = [];\n\n  afterEach(() => {\n    settings.speed = Models.RecordingPlayer.PlayRecordingSpeed.NORMAL;\n    for (const view of views) {\n      view.willHide();\n    }\n  });\n\n  async function createReplaySection(\n      speed: Models.RecordingPlayer.PlayRecordingSpeed = Models.RecordingPlayer.PlayRecordingSpeed.NORMAL,\n      ):\n      Promise<[\n        ViewFunctionStub<typeof RecorderComponents.ReplaySection.ReplaySection>,\n        RecorderComponents.ReplaySection.ReplaySection,\n      ]> {\n    settings = new Models.RecorderSettings.RecorderSettings();\n    settings.speed = speed;\n    const view = createViewFunctionStub(RecorderComponents.ReplaySection.ReplaySection);\n    const component = new RecorderComponents.ReplaySection.ReplaySection(undefined, view);\n    component.settings = settings;\n    component.replayExtensions = [];\n    component.onStartReplay = () => {};\n    component.wasShown();\n    views.push(component);\n\n    return [view, component];\n  }\n\n  it('should change the button value when another option is selected in select menu', async () => {\n    const [view] = await createReplaySection();\n    assert.strictEqual(\n        view.input.selectedItem.value,\n        Models.RecordingPlayer.PlayRecordingSpeed.NORMAL,\n    );\n\n    view.input.onItemSelected(Models.RecordingPlayer.PlayRecordingSpeed.SLOW);\n    assert.strictEqual(\n        view.input.selectedItem.value,\n        Models.RecordingPlayer.PlayRecordingSpeed.SLOW,\n    );\n  });\n\n  it('should call onStartReplay on selectbuttonclick event', async () => {\n    const [view, component] = await createReplaySection();\n    const onStartReplay = sinon.stub();\n    component.settings = settings;\n    component.replayExtensions = [];\n    component.onStartReplay = onStartReplay;\n\n    view.input.onItemSelected(Models.RecordingPlayer.PlayRecordingSpeed.SLOW);\n    view.input.onButtonClick();\n\n    sinon.assert.calledWith(onStartReplay, Models.RecordingPlayer.PlayRecordingSpeed.SLOW);\n  });\n\n  it('should save the changed button when option is selected in select menu', async () => {\n    const [view] = await createReplaySection();\n    view.input.onItemSelected(Models.RecordingPlayer.PlayRecordingSpeed.SLOW);\n\n    assert.strictEqual(\n        settings.speed,\n        Models.RecordingPlayer.PlayRecordingSpeed.SLOW,\n    );\n  });\n\n  it('should load the saved button on initial render', async () => {\n    const [view] = await createReplaySection(Models.RecordingPlayer.PlayRecordingSpeed.SLOW);\n\n    assert.strictEqual(\n        view.input.selectedItem.value,\n        Models.RecordingPlayer.PlayRecordingSpeed.SLOW,\n    );\n  });\n\n  it('should call onStartReplay with extension when extension is selected', async () => {\n    const [view, component] = await createReplaySection();\n    const onStartReplay = sinon.stub();\n    const extension = {\n      getName: () => 'Test Extension',\n      getDescriptor: () => ({}),\n      install: () => {},\n      uninstall: () => {},\n    } as unknown as Extensions.ExtensionManager.Extension;\n    component.settings = settings;\n    component.replayExtensions = [extension];\n    component.onStartReplay = onStartReplay;\n\n    view.input.onItemSelected('extension0');\n    view.input.onButtonClick();\n\n    sinon.assert.calledWith(\n        onStartReplay,\n        Models.RecordingPlayer.PlayRecordingSpeed.NORMAL,\n        extension,\n    );\n  });\n});\n"]}