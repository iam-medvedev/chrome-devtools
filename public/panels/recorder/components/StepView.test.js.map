{"version":3,"file":"StepView.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/recorder/components/StepView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nconst {assert} = chai;\n\nimport * as Models from '../models/models.js';\nimport * as Converters from '../converters/converters.js';\nimport * as Components from './components.js';\nimport * as Menus from '../../../ui/components/menus/menus.js';\nimport type * as Button from '../../../ui/components/buttons/buttons.js';\nimport * as Coordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\n\nimport {\n  dispatchClickEvent,\n  getEventPromise,\n  renderElementIntoDOM,\n} from '../../../testing/DOMHelpers.js';\nimport {\n  describeWithEnvironment,\n} from '../../../testing/EnvironmentHelpers.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\ndescribeWithEnvironment('StepView', () => {\n  const step = {type: Models.Schema.StepType.Scroll as const};\n  const section = {title: 'test', steps: [step], url: 'https://example.com'};\n\n  async function createStepView(\n      opts: Partial<Components.StepView.StepViewData> = {},\n      ): Promise<Components.StepView.StepView> {\n    const view = new Components.StepView.StepView();\n    view.data = {\n      step: opts.step !== undefined ? step : undefined,\n      section: opts.section !== undefined ? section : undefined,\n      state: Components.StepView.State.Default,\n      isEndOfGroup: opts.isEndOfGroup ?? false,\n      isStartOfGroup: opts.isStartOfGroup ?? false,\n      isFirstSection: opts.isFirstSection ?? false,\n      isLastSection: opts.isLastSection ?? false,\n      stepIndex: opts.stepIndex ?? 0,\n      sectionIndex: opts.sectionIndex ?? 0,\n      isRecording: opts.isRecording ?? false,\n      isPlaying: opts.isPlaying ?? false,\n      hasBreakpoint: opts.hasBreakpoint ?? false,\n      removable: opts.removable ?? false,\n      builtInConverters: opts.builtInConverters ||\n          [\n            new Converters.JSONConverter.JSONConverter('  '),\n          ],\n      extensionConverters: opts.extensionConverters || [],\n      isSelected: opts.isSelected ?? false,\n      recorderSettings: new Models.RecorderSettings.RecorderSettings(),\n    };\n    renderElementIntoDOM(view);\n    await coordinator.done();\n    return view;\n  }\n\n  describe('Step and section actions menu', () => {\n    it('should open actions menu', async () => {\n      const view = await createStepView({step});\n      assert.notOk(\n          view.shadowRoot?.querySelector('devtools-menu[has-open-dialog]'),\n      );\n\n      const button = view.shadowRoot?.querySelector(\n                         '.step-actions',\n                         ) as Button.Button.Button;\n      assert.ok(button);\n\n      dispatchClickEvent(button);\n      await coordinator.done();\n\n      assert.ok(\n          view.shadowRoot?.querySelector('devtools-menu[has-open-dialog]'),\n      );\n    });\n\n    it('should dispatch \"AddStep before\" events on steps', async () => {\n      const view = await createStepView({step});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.AddStep>(\n          view,\n          'addstep',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('add-step-before'),\n      );\n      const event = await eventPromise;\n\n      assert.strictEqual(event.position, 'before');\n      assert.deepStrictEqual(event.stepOrSection, step);\n    });\n\n    it('should dispatch \"AddStep before\" events on steps', async () => {\n      const view = await createStepView({section});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.AddStep>(\n          view,\n          'addstep',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('add-step-before'),\n      );\n      const event = await eventPromise;\n\n      assert.strictEqual(event.position, 'before');\n      assert.deepStrictEqual(event.stepOrSection, section);\n    });\n\n    it('should dispatch \"AddStep after\" events on steps', async () => {\n      const view = await createStepView({step});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.AddStep>(\n          view,\n          'addstep',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('add-step-after'),\n      );\n      const event = await eventPromise;\n\n      assert.strictEqual(event.position, 'after');\n      assert.deepStrictEqual(event.stepOrSection, step);\n    });\n\n    it('should dispatch \"Remove steps\" events on steps', async () => {\n      const view = await createStepView({step});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.RemoveStep>(\n          view,\n          'removestep',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('remove-step'),\n      );\n      const event = await eventPromise;\n\n      assert.deepStrictEqual(event.step, step);\n    });\n\n    it('should dispatch \"Add breakpoint\" event on steps', async () => {\n      const view = await createStepView({step});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.AddBreakpointEvent>(\n          view,\n          'addbreakpoint',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('add-breakpoint'),\n      );\n      const event = await eventPromise;\n\n      assert.deepStrictEqual(event.index, 0);\n    });\n\n    it('should dispatch \"Remove breakpoint\" event on steps', async () => {\n      const view = await createStepView({step});\n\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n      const eventPromise = getEventPromise<Components.StepView.AddBreakpointEvent>(\n          view,\n          'removebreakpoint',\n      );\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('remove-breakpoint'),\n      );\n      const event = await eventPromise;\n\n      assert.deepStrictEqual(event.index, 0);\n    });\n  });\n\n  describe('Breakpoint events', () => {\n    it('should dispatch \"Add breakpoint\" event on breakpoint icon click if there is not a breakpoint on the step',\n       async () => {\n         const view = await createStepView({step});\n         const breakpointIcon = view.shadowRoot?.querySelector('.breakpoint-icon');\n         const eventPromise = getEventPromise<Components.StepView.AddBreakpointEvent>(\n             view,\n             'addbreakpoint',\n         );\n         assert.isOk(breakpointIcon);\n\n         breakpointIcon?.dispatchEvent(new Event('click'));\n         const event = await eventPromise;\n\n         assert.deepStrictEqual(event.index, 0);\n       });\n\n    it('should dispatch \"Remove breakpoint\" event on breakpoint icon click if there already is a breakpoint on the step',\n       async () => {\n         const view = await createStepView({hasBreakpoint: true, step});\n         const breakpointIcon = view.shadowRoot?.querySelector('.breakpoint-icon');\n         const eventPromise = getEventPromise<Components.StepView.RemoveBreakpointEvent>(\n             view,\n             'removebreakpoint',\n         );\n\n         breakpointIcon?.dispatchEvent(new Event('click'));\n         const event = await eventPromise;\n\n         assert.deepStrictEqual(event.index, 0);\n       });\n  });\n\n  describe('Copy steps', () => {\n    it('should copy a step to clipboard', async () => {\n      const view = await createStepView({step});\n      const menu = view.shadowRoot?.querySelector(\n                       '.step-actions + devtools-menu',\n                       ) as Menus.Menu.Menu;\n      assert.ok(menu);\n\n      const isCalled = sinon.promise();\n      view.addEventListener(Components.StepView.CopyStepEvent.eventName, () => {\n        void isCalled.resolve(true);\n      });\n      menu.dispatchEvent(\n          new Menus.Menu.MenuItemSelectedEvent('copy-step-as-json'),\n      );\n\n      const called = await isCalled;\n\n      assert.isTrue(called);\n    });\n  });\n\n  describe('Selection', () => {\n    it('should render timeline as selected if isSelected = true', async () => {\n      const view = await createStepView({step, isSelected: true});\n      assert.ok(view);\n      const section = view.shadowRoot?.querySelector(\n          'devtools-timeline-section',\n      );\n      assert.ok(section);\n      const div = section?.shadowRoot?.querySelector('div');\n      assert.isTrue(div?.classList.contains('is-selected'));\n    });\n  });\n});\n"]}