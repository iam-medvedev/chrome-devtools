{"version":3,"file":"BackForwardCacheView.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/BackForwardCacheView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {\n  assertElement,\n  assertShadowRoot,\n  dispatchClickEvent,\n  renderElementIntoDOM,\n} from '../../../../test/unittests/front_end/helpers/DOMHelpers.js';\nimport {createTarget} from '../../../../test/unittests/front_end/helpers/EnvironmentHelpers.js';\nimport {describeWithMockConnection} from '../../../../test/unittests/front_end/helpers/MockConnection.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport {assertNotNullOrUndefined} from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport * as Coordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\nimport * as TreeOutline from '../../../ui/components/tree_outline/tree_outline.js';\n\nimport * as ApplicationComponents from './components.js';\n\nconst coordinator = Coordinator.RenderCoordinator.RenderCoordinator.instance();\n\nconst {assert} = chai;\n\ninterface NodeData {\n  text: string;\n  iconName?: string;\n}\n\ninterface Node {\n  treeNodeData: NodeData;\n  children?: Node[];\n}\n\nasync function renderBackForwardCacheView(): Promise<ApplicationComponents.BackForwardCacheView.BackForwardCacheView> {\n  const component = new ApplicationComponents.BackForwardCacheView.BackForwardCacheView();\n  renderElementIntoDOM(component);\n  await component.render();\n  assertShadowRoot(component.shadowRoot);\n  await coordinator.done();\n  return component;\n}\n\nasync function unpromisify(node: TreeOutline.TreeOutlineUtils.TreeNode<NodeData>): Promise<Node> {\n  const result: Node = {treeNodeData: node.treeNodeData};\n  if (node.children) {\n    const children = await node.children();\n    result.children = await Promise.all(children.map(child => unpromisify(child)));\n  }\n  return result;\n}\n\ndescribeWithMockConnection('BackForwardCacheView', () => {\n  const tests = (targetFactory: () => SDK.Target.Target) => {\n    let target: SDK.Target.Target;\n    let resourceTreeModel: SDK.ResourceTreeModel.ResourceTreeModel;\n\n    beforeEach(() => {\n      target = targetFactory();\n      resourceTreeModel =\n          target.model(SDK.ResourceTreeModel.ResourceTreeModel) as SDK.ResourceTreeModel.ResourceTreeModel;\n      assertNotNullOrUndefined(resourceTreeModel);\n      resourceTreeModel.mainFrame = {\n        url: 'https://www.example.com/' as Platform.DevToolsPath.UrlString,\n        backForwardCacheDetails: {\n          restoredFromCache: true,\n          explanations: [],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n    });\n\n    it('updates BFCacheView on main frame navigation', async () => {\n      await renderBackForwardCacheView();\n      assertNotNullOrUndefined(resourceTreeModel);\n      assertNotNullOrUndefined(resourceTreeModel.mainFrame);\n      resourceTreeModel.dispatchEventToListeners(\n          SDK.ResourceTreeModel.Events.PrimaryPageChanged,\n          {frame: resourceTreeModel.mainFrame, type: SDK.ResourceTreeModel.PrimaryPageChangeType.Navigation});\n\n      await coordinator.done({waitForWork: true});\n    });\n\n    it('updates BFCacheView on BFCache detail update', async () => {\n      await renderBackForwardCacheView();\n      assertNotNullOrUndefined(resourceTreeModel);\n      assertNotNullOrUndefined(resourceTreeModel.mainFrame);\n      resourceTreeModel.dispatchEventToListeners(\n          SDK.ResourceTreeModel.Events.BackForwardCacheDetailsUpdated, resourceTreeModel.mainFrame);\n\n      await coordinator.done({waitForWork: true});\n    });\n\n    it('renders status if restored from BFCache', async () => {\n      resourceTreeModel.mainFrame = {\n        url: 'https://www.example.com/',\n        backForwardCacheDetails: {\n          restoredFromCache: true,\n          explanations: [],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n      const component = await renderBackForwardCacheView();\n      const renderedStatus = component.shadowRoot!.querySelector('devtools-report-section');\n      assert.strictEqual(renderedStatus?.textContent?.trim(), 'Successfully served from back/forward cache.');\n    });\n\n    it('renders explanations if not restorable from BFCache', async () => {\n      resourceTreeModel.mainFrame = {\n        url: 'https://www.example.com/',\n        backForwardCacheDetails: {\n          restoredFromCache: false,\n          explanations: [\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.SupportPending,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.WebLocks,\n            },\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.PageSupportNeeded,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.ServiceWorkerUnregistration,\n            },\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.Circumstantial,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.MainResourceHasCacheControlNoStore,\n            },\n          ],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n      const component = await renderBackForwardCacheView();\n      const sectionHeaders = component.shadowRoot!.querySelectorAll('devtools-report-section-header');\n      const sectionHeadersText = Array.from(sectionHeaders).map(sectionHeader => sectionHeader.textContent?.trim());\n      assert.deepStrictEqual(sectionHeadersText, ['Actionable', 'Pending Support', 'Not Actionable']);\n\n      const sections = component.shadowRoot!.querySelectorAll('devtools-report-section');\n      const sectionsText = Array.from(sections).map(section => section.textContent?.trim());\n      const expected = [\n        'Not served from back/forward cache: to trigger back/forward cache, use Chrome\\'s back/forward buttons, or use the test button below to automatically navigate away and back.',\n        'Test back/forward cache',\n        'ServiceWorker was unregistered while a page was in back/forward cache.',\n        'Pages that use WebLocks are not currently eligible for back/forward cache.',\n        'Pages whose main resource has cache-control:no-store cannot enter back/forward cache.',\n        'Learn more: back/forward cache eligibility',\n      ];\n      assert.deepStrictEqual(sectionsText, expected);\n    });\n\n    it('renders explanation tree', async () => {\n      resourceTreeModel.mainFrame = {\n        url: 'https://www.example.com/',\n        backForwardCacheDetails: {\n          restoredFromCache: false,\n          explanationsTree: {\n            url: 'https://www.example.com',\n            explanations: [{\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.SupportPending,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.WebLocks,\n            }],\n            children: [{\n              url: 'https://www.example.com/frame.html',\n              explanations: [{\n                type: Protocol.Page.BackForwardCacheNotRestoredReasonType.Circumstantial,\n                reason: Protocol.Page.BackForwardCacheNotRestoredReason.MainResourceHasCacheControlNoStore,\n              }],\n              children: [],\n            }],\n          },\n          explanations: [\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.SupportPending,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.WebLocks,\n            },\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.Circumstantial,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.MainResourceHasCacheControlNoStore,\n            },\n          ],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n      const component = await renderBackForwardCacheView();\n      const treeOutline = component.shadowRoot!.querySelector('devtools-tree-outline');\n      assertElement(treeOutline, TreeOutline.TreeOutline.TreeOutline);\n      assertShadowRoot(treeOutline.shadowRoot);\n\n      const treeData = await Promise.all(\n          treeOutline.data.tree.map(node => unpromisify(node as TreeOutline.TreeOutlineUtils.TreeNode<NodeData>)));\n\n      const expected = [\n        {\n          treeNodeData: {\n            text: '2 issues found in 2 frames.',\n          },\n          children: [\n            {\n              treeNodeData: {\n                text: '(2) https://www.example.com',\n                iconName: 'frame',\n              },\n              children: [\n                {\n                  treeNodeData: {\n                    text: 'WebLocks',\n                  },\n                },\n                {\n                  treeNodeData: {\n                    text: '(1) https://www.example.com/frame.html',\n                    iconName: 'iframe',\n                  },\n                  children: [\n                    {\n                      treeNodeData: {\n                        text: 'MainResourceHasCacheControlNoStore',\n                      },\n                    },\n                  ],\n                },\n              ],\n            },\n          ],\n        },\n      ];\n\n      assert.deepStrictEqual(treeData, expected);\n    });\n\n    it('renders blocking details if available', async () => {\n      resourceTreeModel.mainFrame = {\n        resourceForURL: () => null,\n        url: 'https://www.example.com/',\n        backForwardCacheDetails: {\n          restoredFromCache: false,\n          explanations: [\n            {\n              type: Protocol.Page.BackForwardCacheNotRestoredReasonType.SupportPending,\n              reason: Protocol.Page.BackForwardCacheNotRestoredReason.WebLocks,\n              details: [\n                {url: 'https://www.example.com/index.html', lineNumber: 10, columnNumber: 5},\n                {url: 'https://www.example.com/script.js', lineNumber: 15, columnNumber: 20},\n              ],\n            },\n          ],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n\n      const component = await renderBackForwardCacheView();\n      const sectionHeaders = component.shadowRoot!.querySelectorAll('devtools-report-section-header');\n      const sectionHeadersText = Array.from(sectionHeaders).map(sectionHeader => sectionHeader.textContent?.trim());\n      assert.deepStrictEqual(sectionHeadersText, ['Pending Support']);\n\n      const sections = component.shadowRoot!.querySelectorAll('devtools-report-section');\n      const sectionsText = Array.from(sections).map(section => section.textContent?.trim());\n      const expected = [\n        'Not served from back/forward cache: to trigger back/forward cache, use Chrome\\'s back/forward buttons, or use the test button below to automatically navigate away and back.',\n        'Test back/forward cache',\n        'Pages that use WebLocks are not currently eligible for back/forward cache.',\n        'Learn more: back/forward cache eligibility',\n      ];\n      assert.deepStrictEqual(sectionsText, expected);\n\n      const details = component.shadowRoot!.querySelector('.details-list devtools-expandable-list');\n      details!.shadowRoot!.querySelector('button')!.click();\n      const items = details!.shadowRoot!.querySelectorAll('.expandable-list-items .devtools-link');\n      const detailsText = Array.from(items).map(detail => detail.textContent?.trim());\n      assert.deepStrictEqual(detailsText, ['www.example.com/index.html:11:6', 'www.example.com/script.js:16:21']);\n    });\n\n    it('can handle delayed navigation history when testing for BFcache availability', async () => {\n      const entries = [\n        {\n          id: 5,\n          url: 'about:blank',\n          userTypedURL: 'about:blank',\n          title: '',\n          transitionType: Protocol.Page.TransitionType.Typed,\n        },\n        {\n          id: 8,\n          url: 'chrome://terms/',\n          userTypedURL: '',\n          title: '',\n          transitionType: Protocol.Page.TransitionType.Typed,\n        },\n      ];\n      const stub = sinon.stub();\n      stub.onCall(0).returns({entries, currentIndex: 0});\n      stub.onCall(1).returns({entries, currentIndex: 0});\n      stub.onCall(2).returns({entries, currentIndex: 0});\n      stub.onCall(3).returns({entries, currentIndex: 0});\n      stub.onCall(4).returns({entries, currentIndex: 1});\n      resourceTreeModel.navigationHistory = stub;\n\n      resourceTreeModel.navigate = (url: Platform.DevToolsPath.UrlString) => {\n        resourceTreeModel.frameNavigated({url} as unknown as Protocol.Page.Frame, undefined);\n        return Promise.resolve({frameId: '' as Protocol.Page.FrameId, getError(): undefined {}});\n      };\n      resourceTreeModel.navigateToHistoryEntry = (entry: Protocol.Page.NavigationEntry) => {\n        resourceTreeModel.frameNavigated({url: entry.url} as unknown as Protocol.Page.Frame, undefined);\n      };\n      const navigateToHistoryEntrySpy = sinon.spy(resourceTreeModel, 'navigateToHistoryEntry');\n      resourceTreeModel.storageKeyForFrame = () => Promise.resolve(null);\n\n      resourceTreeModel.mainFrame = {\n        url: 'about:blank',\n        backForwardCacheDetails: {\n          restoredFromCache: true,\n          explanations: [],\n        },\n      } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame;\n      const component = await renderBackForwardCacheView();\n      const button = component.shadowRoot!.querySelector('[aria-label=\"Test back/forward cache\"]');\n      assertElement(button, HTMLElement);\n      dispatchClickEvent(button);\n\n      await new Promise<void>(resolve => {\n        let eventCounter = 0;\n        resourceTreeModel.addEventListener(SDK.ResourceTreeModel.Events.FrameNavigated, () => {\n          if (++eventCounter === 2) {\n            resolve();\n          }\n        });\n      });\n      assert.isTrue(navigateToHistoryEntrySpy.calledOnceWithExactly(entries[0]));\n    });\n  };\n  describe('without tab target', () => tests(() => createTarget()));\n  describe('with tab target', () => tests(() => {\n                                const tabTarget = createTarget({type: SDK.Target.Type.Tab});\n                                createTarget({parentTarget: tabTarget, subtype: 'prerender'});\n                                return createTarget({parentTarget: tabTarget});\n                              }));\n});\n"]}