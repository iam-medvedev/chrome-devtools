{"version":3,"file":"BackForwardCacheView.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/BackForwardCacheView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport '../../../ui/components/chrome_link/chrome_link.js';\nimport '../../../ui/components/expandable_list/expandable_list.js';\nimport '../../../ui/components/report_view/report_view.js';\nimport '../../../ui/components/tree_outline/tree_outline.js';\n\nimport * as Common from '../../../core/common/common.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as SDK from '../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../generated/protocol.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport type * as ExpandableList from '../../../ui/components/expandable_list/expandable_list.js';\nimport type * as IconButton from '../../../ui/components/icon_button/icon_button.js';\nimport * as LegacyWrapper from '../../../ui/components/legacy_wrapper/legacy_wrapper.js';\nimport * as RenderCoordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\nimport type * as ReportView from '../../../ui/components/report_view/report_view.js';\nimport type * as TreeOutline from '../../../ui/components/tree_outline/tree_outline.js';\nimport * as Components from '../../../ui/legacy/components/utils/utils.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport {NotRestoredReasonDescription} from './BackForwardCacheStrings.js';\nimport backForwardCacheViewStylesRaw from './backForwardCacheView.css.js';\n\n// TODO(crbug.com/391381439): Fully migrate off of constructed style sheets.\nconst backForwardCacheViewStyles = new CSSStyleSheet();\nbackForwardCacheViewStyles.replaceSync(backForwardCacheViewStylesRaw.cssContent);\n\nconst {html} = Lit;\n\nconst UIStrings = {\n  /**\n   * @description Title text in back/forward cache view of the Application panel\n   */\n  mainFrame: 'Main Frame',\n  /**\n   * @description Title text in back/forward cache view of the Application panel\n   */\n  backForwardCacheTitle: 'Back/forward cache',\n  /**\n   * @description Status text for the status of the main frame\n   */\n  unavailable: 'unavailable',\n  /**\n   * @description Entry name text in the back/forward cache view of the Application panel\n   */\n  url: 'URL:',\n  /**\n   * @description Status text for the status of the back/forward cache status\n   */\n  unknown: 'Unknown Status',\n  /**\n   * @description Status text for the status of the back/forward cache status indicating that\n   * the back/forward cache was not used and a normal navigation occured instead.\n   */\n  normalNavigation:\n      'Not served from back/forward cache: to trigger back/forward cache, use Chrome\\'s back/forward buttons, or use the test button below to automatically navigate away and back.',\n  /**\n   * @description Status text for the status of the back/forward cache status indicating that\n   * the back/forward cache was used to restore the page instead of reloading it.\n   */\n  restoredFromBFCache: 'Successfully served from back/forward cache.',\n  /**\n   * @description Label for a list of reasons which prevent the page from being eligible for\n   * back/forward cache. These reasons are actionable i.e. they can be cleaned up to make the\n   * page eligible for back/forward cache.\n   */\n  pageSupportNeeded: 'Actionable',\n  /**\n   * @description Explanation for actionable items which prevent the page from being eligible\n   * for back/forward cache.\n   */\n  pageSupportNeededExplanation:\n      'These reasons are actionable i.e. they can be cleaned up to make the page eligible for back/forward cache.',\n  /**\n   * @description Label for a list of reasons which prevent the page from being eligible for\n   * back/forward cache. These reasons are circumstantial / not actionable i.e. they cannot be\n   * cleaned up by developers to make the page eligible for back/forward cache.\n   */\n  circumstantial: 'Not Actionable',\n  /**\n   * @description Explanation for circumstantial/non-actionable items which prevent the page from being eligible\n   * for back/forward cache.\n   */\n  circumstantialExplanation:\n      'These reasons are not actionable i.e. caching was prevented by something outside of the direct control of the page.',\n  /**\n   * @description Label for a list of reasons which prevent the page from being eligible for\n   * back/forward cache. These reasons are pending support by chrome i.e. in a future version\n   * of chrome they will not prevent back/forward cache usage anymore.\n   */\n  supportPending: 'Pending Support',\n  /**\n   * @description Label for the button to test whether BFCache is available for the page\n   */\n  runTest: 'Test back/forward cache',\n  /**\n   * @description Label for the disabled button while the test is running\n   */\n  runningTest: 'Running test',\n  /**\n   * @description Link Text about explanation of back/forward cache\n   */\n  learnMore: 'Learn more: back/forward cache eligibility',\n  /**\n   * @description Link Text about unload handler\n   */\n  neverUseUnload: 'Learn more: Never use unload handler',\n  /**\n   * @description Explanation for 'pending support' items which prevent the page from being eligible\n   * for back/forward cache.\n   */\n  supportPendingExplanation:\n      'Chrome support for these reasons is pending i.e. they will not prevent the page from being eligible for back/forward cache in a future version of Chrome.',\n  /**\n   * @description Text that precedes displaying a link to the extension which blocked the page from being eligible for back/forward cache.\n   */\n  blockingExtensionId: 'Extension id: ',\n  /**\n   * @description Label for the 'Frames' section of the back/forward cache view, which shows a frame tree of the\n   * page with reasons why the frames can't be cached.\n   */\n  framesTitle: 'Frames',\n  /**\n   * @description Top level summary of the total number of issues found in a single frame.\n   */\n  issuesInSingleFrame: '{n, plural, =1 {# issue found in 1 frame.} other {# issues found in 1 frame.}}',\n  /**\n   * @description Top level summary of the total number of issues found and the number of frames they were found in.\n   * 'm' is never less than 2.\n   * @example {3} m\n   */\n  issuesInMultipleFrames: '{n, plural, =1 {# issue found in {m} frames.} other {# issues found in {m} frames.}}',\n  /**\n   * @description Shows the number of frames with a particular issue.\n   */\n  framesPerIssue: '{n, plural, =1 {# frame} other {# frames}}',\n  /**\n   *@description Title for a frame in the frame tree that doesn't have a URL. Placeholder indicates which number frame with a blank URL it is.\n   *@example {3} PH1\n   */\n  blankURLTitle: 'Blank URL [{PH1}]',\n  /**\n   * @description Shows the number of files with a particular issue.\n   */\n  filesPerIssue: '{n, plural, =1 {# file} other {# files}}',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('panels/application/components/BackForwardCacheView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nconst enum ScreenStatusType {\n  RUNNING = 'Running',\n  RESULT = 'Result',\n}\n\nexport class BackForwardCacheView extends LegacyWrapper.LegacyWrapper.WrappableComponent {\n  readonly #shadow = this.attachShadow({mode: 'open'});\n  #screenStatus = ScreenStatusType.RESULT;\n  #nextNodeId = 0;\n  #historyIndex = 0;\n\n  constructor() {\n    super();\n    this.#getMainResourceTreeModel()?.addEventListener(\n        SDK.ResourceTreeModel.Events.PrimaryPageChanged, this.render, this);\n    this.#getMainResourceTreeModel()?.addEventListener(\n        SDK.ResourceTreeModel.Events.BackForwardCacheDetailsUpdated, this.render, this);\n  }\n\n  #getMainResourceTreeModel(): SDK.ResourceTreeModel.ResourceTreeModel|null {\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    return mainTarget?.model(SDK.ResourceTreeModel.ResourceTreeModel) || null;\n  }\n\n  #getMainFrame(): SDK.ResourceTreeModel.ResourceTreeFrame|null {\n    return this.#getMainResourceTreeModel()?.mainFrame || null;\n  }\n  connectedCallback(): void {\n    this.parentElement?.classList.add('overflow-auto');\n    this.#shadow.adoptedStyleSheets = [backForwardCacheViewStyles];\n  }\n\n  override async render(): Promise<void> {\n    await RenderCoordinator.write('BackForwardCacheView render', () => {\n      // Disabled until https://crbug.com/1079231 is fixed.\n      // clang-format off\n      Lit.render(html`\n        <devtools-report .data=${\n            {reportTitle: i18nString(UIStrings.backForwardCacheTitle)} as ReportView.ReportView.ReportData\n        } jslog=${VisualLogging.pane('back-forward-cache')}>\n\n          ${this.#renderMainFrameInformation()}\n        </devtools-report>\n      `, this.#shadow, {host: this});\n      // clang-format on\n    });\n  }\n\n  #renderBackForwardCacheTestResult(): void {\n    SDK.TargetManager.TargetManager.instance().removeModelListener(\n        SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.FrameNavigated,\n        this.#renderBackForwardCacheTestResult, this);\n    this.#screenStatus = ScreenStatusType.RESULT;\n    void this.render();\n  }\n\n  async #onNavigatedAway(): Promise<void> {\n    SDK.TargetManager.TargetManager.instance().removeModelListener(\n        SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.FrameNavigated, this.#onNavigatedAway,\n        this);\n    await this.#waitAndGoBackInHistory(50);\n  }\n\n  async #waitAndGoBackInHistory(delay: number): Promise<void> {\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    const resourceTreeModel = mainTarget?.model(SDK.ResourceTreeModel.ResourceTreeModel);\n    const historyResults = await resourceTreeModel?.navigationHistory();\n    if (!resourceTreeModel || !historyResults) {\n      return;\n    }\n    // The navigation history can be delayed. If this is the case we wait and\n    // check again later. Otherwise it would be possible to press the 'Test\n    // BFCache' button again too soon, leading to the browser stepping back in\n    // history without returning to the correct page.\n    if (historyResults.currentIndex === this.#historyIndex) {\n      window.setTimeout(this.#waitAndGoBackInHistory.bind(this, delay * 2), delay);\n    } else {\n      SDK.TargetManager.TargetManager.instance().addModelListener(\n          SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.FrameNavigated,\n          this.#renderBackForwardCacheTestResult, this);\n      resourceTreeModel.navigateToHistoryEntry(historyResults.entries[historyResults.currentIndex - 1]);\n    }\n  }\n\n  async #navigateAwayAndBack(): Promise<void> {\n    // Checking BFCache Compatibility\n\n    const mainTarget = SDK.TargetManager.TargetManager.instance().primaryPageTarget();\n    const resourceTreeModel = mainTarget?.model(SDK.ResourceTreeModel.ResourceTreeModel);\n    const historyResults = await resourceTreeModel?.navigationHistory();\n    if (!resourceTreeModel || !historyResults) {\n      return;\n    }\n    this.#historyIndex = historyResults.currentIndex;\n    this.#screenStatus = ScreenStatusType.RUNNING;\n    void this.render();\n\n    // This event listener is removed inside of onNavigatedAway().\n    SDK.TargetManager.TargetManager.instance().addModelListener(\n        SDK.ResourceTreeModel.ResourceTreeModel, SDK.ResourceTreeModel.Events.FrameNavigated, this.#onNavigatedAway,\n        this);\n\n    // We can know whether the current page can use BFCache\n    // as the browser navigates to another unrelated page and goes back to the current page.\n    // We chose \"chrome://terms\" because it must be cross-site.\n    // Ideally, We want to have our own testing page like \"chrome: //bfcache-test\".\n    void resourceTreeModel.navigate('chrome://terms' as Platform.DevToolsPath.UrlString);\n  }\n\n  #renderMainFrameInformation(): Lit.TemplateResult {\n    const frame = this.#getMainFrame();\n    if (!frame) {\n      // clang-format off\n      return html`\n        <devtools-report-key>\n          ${i18nString(UIStrings.mainFrame)}\n        </devtools-report-key>\n        <devtools-report-value>\n          ${i18nString(UIStrings.unavailable)}\n        </devtools-report-value>\n      `;\n      // clang-format on\n    }\n    const isTestRunning = (this.#screenStatus === ScreenStatusType.RUNNING);\n    // Prevent running BFCache test on the DevTools window itself via DevTools on DevTools\n    const isTestingForbidden = Common.ParsedURL.schemeIs(frame.url, 'devtools:');\n    // clang-format off\n    return html`\n      ${this.#renderBackForwardCacheStatus(frame.backForwardCacheDetails.restoredFromCache)}\n      <div class=\"report-line\">\n        <div class=\"report-key\">\n          ${i18nString(UIStrings.url)}\n        </div>\n        <div class=\"report-value\" title=${frame.url}>\n          ${frame.url}\n        </div>\n      </div>\n      ${this.#maybeRenderFrameTree(frame.backForwardCacheDetails.explanationsTree)}\n      <devtools-report-section>\n        <devtools-button\n          aria-label=${i18nString(UIStrings.runTest)}\n          .disabled=${isTestRunning || isTestingForbidden}\n          .spinner=${isTestRunning}\n          .variant=${Buttons.Button.Variant.PRIMARY}\n          @click=${this.#navigateAwayAndBack}\n          jslog=${VisualLogging.action('back-forward-cache.run-test').track({click: true})}>\n          ${isTestRunning ? html`\n            ${i18nString(UIStrings.runningTest)}`:`\n            ${i18nString(UIStrings.runTest)}\n          `}\n        </devtools-button>\n      </devtools-report-section>\n      <devtools-report-divider>\n      </devtools-report-divider>\n      ${this.#maybeRenderExplanations(frame.backForwardCacheDetails.explanations,\n          frame.backForwardCacheDetails.explanationsTree)}\n      <devtools-report-section>\n        <x-link href=\"https://web.dev/bfcache/\" class=\"link\"\n        jslog=${VisualLogging.action('learn-more.eligibility').track({click: true})}>\n          ${i18nString(UIStrings.learnMore)}\n        </x-link>\n      </devtools-report-section>\n    `;\n    // clang-format on\n  }\n\n  #maybeRenderFrameTree(explanationTree: Protocol.Page.BackForwardCacheNotRestoredExplanationTree|\n                        undefined): Lit.LitTemplate {\n    if (!explanationTree || (explanationTree.explanations.length === 0 && explanationTree.children.length === 0)) {\n      return Lit.nothing;\n    }\n\n    function treeNodeRenderer(node: TreeOutline.TreeOutlineUtils.TreeNode<FrameTreeNodeData>): Lit.TemplateResult {\n      // clang-format off\n      return html`\n        <div class=\"text-ellipsis\">\n          ${node.treeNodeData.iconName ? html`\n            <devtools-icon class=\"inline-icon\" style=\"margin-bottom: -3px;\" .data=${{\n              iconName: node.treeNodeData.iconName,\n              color: 'var(--icon-default)',\n              width: '20px',\n              height: '20px',\n            } as IconButton.Icon.IconData}>\n            </devtools-icon>\n          ` : Lit.nothing}\n          ${node.treeNodeData.text}\n        </div>\n      `;\n      // clang-format on\n    }\n\n    const frameTreeData = this.#buildFrameTreeDataRecursive(explanationTree, {blankCount: 1});\n    // Override the icon for the outermost frame.\n    frameTreeData.node.treeNodeData.iconName = 'frame';\n    let title = '';\n    // The translation pipeline does not support nested plurals. We avoid this\n    // here by pulling out the logic for one of the plurals into code instead.\n    if (frameTreeData.frameCount === 1) {\n      title = i18nString(UIStrings.issuesInSingleFrame, {n: frameTreeData.issueCount});\n    } else {\n      title = i18nString(UIStrings.issuesInMultipleFrames, {n: frameTreeData.issueCount, m: frameTreeData.frameCount});\n    }\n    const root: TreeOutline.TreeOutlineUtils.TreeNode<FrameTreeNodeData> = {\n      treeNodeData: {\n        text: title,\n      },\n      id: 'root',\n      children: () => Promise.resolve([frameTreeData.node]),\n    };\n\n    // clang-format off\n    return html`\n      <div class=\"report-line\"\n      jslog=${VisualLogging.section('frames')}>\n        <div class=\"report-key\">\n          ${i18nString(UIStrings.framesTitle)}\n        </div>\n        <div class=\"report-value\">\n          <devtools-tree-outline .data=${{\n            tree: [root],\n            defaultRenderer: treeNodeRenderer,\n            compact: true,\n          } as TreeOutline.TreeOutline.TreeOutlineData<FrameTreeNodeData>}>\n          </devtools-tree-outline>\n        </div>\n      </div>\n    `;\n    // clang-format on\n  }\n\n  // Builds a subtree of the frame tree, conaining only frames with BFCache issues and their ancestors.\n  // Returns the root node, the number of frames in the subtree, and the number of issues in the subtree.\n  #buildFrameTreeDataRecursive(\n      explanationTree: Protocol.Page.BackForwardCacheNotRestoredExplanationTree,\n      nextBlankURLCount: {blankCount: number}):\n      {node: TreeOutline.TreeOutlineUtils.TreeNode<FrameTreeNodeData>, frameCount: number, issueCount: number} {\n    let frameCount = 1;\n    let issueCount = 0;\n    const children: TreeOutline.TreeOutlineUtils.TreeNode<FrameTreeNodeData>[] = [];\n\n    let nodeUrlText = '';\n    if (explanationTree.url.length) {\n      nodeUrlText = explanationTree.url;\n    } else {\n      nodeUrlText = i18nString(UIStrings.blankURLTitle, {PH1: nextBlankURLCount.blankCount});\n      nextBlankURLCount.blankCount += 1;\n    }\n\n    for (const explanation of explanationTree.explanations) {\n      const child = {treeNodeData: {text: explanation.reason}, id: String(this.#nextNodeId++)};\n      issueCount += 1;\n      children.push(child);\n    }\n    for (const child of explanationTree.children) {\n      const frameTreeData = this.#buildFrameTreeDataRecursive(child, nextBlankURLCount);\n      if (frameTreeData.issueCount > 0) {\n        children.push(frameTreeData.node);\n        issueCount += frameTreeData.issueCount;\n        frameCount += frameTreeData.frameCount;\n      }\n    }\n\n    let node: TreeOutline.TreeOutlineUtils.TreeNode<FrameTreeNodeData> = {\n      treeNodeData: {\n        text: `(${issueCount}) ${nodeUrlText}`,\n      },\n      id: String(this.#nextNodeId++),\n    };\n    if (children.length) {\n      node = {\n        ...node,\n        children: () => Promise.resolve(children),\n      };\n      node.treeNodeData.iconName = 'iframe';\n    } else if (!explanationTree.url.length) {\n      // If the current node increased the blank count, but it has no children and\n      // is therefore not shown, decrement the blank count again.\n      nextBlankURLCount.blankCount -= 1;\n    }\n    return {node, frameCount, issueCount};\n  }\n\n  #renderBackForwardCacheStatus(status: boolean|undefined): Lit.TemplateResult {\n    switch (status) {\n      case true:\n        // clang-format off\n        return html`\n          <devtools-report-section>\n            <div class=\"status\">\n              <devtools-icon class=\"inline-icon\" .data=${{\n                iconName: 'check-circle',\n                color: 'var(--icon-checkmark-green)',\n                width: '20px',\n                height: '20px',\n                } as IconButton.Icon.IconData}>\n              </devtools-icon>\n            </div>\n            ${i18nString(UIStrings.restoredFromBFCache)}\n          </devtools-report-section>\n        `;\n        // clang-format on\n      case false:\n        // clang-format off\n        return html`\n          <devtools-report-section>\n            <div class=\"status\">\n              <devtools-icon class=\"inline-icon\" .data=${{\n                  iconName: 'clear',\n                  color: 'var(--icon-default)',\n                  width: '20px',\n                  height: '20px',\n                  } as IconButton.Icon.IconData}>\n              </devtools-icon>\n            </div>\n            ${i18nString(UIStrings.normalNavigation)}\n          </devtools-report-section>\n        `;\n        // clang-format on\n    }\n    // clang-format off\n    return html`\n    <devtools-report-section>\n      ${i18nString(UIStrings.unknown)}\n    </devtools-report-section>\n    `;\n    // clang-format on\n  }\n\n  #buildReasonToFramesMap(\n      explanationTree: Protocol.Page.BackForwardCacheNotRestoredExplanationTree,\n      nextBlankURLCount: {blankCount: number},\n      outputMap: Map<Protocol.Page.BackForwardCacheNotRestoredReason, string[]>): void {\n    let url = explanationTree.url;\n    if (url.length === 0) {\n      url = i18nString(UIStrings.blankURLTitle, {PH1: nextBlankURLCount.blankCount});\n      nextBlankURLCount.blankCount += 1;\n    }\n    explanationTree.explanations.forEach(explanation => {\n      let frames: string[]|undefined = outputMap.get(explanation.reason);\n      if (frames === undefined) {\n        frames = [url];\n        outputMap.set(explanation.reason, frames);\n      } else {\n        frames.push(url);\n      }\n    });\n    explanationTree.children.map(child => {\n      this.#buildReasonToFramesMap(child, nextBlankURLCount, outputMap);\n    });\n  }\n\n  #maybeRenderExplanations(\n      explanations: Protocol.Page.BackForwardCacheNotRestoredExplanation[],\n      explanationTree: Protocol.Page.BackForwardCacheNotRestoredExplanationTree|undefined): Lit.LitTemplate {\n    if (explanations.length === 0) {\n      return Lit.nothing;\n    }\n\n    const pageSupportNeeded = explanations.filter(\n        explanation => explanation.type === Protocol.Page.BackForwardCacheNotRestoredReasonType.PageSupportNeeded);\n    const supportPending = explanations.filter(\n        explanation => explanation.type === Protocol.Page.BackForwardCacheNotRestoredReasonType.SupportPending);\n    const circumstantial = explanations.filter(\n        explanation => explanation.type === Protocol.Page.BackForwardCacheNotRestoredReasonType.Circumstantial);\n\n    const reasonToFramesMap: Map<Protocol.Page.BackForwardCacheNotRestoredReason, string[]> = new Map();\n    if (explanationTree) {\n      this.#buildReasonToFramesMap(explanationTree, {blankCount: 1}, reasonToFramesMap);\n    }\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    return html`\n      ${this.#renderExplanations(i18nString(UIStrings.pageSupportNeeded), i18nString(UIStrings.pageSupportNeededExplanation), pageSupportNeeded, reasonToFramesMap)}\n      ${this.#renderExplanations(i18nString(UIStrings.supportPending), i18nString(UIStrings.supportPendingExplanation), supportPending, reasonToFramesMap)}\n      ${this.#renderExplanations(i18nString(UIStrings.circumstantial), i18nString(UIStrings.circumstantialExplanation), circumstantial, reasonToFramesMap)}\n    `;\n    // clang-format on\n  }\n\n  #renderExplanations(\n      category: Platform.UIString.LocalizedString, explainerText: Platform.UIString.LocalizedString,\n      explanations: Protocol.Page.BackForwardCacheNotRestoredExplanation[],\n      reasonToFramesMap: Map<Protocol.Page.BackForwardCacheNotRestoredReason, string[]>): Lit.TemplateResult {\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n    return html`\n      ${explanations.length > 0 ? html`\n        <devtools-report-section-header>\n          ${category}\n          <div class=\"help-outline-icon\">\n            <devtools-icon class=\"inline-icon\" .data=${{\n              iconName: 'help',\n              color: 'var(--icon-default)',\n              width: '16px',\n              height: '16px',\n              } as IconButton.Icon.IconData} title=${explainerText}>\n            </devtools-icon>\n          </div>\n        </devtools-report-section-header>\n        ${explanations.map(explanation => this.#renderReason(explanation, reasonToFramesMap.get(explanation.reason)))}\n      ` : Lit.nothing}\n    `;\n    // clang-format on\n  }\n\n  #maybeRenderReasonContext(explanation: Protocol.Page.BackForwardCacheNotRestoredExplanation): Lit.LitTemplate {\n    if (explanation.reason ===\n            Protocol.Page.BackForwardCacheNotRestoredReason.EmbedderExtensionSentMessageToCachedFrame &&\n        explanation.context) {\n      const link = 'chrome://extensions/?id=' + explanation.context as Platform.DevToolsPath.UrlString;\n      // clang-format off\n    return html`${i18nString(UIStrings.blockingExtensionId)}\n      <devtools-chrome-link .href=${link}>${explanation.context}</devtools-chrome-link>`;\n      // clang-format on\n    }\n    return Lit.nothing;\n  }\n\n  #renderFramesPerReason(frames: string[]|undefined): Lit.LitTemplate {\n    if (frames === undefined || frames.length === 0) {\n      return Lit.nothing;\n    }\n    const rows = [html`<div>${i18nString(UIStrings.framesPerIssue, {n: frames.length})}</div>`];\n    rows.push(...frames.map(url => html`<div class=\"text-ellipsis\" title=${url}\n    jslog=${VisualLogging.treeItem()}>${url}</div>`));\n    return html`\n      <div class=\"details-list\"\n      jslog=${VisualLogging.tree('frames-per-issue')}>\n        <devtools-expandable-list .data=${{\n      rows,\n      title: i18nString(UIStrings.framesPerIssue, {n: frames.length}),\n    } as ExpandableList.ExpandableList.ExpandableListData}\n        jslog=${VisualLogging.treeItem()}></devtools-expandable-list>\n      </div>\n    `;\n  }\n\n  #maybeRenderDeepLinkToUnload(explanation: Protocol.Page.BackForwardCacheNotRestoredExplanation): Lit.LitTemplate {\n    if (explanation.reason === Protocol.Page.BackForwardCacheNotRestoredReason.UnloadHandlerExistsInMainFrame ||\n        explanation.reason === Protocol.Page.BackForwardCacheNotRestoredReason.UnloadHandlerExistsInSubFrame) {\n      return html`\n        <x-link href=\"https://web.dev/bfcache/#never-use-the-unload-event\" class=\"link\"\n        jslog=${VisualLogging.action('learn-more.never-use-unload').track({\n        click: true,\n      })}>\n          ${i18nString(UIStrings.neverUseUnload)}\n        </x-link>`;\n    }\n    return Lit.nothing;\n  }\n\n  #maybeRenderJavaScriptDetails(details: Protocol.Page.BackForwardCacheBlockingDetails[]|undefined): Lit.LitTemplate {\n    if (details === undefined || details.length === 0) {\n      return Lit.nothing;\n    }\n    const maxLengthForDisplayedURLs = 50;\n    const linkifier = new Components.Linkifier.Linkifier(maxLengthForDisplayedURLs);\n    const rows = [html`<div>${i18nString(UIStrings.filesPerIssue, {n: details.length})}</div>`];\n    rows.push(...details.map(\n        detail => html`${\n            linkifier.linkifyScriptLocation(\n                null, null, detail.url as Platform.DevToolsPath.UrlString, detail.lineNumber, {\n                  columnNumber: detail.columnNumber,\n                  showColumnNumber: true,\n                  inlineFrameIndex: 0,\n                })}`));\n    return html`\n      <div class=\"details-list\">\n        <devtools-expandable-list .data=${\n        {rows} as ExpandableList.ExpandableList.ExpandableListData}></devtools-expandable-list>\n      </div>\n    `;\n  }\n\n  #renderReason(explanation: Protocol.Page.BackForwardCacheNotRestoredExplanation, frames: string[]|undefined):\n      Lit.TemplateResult {\n    // clang-format off\n    return html`\n      <devtools-report-section>\n        ${(explanation.reason in NotRestoredReasonDescription) ?\n          html`\n            <div class=\"circled-exclamation-icon\">\n              <devtools-icon class=\"inline-icon\" .data=${{\n                iconName: 'warning',\n                color: 'var(--icon-warning)',\n                width: '16px',\n                height: '16px',\n              } as IconButton.Icon.IconData}>\n              </devtools-icon>\n            </div>\n            <div>\n              ${NotRestoredReasonDescription[explanation.reason].name()}\n              ${this.#maybeRenderDeepLinkToUnload(explanation)}\n              ${this.#maybeRenderReasonContext(explanation)}\n           </div>` :\n            Lit.nothing}\n      </devtools-report-section>\n      <div class=\"gray-text\">\n        ${explanation.reason}\n      </div>\n      ${this.#maybeRenderJavaScriptDetails(explanation.details)}\n      ${this.#renderFramesPerReason(frames)}\n    `;\n    // clang-format on\n  }\n}\n\ninterface FrameTreeNodeData {\n  text: string;\n  iconName?: string;\n}\n\ncustomElements.define('devtools-resources-back-forward-cache-view', BackForwardCacheView);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-resources-back-forward-cache-view': BackForwardCacheView;\n  }\n}\n"]}