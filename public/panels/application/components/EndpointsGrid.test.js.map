{"version":3,"file":"EndpointsGrid.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/application/components/EndpointsGrid.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {getHeaderCells, getValuesOfAllBodyRows} from '../../../testing/DataGridHelpers.js';\nimport {\n  renderElementIntoDOM,\n} from '../../../testing/DOMHelpers.js';\nimport {describeWithLocale} from '../../../testing/EnvironmentHelpers.js';\nimport * as RenderCoordinator from '../../../ui/components/render_coordinator/render_coordinator.js';\n\nimport * as ApplicationComponents from './components.js';\n\nconst renderEndpointsGrid = async (data?: ApplicationComponents.EndpointsGrid.EndpointsGridData|null) => {\n  const component = new ApplicationComponents.EndpointsGrid.EndpointsGrid();\n  component.style.display = 'block';\n  component.style.width = '640px';\n  component.style.height = '480px';\n  if (data) {\n    component.data = data;\n  }\n  renderElementIntoDOM(component);\n  assert.isNotNull(component.shadowRoot);\n  await RenderCoordinator.done({waitForWork: true});\n  if (!data) {\n    return component;\n  }\n\n  const datagrid = component.shadowRoot.querySelector('devtools-data-grid')!;\n  assert.isNotNull(datagrid.shadowRoot);\n  return datagrid;\n};\n\ndescribeWithLocale('EndpointsGrid', () => {\n  it('displays placeholder text if no data', async () => {\n    const component = new ApplicationComponents.EndpointsGrid.EndpointsGrid();\n    renderElementIntoDOM(component);\n    await RenderCoordinator.done();\n\n    const placeholderHeader = component.shadowRoot!.querySelector('.empty-state-header');\n    assert.strictEqual(placeholderHeader?.textContent, 'No endpoints to display');\n    const placeholderDescription = component.shadowRoot!.querySelector('.empty-state-description');\n    assert.strictEqual(\n        placeholderDescription?.textContent, 'Here you will find the list of endpoints that receive the reports');\n  });\n\n  it('renders grid with correct content', async () => {\n    const endpoints = new Map([\n      [\n        'https://www.my-page.com',\n        [\n          {url: 'https://www.reports-endpoint/main', groupName: 'main-endpoint'},\n          {url: 'https://www.reports-endpoint/default', groupName: 'default'},\n        ],\n      ],\n      [\n        'https://www.other-page.com',\n        [\n          {url: 'https://www.csp-reports/csp', groupName: 'csp-endpoint'},\n        ],\n      ],\n    ]);\n    const data = {endpoints};\n\n    const dataGrid = await renderEndpointsGrid(data);\n    assert.isNotNull(dataGrid.shadowRoot);\n\n    const header = getHeaderCells(dataGrid.shadowRoot).map(({textContent}) => textContent!.trim());\n    assert.deepEqual(header, ['Origin', 'Name', 'URL']);\n\n    const rowValues = getValuesOfAllBodyRows(dataGrid.shadowRoot);\n    assert.lengthOf(rowValues, 3);\n    assert.strictEqual(rowValues[0][0], 'https://www.my-page.com', 'Endpoint origin does not match');\n    assert.strictEqual(rowValues[0][1], 'main-endpoint', 'Endpoint name does not match');\n    assert.strictEqual(rowValues[0][2], 'https://www.reports-endpoint/main', 'Endpoint URL does not match');\n    assert.strictEqual(rowValues[1][0], 'https://www.my-page.com', 'Endpoint origin does not match');\n    assert.strictEqual(rowValues[1][1], 'default', 'Endpoint name does not match');\n    assert.strictEqual(rowValues[1][2], 'https://www.reports-endpoint/default', 'Endpoint URL does not match');\n    assert.strictEqual(rowValues[2][0], 'https://www.other-page.com', 'Endpoint origin does not match');\n    assert.strictEqual(rowValues[2][1], 'csp-endpoint', 'Endpoint name does not match');\n    assert.strictEqual(rowValues[2][2], 'https://www.csp-reports/csp', 'Endpoint URL does not match');\n  });\n});\n"]}