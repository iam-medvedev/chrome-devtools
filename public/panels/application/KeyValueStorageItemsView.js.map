{"version":3,"file":"KeyValueStorageItemsView.js","sourceRoot":"","sources":["../../../../../../front_end/panels/application/KeyValueStorageItemsView.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/*\n * Copyright (C) 2008 Nokia Inc.  All rights reserved.\n * Copyright (C) 2013 Samsung Electronics. All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n/* eslint no-return-assign: \"off\" */\nimport * as i18n from '../../core/i18n/i18n.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {Directives as LitDirectives, html, nothing, render} from '../../ui/lit/lit.js';\nimport * as VisualLogging from '../../ui/visual_logging/visual_logging.js';\n\nimport * as ApplicationComponents from './components/components.js';\nimport {StorageItemsToolbar} from './StorageItemsToolbar.js';\n\nconst {ARIAUtils} = UI;\nconst {EmptyWidget} = UI.EmptyWidget;\nconst {VBox, widgetConfig} = UI.Widget;\nconst {Size} = UI.Geometry;\nconst {repeat} = LitDirectives;\n\ntype Widget = UI.Widget.Widget;\ntype VBox = UI.Widget.VBox;\n\nconst UIStrings = {\n  /**\n   *@description Text that shows in the Application Panel if no value is selected for preview\n   */\n  noPreviewSelected: 'No value selected',\n  /**\n   *@description Preview text when viewing storage in Application panel\n   */\n  selectAValueToPreview: 'Select a value to preview',\n  /**\n   *@description Text for announcing number of entries after filtering\n   *@example {5} PH1\n   */\n  numberEntries: 'Number of entries shown in table: {PH1}',\n  /**\n   *@description Text in DOMStorage Items View of the Application panel\n   */\n  key: 'Key',\n  /**\n   *@description Text for the value of something\n   */\n  value: 'Value',\n} as const;\nconst str_ = i18n.i18n.registerUIStrings('panels/application/KeyValueStorageItemsView.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport interface ViewInput {\n  items: Array<{key: string, value: string}>;\n  selectedKey: string|null;\n  editable: boolean;\n  preview: Widget;\n  onSelect: (event: CustomEvent<HTMLElement|null>) => void;\n  onSort: (event: CustomEvent<{columnId: string, ascending: boolean}>) => void;\n  onCreate: (event: CustomEvent<{key: string, value: string}>) => void;\n  onReferesh: () => void;\n  onEdit:\n      (event: CustomEvent<{node: HTMLElement, columnId: string, valueBeforeEditing: string, newText: string}>) => void;\n  onDelete: (event: CustomEvent<HTMLElement>) => void;\n}\n\ninterface ViewOutput {\n  toolbar: StorageItemsToolbar;\n}\n\nconst MAX_VALUE_LENGTH = 4096;\n\nexport type View = (input: ViewInput, output: ViewOutput, target: HTMLElement) => void;\n/**\n * A helper typically used in the Application panel. Renders a split view\n * between a DataGrid displaying key-value pairs and a preview Widget.\n */\nexport abstract class KeyValueStorageItemsView extends UI.Widget.VBox {\n  #preview: Widget;\n  #previewValue: string|null;\n\n  #items: Array<{key: string, value: string}> = [];\n  #selectedKey: string|null = null;\n  #view: View;\n  #isSortOrderAscending = true;\n  #editable: boolean;\n  #toolbar: StorageItemsToolbar|undefined;\n  readonly metadataView: ApplicationComponents.StorageMetadataView.StorageMetadataView;\n\n  constructor(\n      title: string, id: string, editable: boolean, view?: View,\n      metadataView?: ApplicationComponents.StorageMetadataView.StorageMetadataView) {\n    metadataView ??= new ApplicationComponents.StorageMetadataView.StorageMetadataView();\n    if (!view) {\n      view = (input: ViewInput, output: ViewOutput, target: HTMLElement) => {\n        // clang-format off\n        render(html `\n            <devtools-widget\n              .widgetConfig=${widgetConfig(StorageItemsToolbar, {metadataView})}\n              class=flex-none\n              ${UI.Widget.widgetRef(StorageItemsToolbar, view => {output.toolbar = view;})}\n            ></devtools-widget>\n            <devtools-split-view sidebar-position=\"second\" name=\"${id}-split-view-state\">\n               <devtools-widget\n                  slot=\"main\"\n                  .widgetConfig=${widgetConfig(VBox, {minimumSize: new Size(0, 50)})}>\n                <devtools-data-grid\n                  .name=${`${id}-datagrid-with-preview`}\n                  striped\n                  style=\"flex: auto\"\n                  @select=${input.onSelect}\n                  @sort=${input.onSort}\n                  @refresh=${input.onReferesh}\n                  @create=${input.onCreate}\n                  @edit=${input.onEdit}\n                  @delete=${input.onDelete}\n                >\n                  <table>\n                    <tr>\n                      <th id=\"key\" sortable ?editable=${input.editable}>\n                        ${i18nString(UIStrings.key)}\n                      </th>\n                      <th id=\"value\" ?editable=${input.editable}>\n                        ${i18nString(UIStrings.value)}\n                      </th>\n                    </tr>\n                    ${repeat(input.items, item => item.key, item => html`\n                      <tr data-key=${item.key} data-value=${item.value}\n                          selected=${(input.selectedKey === item.key) || nothing}>\n                        <td>${item.key}</td>\n                        <td>${item.value.substr(0, MAX_VALUE_LENGTH)}</td>\n                      </tr>`)}\n                      <tr placeholder></tr>\n                  </table>\n                </devtools-data-grid>\n              </devtools-widget>\n              <devtools-widget\n                  slot=\"sidebar\"\n                  .widgetConfig=${widgetConfig(VBox, {minimumSize: new Size(0, 50)})}\n                  jslog=${VisualLogging.pane('preview').track({resize: true})}>\n               ${input.preview?.element}\n              </devtools-widget>\n            </devtools-split-view>`,\n            // clang-format on\n            target, {host: input});\n      };\n    }\n    super(false);\n    this.metadataView = metadataView;\n    this.#editable = editable;\n    this.#view = view;\n    this.performUpdate();\n\n    this.#preview =\n        new EmptyWidget(i18nString(UIStrings.noPreviewSelected), i18nString(UIStrings.selectAValueToPreview));\n    this.#previewValue = null;\n\n    this.showPreview(null, null);\n  }\n\n  override wasShown(): void {\n    this.refreshItems();\n  }\n\n  override performUpdate(): void {\n    const that = this;\n    const viewOutput = {\n      set toolbar(toolbar: StorageItemsToolbar) {\n        that.#toolbar?.removeEventListener(StorageItemsToolbar.Events.DELETE_SELECTED, that.deleteSelectedItem, that);\n        that.#toolbar?.removeEventListener(StorageItemsToolbar.Events.DELETE_ALL, that.deleteAllItems, that);\n        that.#toolbar?.removeEventListener(StorageItemsToolbar.Events.REFRESH, that.refreshItems, that);\n        that.#toolbar = toolbar;\n        that.#toolbar.addEventListener(StorageItemsToolbar.Events.DELETE_SELECTED, that.deleteSelectedItem, that);\n        that.#toolbar.addEventListener(StorageItemsToolbar.Events.DELETE_ALL, that.deleteAllItems, that);\n        that.#toolbar.addEventListener(StorageItemsToolbar.Events.REFRESH, that.refreshItems, that);\n      }\n    };\n    const viewInput = {\n      items: this.#items,\n      selectedKey: this.#selectedKey,\n      editable: this.#editable,\n      preview: this.#preview,\n      onSelect: (event: CustomEvent<HTMLElement|null>) => {\n        this.#toolbar?.setCanDeleteSelected(Boolean(event.detail));\n        if (!event.detail) {\n          void this.#previewEntry(null);\n        } else {\n          void this.#previewEntry({key: event.detail.dataset.key || '', value: event.detail.dataset.value || ''});\n        }\n      },\n      onSort: (event: CustomEvent<{columnId: string, ascending: boolean}>) => {\n        this.#isSortOrderAscending = event.detail.ascending;\n      },\n      onCreate: (event: CustomEvent<{key: string, value: string}>) => {\n        this.#createCallback(event.detail.key, event.detail.value || '');\n      },\n      onEdit:\n          (event: CustomEvent<{node: HTMLElement, columnId: string, valueBeforeEditing: string, newText: string}>) => {\n            this.#editingCallback(\n                event.detail.node, event.detail.columnId, event.detail.valueBeforeEditing, event.detail.newText);\n          },\n      onDelete: (event: CustomEvent<HTMLElement>) => {\n        this.#deleteCallback(event.detail.dataset.key || '');\n      },\n      onReferesh: () => {\n        this.refreshItems();\n      },\n    };\n    this.#view(viewInput, viewOutput, this.contentElement);\n  }\n\n  protected get toolbar(): StorageItemsToolbar|undefined {\n    return this.#toolbar;\n  }\n\n  refreshItems(): void {\n  }\n\n  deleteAllItems(): void {\n  }\n\n  itemsCleared(): void {\n    this.#items = [];\n    this.performUpdate();\n    this.#toolbar?.setCanDeleteSelected(false);\n  }\n\n  itemRemoved(key: string): void {\n    const index = this.#items.findIndex(item => item.key === key);\n    if (index === -1) {\n      return;\n    }\n    this.#items.splice(index, 1);\n    this.performUpdate();\n    this.#toolbar?.setCanDeleteSelected(this.#items.length > 1);\n  }\n\n  itemAdded(key: string, value: string): void {\n    if (this.#items.some(item => item.key === key)) {\n      return;\n    }\n    this.#items.push({key, value});\n    this.performUpdate();\n  }\n\n  itemUpdated(key: string, value: string): void {\n    const item = this.#items.find(item => item.key === key);\n    if (!item) {\n      return;\n    }\n    if (item.value === value) {\n      return;\n    }\n    item.value = value;\n    this.performUpdate();\n    if (this.#selectedKey !== key) {\n      return;\n    }\n    if (this.#previewValue !== value) {\n      void this.#previewEntry({key, value});\n    }\n    this.#toolbar?.setCanDeleteSelected(true);\n  }\n\n  showItems(items: Array<{key: string, value: string}>): void {\n    const sortDirection = this.#isSortOrderAscending ? 1 : -1;\n    this.#items = [...items].sort((item1, item2) => sortDirection * (item1.key > item2.key ? 1 : -1));\n    const selectedItem = this.#items.find(item => item.key === this.#selectedKey);\n    if (!selectedItem) {\n      this.#selectedKey = null;\n    } else {\n      void this.#previewEntry(selectedItem);\n    }\n    this.performUpdate();\n    this.#toolbar?.setCanDeleteSelected(Boolean(this.#selectedKey));\n    ARIAUtils.LiveAnnouncer.alert(i18nString(UIStrings.numberEntries, {PH1: this.#items.length}));\n  }\n\n  deleteSelectedItem(): void {\n    if (!this.#selectedKey) {\n      return;\n    }\n\n    this.#deleteCallback(this.#selectedKey);\n  }\n\n  #createCallback(key: string, value: string): void {\n    this.setItem(key, value);\n    this.#removeDupes(key, value);\n    void this.#previewEntry({key, value});\n  }\n\n  protected isEditAllowed(_columnIdentifier: string, _oldText: string, _newText: string): boolean {\n    return true;\n  }\n\n  #editingCallback(editingNode: HTMLElement, columnIdentifier: string, oldText: string, newText: string): void {\n    if (!this.isEditAllowed(columnIdentifier, oldText, newText)) {\n      return;\n    }\n    if (columnIdentifier === 'key') {\n      if (typeof oldText === 'string') {\n        this.removeItem(oldText);\n      }\n      this.setItem(newText, editingNode.dataset.value || '');\n      this.#removeDupes(newText, editingNode.dataset.value || '');\n      editingNode.dataset.key = newText;\n      void this.#previewEntry({key: newText, value: editingNode.dataset.value || ''});\n    } else {\n      this.setItem(editingNode.dataset.key || '', newText);\n      void this.#previewEntry({key: editingNode.dataset.key || '', value: newText});\n    }\n  }\n\n  #removeDupes(key: string, value: string): void {\n    for (let i = this.#items.length - 1; i >= 0; --i) {\n      const child = this.#items[i];\n      if ((child.key === key) && (value !== child.value)) {\n        this.#items.splice(i, 1);\n      }\n    }\n  }\n\n  #deleteCallback(key: string): void {\n    this.removeItem(key);\n  }\n\n  showPreview(preview: Widget|null, value: string|null): void {\n    if (this.#preview && this.#previewValue === value) {\n      return;\n    }\n    if (this.#preview) {\n      this.#preview.detach();\n    }\n    if (!preview) {\n      preview = new EmptyWidget(i18nString(UIStrings.noPreviewSelected), i18nString(UIStrings.selectAValueToPreview));\n    }\n    this.#previewValue = value;\n    this.#preview = preview;\n    this.performUpdate();\n  }\n\n  async #previewEntry(entry: {key: string, value: string}|null): Promise<void> {\n    if (entry?.value) {\n      this.#selectedKey = entry.key;\n      const preview = await this.createPreview(entry.key, entry.value);\n      // Selection could've changed while the preview was loaded\n      if (this.#selectedKey === entry.key) {\n        this.showPreview(preview, entry.value);\n      }\n    } else {\n      this.#selectedKey = null;\n      this.showPreview(null, null);\n    }\n  }\n\n  set editable(editable: boolean) {\n    this.#editable = editable;\n    this.performUpdate();\n  }\n\n  protected keys(): string[] {\n    return this.#items.map(item => item.key);\n  }\n\n  protected abstract setItem(key: string, value: string): void;\n  protected abstract removeItem(key: string): void;\n  protected abstract createPreview(key: string, value: string): Promise<Widget|null>;\n}\n"]}