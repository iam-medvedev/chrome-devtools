{"version":3,"file":"PreloadingDetailsReportView.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/panels/application/preloading/components/PreloadingDetailsReportView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as SDK from '../../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../../generated/protocol.js';\nimport {describeWithEnvironment} from '../../../../testing/EnvironmentHelpers.js';\nimport {createViewFunctionStub} from '../../../../testing/ViewFunctionHelpers.js';\n\nimport * as PreloadingComponents from './components.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribeWithEnvironment('PreloadingDetailsReportView', () => {\n  it('renders place holder if not selected', async () => {\n    const data = null;\n\n    const view = createViewFunctionStub(PreloadingComponents.PreloadingDetailsReportView.PreloadingDetailsReportView);\n    const detailsReportView = new PreloadingComponents.PreloadingDetailsReportView.PreloadingDetailsReportView(view);\n    detailsReportView.data = data;\n    const input = await view.nextInput;\n    assert.deepEqual(input.data, data);\n    assert.isFunction(input.onRevealRuleSet);\n  });\n\n  it('renders prerendering details', async () => {\n    const url = urlString`https://example.com/prerendered.html`;\n    const data: PreloadingComponents.PreloadingDetailsReportView.PreloadingDetailsReportViewData = {\n      pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([\n        {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId: 'loaderId' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url,\n            targetHint: undefined,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.SUCCESS,\n          prefetchStatus: Protocol.Preload.PrefetchStatus.PrefetchResponseUsed,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n        {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId: 'loaderId' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url,\n            targetHint: undefined,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      ]),\n      ruleSets: [\n        {\n          id: 'ruleSetId' as Protocol.Preload.RuleSetId,\n          loaderId: 'loaderId' as Protocol.Network.LoaderId,\n          sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource.js\"]\n    }\n  ]\n}\n`,\n        },\n      ],\n      pageURL: urlString`https://example.com/`,\n    };\n\n    const view = createViewFunctionStub(PreloadingComponents.PreloadingDetailsReportView.PreloadingDetailsReportView);\n    const detailsReportView = new PreloadingComponents.PreloadingDetailsReportView.PreloadingDetailsReportView(view);\n    detailsReportView.data = data;\n    const input = await view.nextInput;\n    assert.deepEqual(input.data, data);\n    assert.isFunction(input.onRevealRuleSet);\n  });\n});\n"]}