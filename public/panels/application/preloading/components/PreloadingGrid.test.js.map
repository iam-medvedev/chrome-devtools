{"version":3,"file":"PreloadingGrid.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/panels/application/preloading/components/PreloadingGrid.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,QAAQ,MAAM,uCAAuC,CAAC;AAClE,OAAO,KAAK,GAAG,MAAM,6BAA6B,CAAC;AAEnD,OAAO,EAAC,uBAAuB,EAAC,MAAM,2CAA2C,CAAC;AAClF,OAAO,EAAC,sBAAsB,EAAwB,MAAM,4CAA4C,CAAC;AAEzG,OAAO,KAAK,oBAAoB,MAAM,iBAAiB,CAAC;AAExD,MAAM,EAAC,SAAS,EAAC,GAAG,QAAQ,CAAC,YAAY,CAAC;AAE1C,KAAK,UAAU,WAAW;IAIxB,MAAM,IAAI,GAAG,sBAAsB,CAAC,oBAAoB,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC;IACxF,MAAM,MAAM,GAAG,IAAI,oBAAoB,CAAC,cAAc,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;IAC5E,MAAM,IAAI,CAAC,SAAS,CAAC;IACrB,OAAO,EAAC,MAAM,EAAE,IAAI,EAAC,CAAC;AACxB,CAAC;AAED,KAAK,UAAU,kBAAkB,CAAC,SAGjC;IACC,MAAM,EAAC,MAAM,EAAE,IAAI,EAAC,GAAG,MAAM,WAAW,EAAE,CAAC;IAC3C,MAAM,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC;IAC7B,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC,OAAO,CAAC;IACnC,MAAM,IAAI,CAAC,SAAS,CAAC;IAErB,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACpD,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;AAC5D,CAAC;AAED,uBAAuB,CAAC,gBAAgB,EAAE,GAAG,EAAE;IAC7C,EAAE,CAAC,cAAc,EAAE,KAAK,IAAI,EAAE;QAC5B,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,qCAAqC;6BACpD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;yBACU;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;QACpD,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,qCAAqC;6BACpD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE,CAAC;4BACT,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,GAAG,EAAE,MAAM;4BACX,UAAU,EAAE;;;;;;;;;;CAUrB;yBACQ,CAAC;iBACH,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;QAC1D,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,kDAAkD;6BACjE;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;yBACU;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;QACpE,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,qCAAqC;6BACpD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,EAAkC;yBAC5C,CAAC,CAAC;oBACH,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;4BACW,GAAG,EAAE,mDAAmD;yBACzD;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;QACtD,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE;gBACJ;oBACE,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,2CAA2C;6BAC1D;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE,EAAE;iBACb;gBACD;oBACE,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,6CAA6C;6BAC5D;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,EAAE,IAAI;4BACpB,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,EAAE,eAAe,CAAiC;4BAC9E,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASzB;yBACY;wBACD;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASzB;4BACa,GAAG,EAAE,mDAAmD;yBACzD;qBACF;iBACF;aACF;YACD,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;QACjD,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;4BACvE,MAAM,gEAA8C;4BACpD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,gEAA8C;gCACpD,GAAG,EAAE,SAAS,CAAA,sCAAsC;6BACrD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,eAAe,iFAAwD;4BACvE,uBAAuB,EAAE,6BAA6B;4BACtD,iBAAiB,EAAE,IAAI;4BACvB,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C,CAAC,CAAC;oBACH,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;yBACU;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;QACpE,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC;wBACtE;4BACE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,sCAAsC;6BACrD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,mFAAsD;4BACpE,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C;wBACD;4BACE,MAAM,gEAA8C;4BACpD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,gEAA8C;gCACpD,GAAG,EAAE,SAAS,CAAA,sCAAsC;6BACrD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,eAAe,iFAAwD;4BACvE,uBAAuB,EAAE,6BAA6B;4BACtD,iBAAiB,EAAE,IAAI;4BACvB,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C;qBACyC,CAAC;oBAC7C,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;yBACU;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qDAAqD,EAAE,KAAK,IAAI,EAAE;QACnE,MAAM,kBAAkB,CAAC;YACvB,IAAI,EAAE,CAAC;oBACL,EAAE,EAAE,IAAI;oBACR,QAAQ,EAAE,GAAG,CAAC,eAAe,CAAC,eAAe,CAAC,yBAAyB,CAAC;wBACtE;4BACE,MAAM,8DAA6C;4BACnD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,8DAA6C;gCACnD,GAAG,EAAE,SAAS,CAAA,sCAAsC;6BACrD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,cAAc,mFAAsD;4BACpE,SAAS,EAAE,aAA2C;4BACtD,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C;wBACD;4BACE,MAAM,gEAA8C;4BACpD,GAAG,EAAE;gCACH,QAAQ,EAAE,YAAyC;gCACnD,MAAM,gEAA8C;gCACpD,GAAG,EAAE,SAAS,CAAA,sCAAsC;6BACrD;4BACD,UAAU,EAAE,cAAoD;4BAChE,MAAM,8DAA8C;4BACpD,eAAe,2GAAqE;4BACpF,uBAAuB,EAAE,IAAI;4BAC7B,iBAAiB,EAAE,IAAI;4BACvB,UAAU,EAAE,CAAC,eAAe,CAAiC;4BAC7D,OAAO,EAAE,CAAC,CAAC,CAAiC;yBAC7C;qBACyC,CAAC;oBAC7C,QAAQ,EAAE;wBACR;4BACE,EAAE,EAAE,eAA6C;4BACjD,QAAQ,EAAE,YAAyC;4BACnD,UAAU,EAAE;;;;;;;;;CASvB;yBACU;qBACF;iBACF,CAAC;YACF,OAAO,EAAE,SAAS,CAAA,sBAAsB;SACzC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2022 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as SDK from '../../../../core/sdk/sdk.js';\nimport * as Protocol from '../../../../generated/protocol.js';\nimport {describeWithEnvironment} from '../../../../testing/EnvironmentHelpers.js';\nimport {createViewFunctionStub, type ViewFunctionStub} from '../../../../testing/ViewFunctionHelpers.js';\n\nimport * as PreloadingComponents from './components.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\nasync function setupWidget(): Promise<{\n  widget: PreloadingComponents.PreloadingGrid.PreloadingGrid,\n  view: ViewFunctionStub<typeof PreloadingComponents.PreloadingGrid.PreloadingGrid>,\n}> {\n  const view = createViewFunctionStub(PreloadingComponents.PreloadingGrid.PreloadingGrid);\n  const widget = new PreloadingComponents.PreloadingGrid.PreloadingGrid(view);\n  await view.nextInput;\n  return {widget, view};\n}\n\nasync function assertRenderResult(rowsInput: {\n  rows: PreloadingComponents.PreloadingGrid.PreloadingGridRow[],\n  pageURL: Platform.DevToolsPath.UrlString,\n}): Promise<void> {\n  const {widget, view} = await setupWidget();\n  widget.rows = rowsInput.rows;\n  widget.pageURL = rowsInput.pageURL;\n  await view.nextInput;\n\n  assert.strictEqual(rowsInput.rows, view.input.rows);\n  assert.strictEqual(rowsInput.pageURL, view.input.pageURL);\n}\n\ndescribeWithEnvironment('PreloadingGrid', () => {\n  it('renders grid', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/prefetched.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        }]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prefetched.html\"]\n    }\n  ]\n}\n`,\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('renders tag instead of url correctly', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/prefetched.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        }]),\n        ruleSets: [{\n          id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n          loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n          tag: 'tag1',\n          sourceText: `\n{\n  \"tag\": \"tag1\",\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prefetched.html\"]\n    }\n  ]\n}\n`,\n        }],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows full URL for cross-origin preloading', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://cross-origin.example.com/prefetched.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        }]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"https://cross-origin.example.com/prefetched.html\"]\n    }\n  ]\n}\n`,\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows filename for out-of-document speculation rules', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/prefetched.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [] as Protocol.DOM.BackendNodeId[],\n        }]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prefetched.html\"]\n    }\n  ]\n}\n`,\n            url: 'https://example.com/assets/speculation-rules.json',\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows the only first speculation rules', async () => {\n    await assertRenderResult({\n      rows: [\n        {\n          id: 'id',\n          pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prefetch,\n              url: urlString`https://example.com/rule-set-missing.html`,\n            },\n            pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n            prefetchStatus: null,\n            requestId: 'requestId:1' as Protocol.Network.RequestId,\n            ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          }]),\n          ruleSets: [],\n        },\n        {\n          id: 'id',\n          pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prefetch,\n              url: urlString`https://example.com/multiple-rule-sets.html`,\n            },\n            pipelineId: 'pipelineId:2' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n            prefetchStatus: null,\n            requestId: 'requestId:2' as Protocol.Network.RequestId,\n            ruleSetIds: ['ruleSetId:0.2', 'ruleSetId:0.3'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          }]),\n          ruleSets: [\n            {\n              id: 'ruleSetId:0.2' as Protocol.Preload.RuleSetId,\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/multiple-rule-sets.html\"]\n    }\n  ]\n}\n`,\n            },\n            {\n              id: 'ruleSetId:0.3' as Protocol.Preload.RuleSetId,\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/multiple-rule-sets.html\"]\n    }\n  ]\n}\n`,\n              url: 'https://example.com/assets/speculation-rules.json',\n            },\n          ],\n        },\n      ],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows composed status for failure', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([{\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n          prerenderStatus: Protocol.Preload.PrerenderFinalStatus.MojoBinderPolicy,\n          disallowedMojoInterface: 'device.mojom.GamepadMonitor',\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        }]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prerendered.html\"]\n    }\n  ]\n}\n`,\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows a warning if a prerender fallbacks to prefetch', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([\n          {\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prefetch,\n              url: urlString`https://example.com/prerendered.html`,\n            },\n            pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.SUCCESS,\n            prefetchStatus: Protocol.Preload.PrefetchStatus.PrefetchResponseUsed,\n            requestId: 'requestId:1' as Protocol.Network.RequestId,\n            ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          },\n          {\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prerender,\n              url: urlString`https://example.com/prerendered.html`,\n            },\n            pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n            prerenderStatus: Protocol.Preload.PrerenderFinalStatus.MojoBinderPolicy,\n            disallowedMojoInterface: 'device.mojom.GamepadMonitor',\n            mismatchedHeaders: null,\n            ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          },\n        ] as SDK.PreloadingModel.PreloadingAttempt[]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prerendered.html\"]\n    }\n  ]\n}\n`,\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n\n  it('shows failure if both prefetch and prerender failed', async () => {\n    await assertRenderResult({\n      rows: [{\n        id: 'id',\n        pipeline: SDK.PreloadingModel.PreloadPipeline.newFromAttemptsForTesting([\n          {\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prefetch,\n              url: urlString`https://example.com/prerendered.html`,\n            },\n            pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n            prefetchStatus: Protocol.Preload.PrefetchStatus.PrefetchFailedNon2XX,\n            requestId: 'requestId:1' as Protocol.Network.RequestId,\n            ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          },\n          {\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            key: {\n              loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n              action: Protocol.Preload.SpeculationAction.Prerender,\n              url: urlString`https://example.com/prerendered.html`,\n            },\n            pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n            status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n            prerenderStatus: Protocol.Preload.PrerenderFinalStatus.PrerenderFailedDuringPrefetch,\n            disallowedMojoInterface: null,\n            mismatchedHeaders: null,\n            ruleSetIds: ['ruleSetId:0.1'] as Protocol.Preload.RuleSetId[],\n            nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n          },\n        ] as SDK.PreloadingModel.PreloadingAttempt[]),\n        ruleSets: [\n          {\n            id: 'ruleSetId:0.1' as Protocol.Preload.RuleSetId,\n            loaderId: 'loaderId:1' as Protocol.Network.LoaderId,\n            sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prerendered.html\"]\n    }\n  ]\n}\n`,\n          },\n        ],\n      }],\n      pageURL: urlString`https://example.com/`,\n    });\n  });\n});\n"]}