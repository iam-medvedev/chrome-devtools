{"version":3,"file":"AnimationTimeline.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/animation/AnimationTimeline.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport {renderElementIntoDOM} from '../../testing/DOMHelpers.js';\nimport {\n  createTarget,\n  stubNoopSettings,\n} from '../../testing/EnvironmentHelpers.js';\nimport {expectCall} from '../../testing/ExpectStubCall.js';\nimport {describeWithMockConnection} from '../../testing/MockConnection.js';\nimport * as Elements from '../elements/elements.js';\n\nimport * as Animation from './animation.js';\n\nconst TIME_ANIMATION_PAYLOAD = {\n  id: 'animation-id',\n  name: 'animation-name',\n  pausedState: false,\n  playState: 'running',\n  playbackRate: 1,\n  startTime: 42,\n  currentTime: 0,\n  type: Protocol.Animation.AnimationType.CSSAnimation,\n  source: {\n    delay: 0,\n    endDelay: 0,\n    duration: 10000,\n    backendNodeId: 42 as Protocol.DOM.BackendNodeId,\n  } as Protocol.Animation.AnimationEffect,\n};\n\nconst SDA_ANIMATION_PAYLOAD = {\n  id: 'animation-id',\n  name: 'animation-name',\n  pausedState: false,\n  playState: 'running',\n  playbackRate: 1,\n  startTime: 42,\n  currentTime: 0,\n  type: Protocol.Animation.AnimationType.CSSAnimation,\n  source: {\n    delay: 0,\n    endDelay: 0,\n    duration: 10000,\n    backendNodeId: 42 as Protocol.DOM.BackendNodeId,\n  } as Protocol.Animation.AnimationEffect,\n  viewOrScrollTimeline: {\n    axis: Protocol.DOM.ScrollOrientation.Vertical,\n    sourceNodeId: 42 as Protocol.DOM.BackendNodeId,\n    startOffset: 42,\n    endOffset: 142,\n  },\n};\n\ninterface AnimationDOMNodeStubs {\n  verticalScrollRange: sinon.SinonStub;\n  horizontalScrollRange: sinon.SinonStub;\n  scrollLeft: sinon.SinonStub;\n  scrollTop: sinon.SinonStub;\n  addScrollEventListener: sinon.SinonStub;\n  removeScrollEventListener: sinon.SinonStub;\n}\nclass ManualPromise {\n  #waitPromise: Promise<void>;\n  #resolveFn: () => void;\n  constructor() {\n    const {resolve, promise} = Promise.withResolvers<void>();\n\n    this.#waitPromise = promise;\n    this.#resolveFn = resolve;\n  }\n\n  resolve() {\n    this.#resolveFn();\n    const {resolve, promise} = Promise.withResolvers<void>();\n\n    this.#waitPromise = promise;\n    this.#resolveFn = resolve;\n  }\n\n  wait() {\n    return this.#waitPromise;\n  }\n}\n\nconst cancelAllPendingRaf = () => {\n  let rafId = window.requestAnimationFrame(() => {});\n  while (rafId--) {\n    window.cancelAnimationFrame(rafId);\n  }\n};\n\nconst stubAnimationGroup = () => {\n  sinon.stub(SDK.AnimationModel.AnimationGroup.prototype, 'scrollNode')\n      .resolves(new SDK.AnimationModel.AnimationDOMNode(null as unknown as SDK.DOMModel.DOMNode));\n};\n\nconst stubAnimationDOMNode = (): AnimationDOMNodeStubs => {\n  const verticalScrollRange =\n      sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'verticalScrollRange').resolves(100);\n  const horizontalScrollRange =\n      sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'horizontalScrollRange').resolves(100);\n  const scrollLeft = sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'scrollLeft').resolves(10);\n  const scrollTop = sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'scrollTop').resolves(10);\n  const addScrollEventListener =\n      sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'addScrollEventListener').resolves();\n  const removeScrollEventListener =\n      sinon.stub(SDK.AnimationModel.AnimationDOMNode.prototype, 'removeScrollEventListener').resolves();\n  return {\n    verticalScrollRange,\n    horizontalScrollRange,\n    scrollLeft,\n    scrollTop,\n    addScrollEventListener,\n    removeScrollEventListener,\n  };\n};\n\nconst waitFor = async(selector: string, root?: Element|ShadowRoot): Promise<Element|null> => {\n  let element = null;\n  while (!element) {\n    element = root ? root.querySelector(selector) : document.querySelector(selector);\n    await new Promise(resolve => setTimeout(resolve, 10));\n  }\n  return element;\n};\n\nconst waitForAll = async(selector: string, root?: Element|ShadowRoot): Promise<NodeListOf<Element>|null> => {\n  let elements = root ? root.querySelectorAll(selector) : document.querySelectorAll(selector);\n  let tryCount = 0;\n  while (!elements || tryCount < 50) {\n    await new Promise(resolve => setTimeout(resolve, 10));\n    elements = root ? root.querySelectorAll(selector) : document.querySelectorAll(selector);\n    tryCount++;\n  }\n  return elements || null;\n};\n\ndescribeWithMockConnection('AnimationTimeline', () => {\n  let target: SDK.Target.Target;\n  let view: Animation.AnimationTimeline.AnimationTimeline;\n\n  beforeEach(() => {\n    Common.Linkifier.registerLinkifier({\n      contextTypes() {\n        return [SDK.DOMModel.DOMNode];\n      },\n      async loadLinkifier() {\n        return Elements.DOMLinkifier.Linkifier.instance();\n      },\n    });\n\n    stubNoopSettings();\n    target = createTarget();\n\n    const runtimeAgent = target.model(SDK.RuntimeModel.RuntimeModel)?.agent!;\n\n    const stub = sinon.stub(runtimeAgent, 'invoke_evaluate');\n    stub.callsFake(params => {\n      if (params.expression === 'window.devicePixelRatio') {\n        return Promise.resolve({\n          result: {\n            type: 'number' as Protocol.Runtime.RemoteObjectType,\n            value: 1,\n          },\n          getError: () => undefined,\n        });\n      }\n\n      return stub.wrappedMethod(params);\n    });\n  });\n\n  afterEach(() => {\n    cancelAllPendingRaf();\n    view.detach();\n  });\n\n  const updatesUiOnEvent = (inScope: boolean) => async () => {\n    SDK.TargetManager.TargetManager.instance().setScopeTarget(inScope ? target : null);\n    const model = target.model(SDK.AnimationModel.AnimationModel);\n    assert.exists(model);\n\n    view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n    view.markAsRoot();\n    renderElementIntoDOM(view);\n    await new Promise<void>(resolve => setTimeout(resolve, 0));\n\n    const previewContainer = (view.contentElement.querySelector('.animation-timeline-buffer') as HTMLElement);\n\n    await model.animationStarted({\n      id: 'id',\n      name: 'name',\n      pausedState: false,\n      playState: 'playState',\n      playbackRate: 1,\n      startTime: 42,\n      currentTime: 43,\n      type: Protocol.Animation.AnimationType.CSSAnimation,\n      source: {\n        delay: 0,\n        duration: 1001,\n        backendNodeId: 42 as Protocol.DOM.BackendNodeId,\n      } as Protocol.Animation.AnimationEffect,\n    });\n\n    if (inScope) {\n      await expectCall(sinon.stub(view, 'previewsCreatedForTest'));\n    }\n    const preview = await waitForAll('.animation-buffer-preview', previewContainer) as NodeListOf<HTMLElement>;\n    assert.strictEqual(preview.length || 0, inScope ? 1 : 0);\n  };\n\n  it('updates UI on in scope animation group start', updatesUiOnEvent(true));\n  it('does not update UI on out of scope animation group start', updatesUiOnEvent(false));\n\n  describe('resizing time controls', () => {\n    it('updates --timeline-controls-width and calls onResize', async () => {\n      view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n      view.markAsRoot();\n      renderElementIntoDOM(view);\n      const onResizeStub = sinon.stub(view, 'onResize');\n      await new Promise<void>(resolve => setTimeout(resolve, 0));\n\n      const resizer = view.contentElement.querySelector('.timeline-controls-resizer');\n      assert.exists(resizer);\n\n      const initialWidth = view.element.style.getPropertyValue('--timeline-controls-width');\n      assert.strictEqual(initialWidth, '150px');\n\n      const resizerRect = resizer.getBoundingClientRect();\n      resizer.dispatchEvent(\n          new PointerEvent('pointerdown', {\n            clientX: resizerRect.x + resizerRect.width / 2,\n            clientY: resizerRect.y + resizerRect.height / 2,\n          }),\n      );\n      resizer.ownerDocument.dispatchEvent(\n          new PointerEvent('pointermove', {\n            buttons: 1,\n            clientX: (resizerRect.x + resizerRect.width / 2) + 20,\n            clientY: resizerRect.y + resizerRect.height / 2,\n          }),\n      );\n      resizer.ownerDocument.dispatchEvent(new PointerEvent('pointerup'));\n\n      const afterResizeWidth = view.element.style.getPropertyValue('--timeline-controls-width');\n      assert.notStrictEqual(initialWidth, afterResizeWidth);\n      sinon.assert.calledOnce(onResizeStub);\n    });\n  });\n\n  describe('Animation group nodes are removed', () => {\n    const waitForPreviewsManualPromise = new ManualPromise();\n    const waitForAnimationGroupSelectedPromise = new ManualPromise();\n\n    let domModel: SDK.DOMModel.DOMModel;\n    let animationModel: SDK.AnimationModel.AnimationModel;\n    let contentDocument: SDK.DOMModel.DOMDocument;\n    beforeEach(async () => {\n      view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n      view.markAsRoot();\n      renderElementIntoDOM(view);\n\n      sinon.stub(view, 'animationGroupSelectedForTest').callsFake(() => {\n        waitForAnimationGroupSelectedPromise.resolve();\n      });\n      sinon.stub(view, 'previewsCreatedForTest').callsFake(() => {\n        waitForPreviewsManualPromise.resolve();\n      });\n\n      const model = target.model(SDK.AnimationModel.AnimationModel);\n      assert.exists(model);\n      animationModel = model;\n\n      const modelForDom = target.model(SDK.DOMModel.DOMModel);\n      assert.exists(modelForDom);\n      domModel = modelForDom;\n\n      contentDocument = SDK.DOMModel.DOMDocument.create(domModel, null, false, {\n        nodeId: 0 as Protocol.DOM.NodeId,\n        backendNodeId: 0 as Protocol.DOM.BackendNodeId,\n        nodeType: Node.DOCUMENT_NODE,\n        nodeName: '#document',\n        localName: 'document',\n        nodeValue: '',\n      }) as SDK.DOMModel.DOMDocument;\n\n      void animationModel.animationStarted(TIME_ANIMATION_PAYLOAD);\n\n      await waitForPreviewsManualPromise.wait();\n    });\n\n    describe('when the animation group is already selected', () => {\n      it('should hide scrubber, disable control button and make current time empty', async () => {\n        const domNode = SDK.DOMModel.DOMNode.create(domModel, contentDocument, false, {\n          nodeId: 1 as Protocol.DOM.NodeId,\n          backendNodeId: 1 as Protocol.DOM.BackendNodeId,\n          nodeType: Node.ELEMENT_NODE,\n          nodeName: 'div',\n          localName: 'div',\n          nodeValue: '',\n        });\n        sinon.stub(SDK.DOMModel.DeferredDOMNode.prototype, 'resolvePromise').resolves(domNode);\n\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        const gridHeader = view.element.shadowRoot!.querySelector('.animation-grid-header');\n        assert.exists(gridHeader);\n        assert.isTrue(gridHeader.classList.contains('scrubber-enabled'));\n\n        const scrubber = view.element.shadowRoot!.querySelector('.animation-scrubber');\n        assert.exists(scrubber);\n        assert.isFalse(scrubber.classList.contains('hidden'));\n\n        const controlButton =\n            view.element.shadowRoot!.querySelector('.animation-controls-toolbar')?.querySelector('.toolbar-button') as\n            HTMLButtonElement;\n        assert.exists(controlButton);\n        assert.isFalse(controlButton.disabled);\n\n        const currentTime = view.element.shadowRoot!.querySelector('.animation-timeline-current-time');\n        assert.exists(currentTime);\n\n        domModel.dispatchEventToListeners(SDK.DOMModel.Events.NodeRemoved, {node: domNode, parent: contentDocument});\n        assert.isFalse(gridHeader.classList.contains('scrubber-enabled'));\n        assert.isTrue(scrubber.classList.contains('hidden'));\n        assert.isTrue(controlButton.disabled);\n        assert.strictEqual(currentTime.textContent, '');\n      });\n\n      it('should mark the animation node as removed in the NodeUI', async () => {\n        const domNode = SDK.DOMModel.DOMNode.create(domModel, contentDocument, false, {\n          nodeId: 1 as Protocol.DOM.NodeId,\n          backendNodeId: 1 as Protocol.DOM.BackendNodeId,\n          nodeType: Node.ELEMENT_NODE,\n          nodeName: 'div',\n          localName: 'div',\n          nodeValue: '',\n        });\n        sinon.stub(SDK.DOMModel.DeferredDOMNode.prototype, 'resolvePromise').resolves(domNode);\n\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        // Wait for the animation group to be fully selected and scrubber enabled.\n        const gridHeader = view.element.shadowRoot!.querySelector('.animation-grid-header');\n        assert.exists(gridHeader);\n        assert.isTrue(gridHeader.classList.contains('scrubber-enabled'));\n\n        const animationNodeRow = view.element.shadowRoot!.querySelector('.animation-node-row') as HTMLElement;\n        assert.exists(animationNodeRow);\n        assert.isFalse(animationNodeRow.classList.contains('animation-node-removed'));\n\n        domModel.dispatchEventToListeners(SDK.DOMModel.Events.NodeRemoved, {node: domNode, parent: contentDocument});\n        assert.isTrue(animationNodeRow.classList.contains('animation-node-removed'));\n      });\n    });\n\n    describe('when the animation group is not selected and the nodes are removed', () => {\n      it('should scrubber be hidden, control button be disabled and current time be empty', async () => {\n        // Owner document is null for the resolved deferred nodes that are already removed from the DOM.\n        const domNode = SDK.DOMModel.DOMNode.create(domModel, null, false, {\n          nodeId: 1 as Protocol.DOM.NodeId,\n          backendNodeId: 1 as Protocol.DOM.BackendNodeId,\n          nodeType: Node.ELEMENT_NODE,\n          nodeName: 'div',\n          localName: 'div',\n          nodeValue: '',\n        });\n        sinon.stub(SDK.DOMModel.DeferredDOMNode.prototype, 'resolvePromise').resolves(domNode);\n\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        const gridHeader = view.element.shadowRoot!.querySelector('.animation-grid-header');\n        assert.exists(gridHeader);\n        assert.isFalse(gridHeader.classList.contains('scrubber-enabled'));\n\n        const scrubber = view.element.shadowRoot!.querySelector('.animation-scrubber');\n        assert.exists(scrubber);\n        assert.isTrue(scrubber.classList.contains('hidden'));\n\n        const controlButton =\n            view.element.shadowRoot!.querySelector('.animation-controls-toolbar')?.querySelector('.toolbar-button') as\n            HTMLButtonElement;\n        assert.exists(controlButton);\n        assert.isTrue(controlButton.disabled);\n\n        const currentTime = view.element.shadowRoot!.querySelector('.animation-timeline-current-time');\n        assert.exists(currentTime);\n        assert.strictEqual(currentTime.textContent, '');\n      });\n    });\n  });\n\n  describe('time animations', () => {\n    const waitForPreviewsManualPromise = new ManualPromise();\n    const waitForAnimationGroupSelectedPromise = new ManualPromise();\n    const waitForScheduleRedrawAfterAnimationGroupUpdated = new ManualPromise();\n    const waitForScrubberOnFinish = new ManualPromise();\n\n    let domModel: SDK.DOMModel.DOMModel;\n    let animationModel: SDK.AnimationModel.AnimationModel;\n    let contentDocument: SDK.DOMModel.DOMDocument;\n    beforeEach(async () => {\n      view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n      view.markAsRoot();\n      renderElementIntoDOM(view);\n\n      sinon.stub(view, 'animationGroupSelectedForTest').callsFake(() => {\n        waitForAnimationGroupSelectedPromise.resolve();\n      });\n      sinon.stub(view, 'previewsCreatedForTest').callsFake(() => {\n        waitForPreviewsManualPromise.resolve();\n      });\n      sinon.stub(view, 'scheduledRedrawAfterAnimationGroupUpdatedForTest').callsFake(() => {\n        waitForScheduleRedrawAfterAnimationGroupUpdated.resolve();\n      });\n\n      sinon.stub(view, 'scrubberOnFinishForTest').callsFake(() => {\n        waitForScrubberOnFinish.resolve();\n      });\n\n      const model = target.model(SDK.AnimationModel.AnimationModel);\n      assert.isNotNull(model);\n      animationModel = model;\n\n      const modelForDom = target.model(SDK.DOMModel.DOMModel);\n      assert.isNotNull(modelForDom);\n      domModel = modelForDom;\n\n      contentDocument = SDK.DOMModel.DOMDocument.create(domModel, null, false, {\n        nodeId: 0 as Protocol.DOM.NodeId,\n        backendNodeId: 0 as Protocol.DOM.BackendNodeId,\n        nodeType: Node.DOCUMENT_NODE,\n        nodeName: '#document',\n        localName: 'document',\n        nodeValue: '',\n      }) as SDK.DOMModel.DOMDocument;\n\n      const domNode = SDK.DOMModel.DOMNode.create(domModel, contentDocument, false, {\n        nodeId: 1 as Protocol.DOM.NodeId,\n        backendNodeId: 1 as Protocol.DOM.BackendNodeId,\n        nodeType: Node.ELEMENT_NODE,\n        nodeName: 'div',\n        localName: 'div',\n        nodeValue: '',\n      });\n      sinon.stub(SDK.DOMModel.DeferredDOMNode.prototype, 'resolvePromise').resolves(domNode);\n\n      void animationModel.animationStarted(TIME_ANIMATION_PAYLOAD);\n\n      await waitForPreviewsManualPromise.wait();\n    });\n\n    describe('animationGroupUpdated', () => {\n      it('should update duration on animationGroupUpdated', async () => {\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        assert.isNotNull(preview);\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        void animationModel.animationUpdated({\n          ...TIME_ANIMATION_PAYLOAD,\n          source: {\n            ...TIME_ANIMATION_PAYLOAD.source,\n            iterations: 3,\n            duration: 10,\n          },\n        });\n\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n        // 3 (iterations) * 10 (iteration duration)\n        assert.strictEqual(view.duration(), 30);\n        await waitForScrubberOnFinish.wait();\n      });\n\n      it('should schedule re-draw on animationGroupUpdated', async () => {\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        assert.isNotNull(preview);\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        void animationModel.animationUpdated(TIME_ANIMATION_PAYLOAD);\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n        await waitForScrubberOnFinish.wait();\n      });\n    });\n  });\n\n  describe('scroll driven animations', () => {\n    let stubbedAnimationDOMNode: AnimationDOMNodeStubs;\n    const waitForPreviewsManualPromise = new ManualPromise();\n    const waitForAnimationGroupSelectedPromise = new ManualPromise();\n    const waitForScheduleRedrawAfterAnimationGroupUpdated = new ManualPromise();\n\n    let domModel: SDK.DOMModel.DOMModel;\n    let animationModel: SDK.AnimationModel.AnimationModel;\n    let contentDocument: SDK.DOMModel.DOMDocument;\n    beforeEach(async () => {\n      stubbedAnimationDOMNode = stubAnimationDOMNode();\n      stubAnimationGroup();\n\n      view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n      view.markAsRoot();\n      renderElementIntoDOM(view);\n\n      sinon.stub(view, 'animationGroupSelectedForTest').callsFake(() => {\n        waitForAnimationGroupSelectedPromise.resolve();\n      });\n      sinon.stub(view, 'previewsCreatedForTest').callsFake(() => {\n        waitForPreviewsManualPromise.resolve();\n      });\n      sinon.stub(view, 'scheduledRedrawAfterAnimationGroupUpdatedForTest').callsFake(() => {\n        waitForScheduleRedrawAfterAnimationGroupUpdated.resolve();\n      });\n\n      const model = target.model(SDK.AnimationModel.AnimationModel);\n      assert.exists(model);\n      animationModel = model;\n\n      const modelForDom = target.model(SDK.DOMModel.DOMModel);\n      assert.exists(modelForDom);\n      domModel = modelForDom;\n\n      contentDocument = SDK.DOMModel.DOMDocument.create(domModel, null, false, {\n        nodeId: 0 as Protocol.DOM.NodeId,\n        backendNodeId: 0 as Protocol.DOM.BackendNodeId,\n        nodeType: Node.DOCUMENT_NODE,\n        nodeName: '#document',\n        localName: 'document',\n        nodeValue: '',\n      }) as SDK.DOMModel.DOMDocument;\n\n      const domNode = SDK.DOMModel.DOMNode.create(domModel, contentDocument, false, {\n        nodeId: 1 as Protocol.DOM.NodeId,\n        backendNodeId: 1 as Protocol.DOM.BackendNodeId,\n        nodeType: Node.ELEMENT_NODE,\n        nodeName: 'div',\n        localName: 'div',\n        nodeValue: '',\n      });\n      sinon.stub(SDK.DOMModel.DeferredDOMNode.prototype, 'resolvePromise').resolves(domNode);\n\n      void animationModel.animationStarted({\n        id: 'animation-id',\n        name: 'animation-name',\n        pausedState: false,\n        playState: 'running',\n        playbackRate: 1,\n        startTime: 42,\n        currentTime: 0,\n        type: Protocol.Animation.AnimationType.CSSAnimation,\n        source: {\n          delay: 0,\n          endDelay: 0,\n          duration: 10000,\n          backendNodeId: 42 as Protocol.DOM.BackendNodeId,\n        } as Protocol.Animation.AnimationEffect,\n        viewOrScrollTimeline: {\n          axis: Protocol.DOM.ScrollOrientation.Vertical,\n          sourceNodeId: 42 as Protocol.DOM.BackendNodeId,\n          startOffset: 42,\n          endOffset: 142,\n        },\n      });\n\n      await waitForPreviewsManualPromise.wait();\n    });\n\n    it('should disable global controls after a scroll driven animation is selected', async () => {\n      const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n      preview.click();\n      await waitForAnimationGroupSelectedPromise.wait();\n\n      const playbackRateButtons = [...view.element.shadowRoot!.querySelectorAll('.animation-playback-rate-button')];\n      assert.isTrue(\n          playbackRateButtons.every(button => button.getAttribute('disabled')),\n          'All the playback rate buttons are disabled');\n\n      const timelineToolbar = view.element.shadowRoot!.querySelector('.animation-timeline-toolbar')!;\n      const pauseAllButton = await waitFor('[aria-label=\\'Pause all\\']', timelineToolbar) as HTMLButtonElement;\n      assert.isTrue(pauseAllButton.disabled, 'Pause all button is disabled');\n\n      const controlsToolbar = view.element.shadowRoot!.querySelector('.animation-controls-toolbar')!;\n      const replayButton = await waitFor('[aria-label=\\'Replay timeline\\']', controlsToolbar) as HTMLButtonElement;\n      assert.isTrue(replayButton.disabled, 'Replay button is disabled');\n      cancelAllPendingRaf();\n    });\n\n    it('should show current time text in pixels', async () => {\n      const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n      preview.click();\n      await waitForAnimationGroupSelectedPromise.wait();\n\n      const currentTimeElement = view.element.shadowRoot!.querySelector('.animation-timeline-current-time')!;\n      assert.isTrue(currentTimeElement.textContent?.includes('px'));\n    });\n\n    it('should show timeline grid values in pixels', async () => {\n      const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n      preview.click();\n      await waitForAnimationGroupSelectedPromise.wait();\n\n      const labelElements = [...view.element.shadowRoot!.querySelectorAll('.animation-timeline-grid-label')];\n      assert.isTrue(\n          labelElements.every(el => el.textContent?.includes('px')),\n          'Label is expected to be a pixel value but it is not');\n    });\n\n    describe('animationGroupUpdated', () => {\n      it('should re-draw preview after receiving animationGroupUpdated', async () => {\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n        const initialPreviewLine = preview.querySelector('line');\n        const s = new XMLSerializer();\n        const initialLine = s.serializeToString(initialPreviewLine!);\n        assert.isNotNull(initialPreviewLine);\n        const initialPreviewLineLength = Number.parseInt(initialPreviewLine.getAttribute('x2')!, 10) -\n            Number.parseInt(initialPreviewLine.getAttribute('x1')!, 10);\n\n        void animationModel.animationUpdated({\n          ...SDA_ANIMATION_PAYLOAD,\n          source: {\n            ...SDA_ANIMATION_PAYLOAD.source,\n            duration: 50,\n          },\n        });\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n\n        let currentPreviewLine = preview.querySelector('line');\n        while (initialLine === s.serializeToString(currentPreviewLine!)) {\n          await new Promise(resolve => setTimeout(resolve, 10));\n          currentPreviewLine = preview.querySelector('line');\n        }\n        assert.isNotNull(currentPreviewLine);\n        const currentPreviewLineLength = Number.parseInt(currentPreviewLine.getAttribute('x2')!, 10) -\n            Number.parseInt(currentPreviewLine.getAttribute('x1')!, 10);\n        assert.isTrue(currentPreviewLineLength < initialPreviewLineLength);\n      });\n\n      it('should update duration if the scroll range is changed on animationGroupUpdated', async () => {\n        const SCROLL_RANGE = 20;\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        stubbedAnimationDOMNode.verticalScrollRange.resolves(SCROLL_RANGE);\n        void animationModel.animationUpdated(SDA_ANIMATION_PAYLOAD);\n\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n        assert.strictEqual(view.duration(), SCROLL_RANGE);\n      });\n\n      it('should update current time text if the scroll top is changed on animationGroupUpdated', async () => {\n        const SCROLL_TOP = 5;\n        stubbedAnimationDOMNode.scrollTop.resolves(SCROLL_TOP);\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        const currentTimeElement = view.element.shadowRoot!.querySelector('.animation-timeline-current-time');\n        assert.isNotNull(currentTimeElement);\n        assert.isNotNull(preview);\n\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n        void animationModel.animationUpdated(SDA_ANIMATION_PAYLOAD);\n\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n        assert.strictEqual(currentTimeElement.textContent, '5px');\n      });\n\n      it('should update scrubber position if the scroll top is changed on animationGroupUpdated', async () => {\n        const SCROLL_TOP = 5;\n        stubbedAnimationDOMNode.scrollTop.resolves(SCROLL_TOP);\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        const timelineScrubberElement = view.element.shadowRoot!.querySelector('.animation-scrubber') as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        void animationModel.animationUpdated(SDA_ANIMATION_PAYLOAD);\n\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n        const translateX = Number.parseFloat(timelineScrubberElement.style.transform.match(/translateX\\((.*)px\\)/)![1]);\n        assert.closeTo(translateX, SCROLL_TOP * view.pixelTimeRatio(), 0.5);\n      });\n\n      it('should schedule re-draw selected group after receiving animationGroupUpdated', async () => {\n        const preview = await waitFor('.animation-buffer-preview', view.element.shadowRoot!) as HTMLElement;\n        preview.click();\n        await waitForAnimationGroupSelectedPromise.wait();\n\n        void animationModel.animationUpdated(SDA_ANIMATION_PAYLOAD);\n\n        await waitForScheduleRedrawAfterAnimationGroupUpdated.wait();\n      });\n    });\n  });\n});\n\ndescribeWithMockConnection('AnimationTimeline', () => {\n  it('shows placeholder showing that the panel is waiting for animations', async () => {\n    const view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n    const placeholder = await waitFor('.animation-timeline-buffer-hint', view.element.shadowRoot!) as HTMLElement;\n    assert.exists(placeholder);\n\n    // Render into document in order to see the computed styles.\n    view.markAsRoot();\n    renderElementIntoDOM(view);\n    assert.deepEqual(window.getComputedStyle(placeholder).display, 'flex');\n\n    assert.deepEqual(placeholder.querySelector('.empty-state-header')?.textContent, 'Currently waiting for animations');\n    assert.deepEqual(\n        placeholder.querySelector('.empty-state-description span')?.textContent,\n        'On this page you can inspect and modify animations.');\n\n    view.detach();\n  });\n\n  it('shows placeholder if no animation has been selected', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.AnimationModel.AnimationModel);\n    assert.exists(model);\n\n    const dummyGroups = new Map<string, SDK.AnimationModel.AnimationGroup>();\n    sinon.stub(model, 'animationGroups').value(dummyGroups);\n    dummyGroups.set('dummy', new SDK.AnimationModel.AnimationGroup(model, 'dummy', []));\n\n    // Render into document in order to update the shown empty state.\n    const view = Animation.AnimationTimeline.AnimationTimeline.instance({forceNew: true});\n    view.markAsRoot();\n    renderElementIntoDOM(view);\n\n    const previewUpdatePromise = new ManualPromise();\n    sinon.stub(view, 'previewsCreatedForTest').callsFake(() => {\n      previewUpdatePromise.resolve();\n    });\n\n    await previewUpdatePromise.wait();\n    const placeholder = view.contentElement.querySelector('.animation-timeline-rows-hint');\n    assert.exists(placeholder);\n\n    assert.deepEqual(window.getComputedStyle(placeholder).display, 'flex');\n    assert.deepEqual(placeholder.querySelector('.empty-state-header')?.textContent, 'No animation effect selected');\n    assert.deepEqual(\n        placeholder.querySelector('.empty-state-description span')?.textContent,\n        'Select an effect above to inspect and modify');\n\n    view.detach();\n  });\n});\n"]}