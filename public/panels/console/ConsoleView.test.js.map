{"version":3,"file":"ConsoleView.test.js","sourceRoot":"","sources":["../../../../../../front_end/panels/console/ConsoleView.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as IssuesManager from '../../models/issues_manager/issues_manager.js';\nimport * as TextUtils from '../../models/text_utils/text_utils.js';\nimport {findMenuItemWithLabel, getContextMenuForElement} from '../../testing/ContextMenuHelpers.js';\nimport {dispatchPasteEvent, renderElementIntoDOM} from '../../testing/DOMHelpers.js';\nimport {createTarget, registerNoopActions, updateHostConfig} from '../../testing/EnvironmentHelpers.js';\nimport {expectCall, expectCalled} from '../../testing/ExpectStubCall.js';\nimport {stubFileManager} from '../../testing/FileManagerHelpers.js';\nimport {describeWithMockConnection, dispatchEvent} from '../../testing/MockConnection.js';\nimport * as TextEditor from '../../ui/components/text_editor/text_editor.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {AiCodeCompletionSummaryToolbar} from '../common/common.js';\n\nimport * as Console from './console.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribeWithMockConnection('ConsoleView', () => {\n  let consoleView: Console.ConsoleView.ConsoleView;\n\n  beforeEach(() => {\n    registerNoopActions(['console.clear', 'console.clear.history', 'console.create-pin']);\n    consoleView = Console.ConsoleView.ConsoleView.instance({forceNew: true, viewportThrottlerTimeout: 0});\n  });\n\n  afterEach(() => {\n    consoleView.detach();\n  });\n\n  it('adds a title to every checkbox label in the settings view', async () => {\n    const consoleSettingsCheckboxes =\n        consoleView.element.querySelector('devtools-toolbar')!.querySelectorAll('devtools-checkbox');\n    assert.isOk(consoleSettingsCheckboxes, 'No checkbox found in console settings');\n    for (const checkbox of consoleSettingsCheckboxes) {\n      assert.isTrue(checkbox.shadowRoot?.querySelector('.devtools-checkbox-text')?.hasAttribute('title'));\n    }\n    // This test transitively schedules a task which may cause errors if the task\n    // is run without the environments set in this test. Thus wait for its completion\n    // before proceding to the next test.\n    await consoleView.getScheduledRefreshPromiseForTest();\n  });\n\n  function createConsoleMessage(\n      target: SDK.Target.Target,\n      message: string,\n      type: SDK.ConsoleModel.MessageType = Protocol.Runtime.ConsoleAPICalledEventType.Log,\n      level: Protocol.Log.LogEntryLevel|null = null,\n  ) {\n    return new SDK.ConsoleModel.ConsoleMessage(\n        target.model(SDK.RuntimeModel.RuntimeModel), Protocol.Log.LogEntrySource.Javascript, level, message, {type});\n  }\n\n  it('can save to file', async () => {\n    const tabTarget = createTarget({type: SDK.Target.Type.TAB});\n    createTarget({parentTarget: tabTarget, subtype: 'prerender'});\n    const target = createTarget({parentTarget: tabTarget});\n\n    const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(consoleModel);\n    consoleModel.addMessage(createConsoleMessage(target, 'message 1'));\n    consoleModel.addMessage(createConsoleMessage(target, 'message 2'));\n    const messagesElement = consoleView.element.querySelector('#console-messages');\n    assert.exists(messagesElement);\n\n    const contextMenu = getContextMenuForElement(messagesElement);\n    const saveAsItem = findMenuItemWithLabel(contextMenu.saveSection(), 'Save as…');\n    assert.exists(saveAsItem);\n\n    const TIMESTAMP = 42;\n    const URL_HOST = 'example.com';\n    sinon.stub(Date, 'now').returns(TIMESTAMP);\n    target.setInspectedURL(urlString`${`http://${URL_HOST}/foo`}`);\n    const FILENAME = `${URL_HOST}-${TIMESTAMP}.log` as Platform.DevToolsPath.RawPathString;\n    const fileManager = stubFileManager();\n    const fileManagerCloseCall = expectCall(fileManager.close);\n    contextMenu.invokeHandler(saveAsItem.id());\n    assert.isTrue(fileManager.save.calledOnceWith(\n        FILENAME, TextUtils.ContentData.EMPTY_TEXT_CONTENT_DATA, /* forceSaveAs=*/ true));\n    await fileManagerCloseCall;\n    assert.isTrue(fileManager.append.calledOnceWith(FILENAME, sinon.match('message 1\\nmessage 2\\n')));\n  });\n\n  it('can copy to clipboard', async () => {\n    const tabTarget = createTarget({type: SDK.Target.Type.TAB});\n    createTarget({parentTarget: tabTarget, subtype: 'prerender'});\n    const target = createTarget({parentTarget: tabTarget});\n\n    const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(consoleModel);\n    consoleModel.addMessage(createConsoleMessage(target, 'message 1'));\n    consoleModel.addMessage(createConsoleMessage(target, 'message 2'));\n    const messagesElement = consoleView.element.querySelector('#console-messages');\n    assert.exists(messagesElement);\n\n    const contextMenu = getContextMenuForElement(messagesElement);\n    const copy = findMenuItemWithLabel(contextMenu.saveSection(), 'Copy console');\n    assert.exists(copy);\n\n    const copyText = sinon.stub(Host.InspectorFrontendHost.InspectorFrontendHostInstance, 'copyText').resolves();\n    contextMenu.invokeHandler(copy.id());\n    await expectCalled(copyText);\n    sinon.assert.callCount(copyText, 1);\n    assert.deepEqual(copyText.lastCall.args, ['message 1\\nmessage 2\\n']);\n    copyText.resetHistory();\n  });\n\n  it('creates console history', () => {\n    const target = createTarget();\n    const id = 1;\n    dispatchEvent(target, 'Runtime.executionContextCreated', {\n      context: {\n        id: id as Protocol.Runtime.ExecutionContextId,\n        origin: 'http://example.com',\n        name: `c${id}`,\n        uniqueId: `c${id}`,\n        auxData: {\n          frameId: 'f2',\n        },\n      },\n    });\n    const runtimeModel = target.model(SDK.RuntimeModel.RuntimeModel);\n    assert.exists(runtimeModel);\n    const executionContext = runtimeModel.executionContext(id);\n    assert.exists(executionContext);\n    UI.Context.Context.instance().setFlavor(SDK.RuntimeModel.ExecutionContext, executionContext);\n\n    const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(consoleModel);\n    consoleModel.addMessage(createConsoleMessage(target, 'let x = 1;', SDK.ConsoleModel.FrontendMessageType.Command));\n    consoleModel.addMessage(createConsoleMessage(target, 'let y = 100;', SDK.ConsoleModel.FrontendMessageType.Command));\n\n    const consoleHistory = consoleView.getConsoleMessageHistory();\n    assert.deepEqual(consoleHistory, 'let x = 1;\\n\\nlet y = 100;\\n\\n');\n  });\n\n  async function getConsoleMessages() {\n    const messagesElement = consoleView.element.querySelector('#console-messages');\n    assert.exists(messagesElement);\n\n    await new Promise(resolve => setTimeout(resolve, 0));\n    return [...messagesElement.querySelectorAll('.console-message-text')].map(e => (e as HTMLElement).innerText);\n  }\n\n  const messageTests = (inScope: boolean) => () => {\n    let target: SDK.Target.Target;\n\n    beforeEach(() => {\n      target = createTarget();\n      SDK.TargetManager.TargetManager.instance().setScopeTarget(inScope ? target : null);\n      consoleView.markAsRoot();\n      renderElementIntoDOM(consoleView);\n    });\n\n    it('adds messages', async () => {\n      const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n      assert.exists(consoleModel);\n      SDK.ConsoleModel.ConsoleModel.requestClearMessages();\n      consoleModel.addMessage(createConsoleMessage(target, 'message 1'));\n      consoleModel.addMessage(createConsoleMessage(target, 'message 2'));\n\n      const messages = await getConsoleMessages();\n      assert.deepEqual(messages, inScope ? ['message 1', 'message 2'] : []);\n    });\n\n    it('prints results', async () => {\n      const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n      assert.exists(consoleModel);\n      const runtimeModel = target.model(SDK.RuntimeModel.RuntimeModel);\n      assert.exists(runtimeModel);\n      SDK.ConsoleModel.ConsoleModel.requestClearMessages();\n      consoleModel.dispatchEventToListeners(SDK.ConsoleModel.Events.CommandEvaluated, {\n        result: new SDK.RemoteObject.RemoteObjectImpl(runtimeModel, undefined, 'number', undefined, 42),\n        commandMessage: createConsoleMessage(target, '[ultimateQuestionOfLife, theUniverse, everything].join()'),\n      });\n\n      const messages = await getConsoleMessages();\n      assert.deepEqual(messages, inScope ? ['42'] : []);\n    });\n  };\n\n  describe('in scope', messageTests(true));\n  describe('out of scope', messageTests(false));\n\n  const handlesSwitchingScope = (preserveLog: boolean) => async () => {\n    Common.Settings.Settings.instance().moduleSetting('preserve-console-log').set(preserveLog);\n    const target = createTarget();\n    SDK.TargetManager.TargetManager.instance().setScopeTarget(target);\n    const anotherTarget = createTarget();\n    consoleView.markAsRoot();\n    renderElementIntoDOM(consoleView);\n\n    const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(consoleModel);\n    consoleModel.addMessage(createConsoleMessage(target, 'message 1'));\n    consoleModel.addMessage(createConsoleMessage(target, 'message 2'));\n\n    const anotherConsoleModel = anotherTarget.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(anotherConsoleModel);\n    anotherConsoleModel.addMessage(createConsoleMessage(anotherTarget, 'message 3'));\n    assert.deepEqual(await getConsoleMessages(), ['message 1', 'message 2']);\n\n    SDK.TargetManager.TargetManager.instance().setScopeTarget(anotherTarget);\n    assert.deepEqual(await getConsoleMessages(), preserveLog ? ['message 1', 'message 2', 'message 3'] : ['message 3']);\n\n    Common.Settings.Settings.instance().moduleSetting('preserve-console-log').set(false);\n  };\n\n  it('replaces messages when switching scope with preserve log off', handlesSwitchingScope(false));\n  it('appends messages when switching scope with preserve log on', handlesSwitchingScope(true));\n\n  describe('self-XSS warning', () => {\n    let target: SDK.Target.Target;\n\n    beforeEach(() => {\n      target = createTarget();\n      SDK.TargetManager.TargetManager.instance().setScopeTarget(target);\n      consoleView.markAsRoot();\n      renderElementIntoDOM(consoleView);\n    });\n\n    it('shows', async () => {\n      const dt = new DataTransfer();\n      dt.setData('text/plain', 'foo');\n\n      const messagesElement = consoleView.element.querySelector('#console-messages');\n      assert.instanceOf(messagesElement, HTMLElement);\n      dispatchPasteEvent(messagesElement, {clipboardData: dt, bubbles: true});\n      assert.strictEqual(\n          Common.Console.Console.instance().messages()[0].text,\n          'Warning: Don’t paste code into the DevTools Console that you don’t understand or haven’t reviewed yourself. This could allow attackers to steal your identity or take control of your computer. Please type ‘allow pasting’ below and press Enter to allow pasting.');\n    });\n\n    it('is turned off when console history reaches a length of 5', async () => {\n      const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n      assert.exists(consoleModel);\n      const runtimeModel = target.model(SDK.RuntimeModel.RuntimeModel);\n      assert.exists(runtimeModel);\n      SDK.ConsoleModel.ConsoleModel.requestClearMessages();\n\n      const selfXssWarningDisabledSetting = Common.Settings.Settings.instance().createSetting(\n          'disable-self-xss-warning', false, Common.Settings.SettingStorageType.SYNCED);\n\n      for (let i = 0; i < 5; i++) {\n        assert.isFalse(selfXssWarningDisabledSetting.get());\n        consoleModel.dispatchEventToListeners(\n            SDK.ConsoleModel.Events.MessageAdded,\n            createConsoleMessage(target, String(i), SDK.ConsoleModel.FrontendMessageType.Command));\n      }\n      assert.isTrue(selfXssWarningDisabledSetting.get());\n    });\n\n    it('is not shown when disabled via command line', () => {\n      const stub = sinon.stub(Root.Runtime.Runtime, 'queryParam');\n      stub.withArgs('disableSelfXssWarnings').returns('true');\n\n      const dt = new DataTransfer();\n      dt.setData('text/plain', 'foo');\n\n      const messagesElement = consoleView.element.querySelector('#console-messages');\n      assert.instanceOf(messagesElement, HTMLElement);\n      dispatchPasteEvent(messagesElement, {clipboardData: dt, bubbles: true});\n\n      assert.lengthOf(Common.Console.Console.instance().messages(), 0);\n      stub.restore();\n    });\n  });\n\n  it('appends commands to the history right away', async () => {\n    const target = createTarget();\n    SDK.TargetManager.TargetManager.instance().setScopeTarget(target);\n    consoleView.markAsRoot();\n    renderElementIntoDOM(consoleView);\n\n    const consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n    assert.exists(consoleModel);\n    const consoleHistorySetting = Common.Settings.Settings.instance().createLocalSetting('console-history', []);\n\n    consoleModel.dispatchEventToListeners(\n        SDK.ConsoleModel.Events.MessageAdded,\n        createConsoleMessage(target, 'await new Promise(() => ())', SDK.ConsoleModel.FrontendMessageType.Command));\n\n    assert.deepEqual(consoleHistorySetting.get(), ['await new Promise(() => ())']);\n  });\n\n  it('keeps updating the issue counter when re-attached after detaching', async () => {\n    consoleView.markAsRoot();\n    const spy = sinon.spy(consoleView, 'issuesCountUpdatedForTest');\n    const issuesManager = IssuesManager.IssuesManager.IssuesManager.instance();\n    issuesManager.dispatchEventToListeners(IssuesManager.IssuesManager.Events.ISSUES_COUNT_UPDATED);\n    sinon.assert.calledOnce(spy);\n\n    // Pauses updating the issue counter\n    consoleView.onDetach();\n    issuesManager.dispatchEventToListeners(IssuesManager.IssuesManager.Events.ISSUES_COUNT_UPDATED);\n    sinon.assert.calledOnce(spy);\n\n    // Continues updating the issue counter\n    renderElementIntoDOM(consoleView);\n    issuesManager.dispatchEventToListeners(IssuesManager.IssuesManager.Events.ISSUES_COUNT_UPDATED);\n    sinon.assert.calledTwice(spy);\n  });\n\n  describe('ai code completion provider callbacks', () => {\n    beforeEach(async () => {\n      updateHostConfig({\n        devToolsAiCodeCompletion: {\n          enabled: true,\n        },\n        aidaAvailability: {\n          enabled: true,\n          blockedByAge: false,\n          blockedByGeo: false,\n        },\n      });\n      const aiCodeCompletionProviderStub =\n          sinon.createStubInstance(TextEditor.AiCodeCompletionProvider.AiCodeCompletionProvider);\n      aiCodeCompletionProviderStub.extension.returns([]);\n      sinon.stub(TextEditor.AiCodeCompletionProvider.AiCodeCompletionProvider, 'createInstance')\n          .returns(aiCodeCompletionProviderStub);\n      sinon.stub(Host.AidaClient.HostConfigTracker, 'instance').returns({\n        addEventListener: () => {},\n        removeEventListener: () => {},\n        dispose: () => {},\n      } as unknown as Host.AidaClient.HostConfigTracker);\n      Common.Settings.Settings.instance().createSetting('ai-code-completion-enabled', true);\n      consoleView = Console.ConsoleView.ConsoleView.instance({forceNew: true, viewportThrottlerTimeout: 0});\n    });\n\n    it('initializes toolbar when the feature is enabled', async () => {\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n\n      providerConfig.onFeatureEnabled();\n\n      assert.exists(consoleView.element.querySelector('div.ai-code-completion-summary-toolbar-container'));\n    });\n\n    it('cleans up toolbar when the feature is disabled', async () => {\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n      providerConfig.onFeatureEnabled();\n      assert.exists(consoleView.element.querySelector('div.ai-code-completion-summary-toolbar-container'));\n\n      providerConfig.onFeatureDisabled();\n\n      assert.notExists(consoleView.element.querySelector('div.ai-code-completion-summary-toolbar-container'));\n    });\n\n    it('shows a loading state when a request is triggered', async () => {\n      const setLoadingSpy = sinon.stub(AiCodeCompletionSummaryToolbar.prototype, 'setLoading');\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n      providerConfig.onFeatureEnabled();\n\n      providerConfig.onRequestTriggered();\n\n      sinon.assert.calledOnce(setLoadingSpy);\n      assert.isTrue(setLoadingSpy.firstCall.args[0]);\n    });\n\n    it('hides the loading indicator when a response is received', async () => {\n      const setLoadingSpy = sinon.stub(AiCodeCompletionSummaryToolbar.prototype, 'setLoading');\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n      providerConfig.onFeatureEnabled();\n      providerConfig.onRequestTriggered();\n      sinon.assert.calledOnce(setLoadingSpy);\n      assert.isTrue(setLoadingSpy.firstCall.args[0]);\n\n      providerConfig.onResponseReceived();\n\n      sinon.assert.calledTwice(setLoadingSpy);\n      assert.isFalse(setLoadingSpy.secondCall.args[0]);\n    });\n\n    it('attaches the citations toolbar when a suggestion with citations is accepted', async () => {\n      const updateCitationsSpy = sinon.spy(AiCodeCompletionSummaryToolbar.prototype, 'updateCitations');\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n\n      providerConfig.onFeatureEnabled();\n      providerConfig.onResponseReceived();\n\n      providerConfig.onSuggestionAccepted([{uri: 'https://example.com/source'}]);\n\n      sinon.assert.calledOnce(updateCitationsSpy);\n      assert.deepEqual(updateCitationsSpy.firstCall.args, [['https://example.com/source']]);\n    });\n\n    it('does not attach the citations toolbar if there are no citations', async () => {\n      const updateCitationsSpy = sinon.spy(AiCodeCompletionSummaryToolbar.prototype, 'updateCitations');\n      const providerConfig = consoleView.aiCodeCompletionConfig;\n      assert.exists(providerConfig);\n\n      providerConfig.onFeatureEnabled();\n      providerConfig.onResponseReceived();\n\n      providerConfig.onSuggestionAccepted([]);\n\n      sinon.assert.notCalled(updateCitationsSpy);\n    });\n  });\n\n  describe('group visibility', () => {\n    let target: ReturnType<typeof createTarget>;\n    let consoleModel: SDK.ConsoleModel.ConsoleModel|null;\n\n    beforeEach(() => {\n      target = createTarget();\n      SDK.TargetManager.TargetManager.instance().setScopeTarget(target);\n      consoleModel = target.model(SDK.ConsoleModel.ConsoleModel);\n      assert.exists(consoleModel);\n    });\n\n    function addMessage(\n        message: string, type: Protocol.Runtime.ConsoleAPICalledEventType, level: Protocol.Log.LogEntryLevel) {\n      consoleModel!.addMessage(createConsoleMessage(target, message, type, level));\n    }\n\n    for (const level\n             of [Protocol.Log.LogEntryLevel.Error,\n                 Protocol.Log.LogEntryLevel.Warning,\n                 Protocol.Log.LogEntryLevel.Info,\n                 Protocol.Log.LogEntryLevel.Verbose,\n    ]) {\n      it(`shows collapsed group but not message when filtering for ${level}`, async () => {\n        const levels = Console.ConsoleFilter.ConsoleFilter.singleLevelMask(level);\n        // Setting might exist, .set() is crucial\n        Common.Settings.Settings.instance().createSetting('message-level-filters', levels).set(levels);\n\n        consoleView.markAsRoot();\n        renderElementIntoDOM(consoleView);\n\n        addMessage(\n            'group', Protocol.Runtime.ConsoleAPICalledEventType.StartGroupCollapsed, Protocol.Log.LogEntryLevel.Info);\n        addMessage('message', Protocol.Runtime.ConsoleAPICalledEventType.Log, level);\n        addMessage('', Protocol.Runtime.ConsoleAPICalledEventType.EndGroup, Protocol.Log.LogEntryLevel.Info);\n\n        const messages = await getConsoleMessages();\n        assert.include(messages, 'group');\n        assert.notInclude(messages, 'message');\n      });\n\n      it(`shows expanded group and message when filtering for ${level}`, async () => {\n        const levels = Console.ConsoleFilter.ConsoleFilter.singleLevelMask(level);\n        // Setting might exist, .set() is crucial\n        Common.Settings.Settings.instance().createSetting('message-level-filters', levels).set(levels);\n\n        consoleView.markAsRoot();\n        renderElementIntoDOM(consoleView);\n\n        addMessage('group', Protocol.Runtime.ConsoleAPICalledEventType.StartGroup, Protocol.Log.LogEntryLevel.Info);\n        addMessage('message', Protocol.Runtime.ConsoleAPICalledEventType.Log, level);\n        addMessage('', Protocol.Runtime.ConsoleAPICalledEventType.EndGroup, Protocol.Log.LogEntryLevel.Info);\n\n        const messages = await getConsoleMessages();\n        assert.include(messages, 'group');\n        assert.include(messages, 'message');\n      });\n    }\n\n    it(`does not show group when filtering for level it does not contain`, async () => {\n      const levels = Console.ConsoleFilter.ConsoleFilter.singleLevelMask(Protocol.Log.LogEntryLevel.Warning);\n      // Setting might exist, .set() is crucial\n      Common.Settings.Settings.instance().createSetting('message-level-filters', levels).set(levels);\n\n      consoleView.markAsRoot();\n      renderElementIntoDOM(consoleView);\n\n      addMessage('group', Protocol.Runtime.ConsoleAPICalledEventType.StartGroup, Protocol.Log.LogEntryLevel.Info);\n      addMessage('message', Protocol.Runtime.ConsoleAPICalledEventType.Log, Protocol.Log.LogEntryLevel.Error);\n      addMessage('', Protocol.Runtime.ConsoleAPICalledEventType.EndGroup, Protocol.Log.LogEntryLevel.Info);\n\n      const messages = await getConsoleMessages();\n      assert.notInclude(messages, 'group');\n      assert.notInclude(messages, 'message');\n    });\n  });\n});\n"]}