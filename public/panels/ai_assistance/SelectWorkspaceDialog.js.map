{"version":3,"file":"SelectWorkspaceDialog.js","sourceRoot":"","sources":["../../../../../../front_end/panels/ai_assistance/SelectWorkspaceDialog.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Platform from '../../core/platform/platform.js';\nimport * as Persistence from '../../models/persistence/persistence.js';\nimport * as Workspace from '../../models/workspace/workspace.js';\nimport * as Buttons from '../../ui/components/buttons/buttons.js';\nimport * as UI from '../../ui/legacy/legacy.js';\nimport {html, render} from '../../ui/lit/lit.js';\n\nimport selectWorkspaceDialogStyles from './selectWorkspaceDialog.css.js';\n\n/*\n* Strings that don't need to be translated at this time.\n*/\nconst UIStringsNotTranslate = {\n  /**\n   *@description Heading of dialog box which asks user to select a workspace folder.\n   */\n  selectFolder: 'Select folder',\n  /**\n   *@description Button text for canceling workspace selection.\n   */\n  cancel: 'Cancel',\n  /**\n   *@description Button text for confirming the selected workspace folder.\n   */\n  select: 'Select',\n  /*\n   *@description Button text for adding a workspace folder.\n   */\n  addFolder: 'Add folder',\n  /*\n   *@description Explainer stating that selected folder's contents are being sent to Google.\n   */\n  sourceCodeSent: 'Source code from the selected folder is sent to Google to generate code suggestions'\n} as const;\n\nconst lockedString = i18n.i18n.lockedString;\n\ninterface ViewInput {\n  projects: Array<{\n    name: string,\n    path: string,\n  }>;\n  selectedIndex: number;\n  onProjectSelected: (index: number) => void;\n  onSelectButtonClick: () => void;\n  onCancelButtonClick: () => void;\n  onAddFolderButtonClick: () => void;\n}\n\ntype View = (input: ViewInput, output: undefined, target: HTMLElement) => void;\n\nexport class SelectWorkspaceDialog extends UI.Widget.VBox {\n  #view: View;\n  #workspace = Workspace.Workspace.WorkspaceImpl.instance();\n  #projects: Workspace.Workspace.Project[] = [];\n  #selectedIndex = 0;\n  #handleProjectSelected: (project: Workspace.Workspace.Project) => void;\n  #boundOnKeyDown: (event: KeyboardEvent) => void;\n  #dialog: UI.Dialog.Dialog;\n\n  constructor(\n      options: {\n        dialog: UI.Dialog.Dialog,\n        handleProjectSelected: (project: Workspace.Workspace.Project) => void,\n        currentProject?: Workspace.Workspace.Project,\n      },\n      view?: View) {\n    super();\n    this.registerRequiredCSS(selectWorkspaceDialogStyles);\n    this.#boundOnKeyDown = this.#onKeyDown.bind(this);\n    this.#handleProjectSelected = options.handleProjectSelected;\n    this.#projects = this.#getProjects();\n    this.#dialog = options.dialog;\n\n    if (options.currentProject) {\n      this.#selectedIndex = this.#projects.indexOf(options.currentProject);\n    }\n\n    // clang-format off\n    this.#view = view ?? ((input, output, target) => {\n      render(\n        html`\n          <div class=\"dialog-header\">${lockedString(UIStringsNotTranslate.selectFolder)}</div>\n          <div class=\"main-content\">${lockedString(UIStringsNotTranslate.sourceCodeSent)}</div>\n          <ul>\n            ${input.projects.map((project, index) => {\n              return html`\n                <li\n                  @click=${() => input.onProjectSelected(index)}\n                  class=${index === input.selectedIndex ? 'selected' : ''}\n                  title=${project.path}\n                >\n                  <devtools-icon class=\"folder-icon\" .name=${'folder'}></devtools-icon>\n                  ${project.name}\n                </li>`;\n            })}\n          </ul>\n          <div class=\"buttons\">\n            <devtools-button\n              title=${lockedString(UIStringsNotTranslate.cancel)}\n              aria-label=\"Cancel\"\n              .jslogContext=${'cancel'}\n              @click=${input.onCancelButtonClick}\n              .variant=${Buttons.Button.Variant.OUTLINED}>${lockedString(UIStringsNotTranslate.cancel)}</devtools-button>\n            <devtools-button\n              class=\"add-folder-button\"\n              title=${lockedString(UIStringsNotTranslate.addFolder)}\n              aria-label=\"Add folder\"\n              .iconName=${'plus'}\n              .jslogContext=${'add-folder'}\n              @click=${input.onAddFolderButtonClick}\n              .variant=${Buttons.Button.Variant.TONAL}>${lockedString(UIStringsNotTranslate.addFolder)}</devtools-button>\n            <devtools-button\n              title=${lockedString(UIStringsNotTranslate.select)}\n              aria-label=\"Select\"\n              @click=${input.onSelectButtonClick}\n              .jslogContext=${'select'}\n              .variant=${Buttons.Button.Variant.PRIMARY}>${lockedString(UIStringsNotTranslate.select)}</devtools-button>\n          </div>\n        `,\n        target,\n        {host: target}\n      );\n    }) as View;\n    // clang-format on\n    this.performUpdate();\n  }\n\n  override wasShown(): void {\n    const document = UI.InspectorView.InspectorView.instance().element.ownerDocument;\n    document.addEventListener('keydown', this.#boundOnKeyDown, true);\n    this.#workspace.addEventListener(Workspace.Workspace.Events.ProjectAdded, this.#onProjectAdded, this);\n  }\n\n  override willHide(): void {\n    const document = UI.InspectorView.InspectorView.instance().element.ownerDocument;\n    document.removeEventListener('keydown', this.#boundOnKeyDown, true);\n    this.#workspace.removeEventListener(Workspace.Workspace.Events.ProjectAdded, this.#onProjectAdded, this);\n  }\n\n  #onKeyDown(event: KeyboardEvent): void {\n    switch (event.key) {\n      case 'ArrowDown':\n        this.#selectedIndex = Math.min(this.#selectedIndex + 1, this.#projects.length - 1);\n        this.requestUpdate();\n        break;\n      case 'ArrowUp':\n        this.#selectedIndex = Math.max(this.#selectedIndex - 1, 0);\n        this.requestUpdate();\n        break;\n    }\n  }\n\n  override performUpdate(): void {\n    const viewInput = {\n      projects:\n          this.#projects.map(project => ({\n                               name: project.displayName(),\n                               path: Persistence.FileSystemWorkspaceBinding.FileSystemWorkspaceBinding.fileSystemPath(\n                                   (project?.id() || '') as Platform.DevToolsPath.UrlString),\n                             })),\n      selectedIndex: this.#selectedIndex,\n      onProjectSelected: (index: number) => {\n        this.#selectedIndex = index;\n        this.requestUpdate();\n      },\n      onSelectButtonClick: () => {\n        this.#dialog.hide();\n        this.#handleProjectSelected(this.#projects[this.#selectedIndex]);\n      },\n      onCancelButtonClick: () => {\n        this.#dialog.hide();\n      },\n      onAddFolderButtonClick: () => {\n        void Persistence.IsolatedFileSystemManager.IsolatedFileSystemManager.instance().addFileSystem();\n      }\n    };\n\n    this.#view(viewInput, undefined, this.contentElement);\n  }\n\n  #getProjects(): Workspace.Workspace.Project[] {\n    return this.#workspace.projectsForType(Workspace.Workspace.projectTypes.FileSystem)\n        .filter(\n            project => project instanceof Persistence.FileSystemWorkspaceBinding.FileSystem &&\n                project.fileSystem().type() ===\n                    Persistence.PlatformFileSystem.PlatformFileSystemType.WORKSPACE_PROJECT);\n  }\n\n  #onProjectAdded(): void {\n    this.#projects = this.#getProjects();\n    this.requestUpdate();\n  }\n}\n"]}