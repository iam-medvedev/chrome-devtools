{"version":3,"file":"ChatView.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/ChatView.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,IAAI,MAAM,4BAA4B,CAAC;AACnD,OAAO,KAAK,iBAAiB,MAAM,gDAAgD,CAAC;AACpF,OAAO,EAAC,iCAAiC,EAAE,wBAAwB,EAAC,MAAM,yCAAyC,CAAC;AACpH,OAAO,EAAC,oBAAoB,EAAC,MAAM,gCAAgC,CAAC;AACpE,OAAO,EAAC,uBAAuB,EAAC,MAAM,wCAAwC,CAAC;AAC/E,OAAO,KAAK,iBAAiB,MAAM,qBAAqB,CAAC;AAEzD,uBAAuB,CAAC,UAAU,EAAE,GAAG,EAAE;IACvC,SAAS,OAAO,CAAC,OAAyC;QACxD,MAAM,IAAI,GAAG,GAAG,EAAE,GAAE,CAAC,CAAC;QACtB,MAAM,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI,EAAE,CAAC;QACxC,MAAM,eAAe,GAAG,KAAK,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;QAC7F,eAAe,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACrC,OAAO;YACL,YAAY,EAAE,IAAI;YAClB,qBAAqB,EAAE,IAAI;YAC3B,gBAAgB,EAAE,IAAI;YACtB,aAAa,EAAE,IAAI;YACnB,cAAc,EAAE,IAAI;YACpB,mBAAmB,EAAE,IAAI;YACzB,iBAAiB,EAAE,IAAI;YACvB,aAAa,EAAE,IAAI,iBAAiB,CAAC,aAAa,CAAC,aAAa,EAAE;YAClE,qBAAqB,EAAE,KAAK;YAC5B,gBAAgB,gFAA6D;YAC7E,QAAQ;YACR,eAAe;YACf,SAAS,EAAE,KAAK;YAChB,mBAAmB,EAAE,KAAK;YAC1B,QAAQ,EAAE,EAAE;YACZ,oBAAoB,EAAE,KAAK;YAC3B,UAAU,EAAE,KAAK;YACjB,mBAAmB,EAAE,KAAK;YAC1B,qBAAqB,EAAE,EAAE;YACzB,gBAAgB,EAAE,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,mBAAmB,CAAC;YAC7D,cAAc,EAAE,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,iBAAiB,CAAC;YACzD,gBAAgB,EAAE,IAAI,iBAAiB,CAAC,6BAA6B,EAAE;YACvE,uBAAuB,EAAE,EAAE;YAC3B,GAAG,OAAO;SACX,CAAC;IACJ,CAAC;IAED,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,oEAAoE,EAAE,KAAK,IAAI,EAAE;YAClF,iCAAiC,EAAE,CAAC;YACpC,wBAAwB,EAAE,CAAC;YAE3B,MAAM,KAAK,GAAG,OAAO,CAAC;gBACpB,QAAQ,EAAE;oBACR;wBACE,MAAM,qEAAuD;wBAC7D,KAAK,EAAE;4BACL;gCACE,IAAI,EAAE,MAAM;gCACZ,IAAI,EAAE;oCACJ,SAAS,EAAE,KAAK;oCAChB,KAAK,EAAE,yBAAyB;oCAChC,OAAO,EAAE,yBAAyB;oCAClC,IAAI,EAAE,+BAA+B;oCACrC,UAAU,EAAE;wCACV,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC;qCACnB;iCACF;6BACF;yBACF;qBACF;iBACF;aACF,CAAC,CAAC;YACH,MAAM,IAAI,GAAG,IAAI,iBAAiB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;YACnD,oBAAoB,CAAC,IAAI,CAAC,CAAC;YAE3B,MAAM,UAAU,GAAG,IAAI,CAAC,UAAW,CAAC,aAAa,CAAC,2BAA2B,CAAC,CAAC;YAC/E,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as AiAssistanceModel from '../../../models/ai_assistance/ai_assistance.js';\nimport {initializePersistenceImplForTests, setupAutomaticFileSystem} from '../../../testing/AiAssistanceHelpers.js';\nimport {renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport * as AiAssistancePanel from '../ai_assistance.js';\n\ndescribeWithEnvironment('ChatView', () => {\n  function getProp(options: Partial<AiAssistancePanel.Props>): AiAssistancePanel.Props {\n    const noop = () => {};\n    const messages = options.messages ?? [];\n    const selectedContext = sinon.createStubInstance(AiAssistanceModel.StylingAgent.NodeContext);\n    selectedContext.getTitle.returns('');\n    return {\n      onTextSubmit: noop,\n      onInspectElementClick: noop,\n      onFeedbackSubmit: noop,\n      onCancelClick: noop,\n      onContextClick: noop,\n      onCopyResponseClick: noop,\n      onNewConversation: noop,\n      changeManager: new AiAssistanceModel.ChangeManager.ChangeManager(),\n      inspectElementToggled: false,\n      conversationType: AiAssistanceModel.AiHistoryStorage.ConversationType.STYLING,\n      messages,\n      selectedContext,\n      isLoading: false,\n      canShowFeedbackForm: false,\n      userInfo: {},\n      blockedByCrossOrigin: false,\n      isReadOnly: false,\n      isTextInputDisabled: false,\n      emptyStateSuggestions: [],\n      inputPlaceholder: i18n.i18n.lockedString('input placeholder'),\n      disclaimerText: i18n.i18n.lockedString('disclaimer text'),\n      markdownRenderer: new AiAssistancePanel.MarkdownRendererWithCodeBlock(),\n      additionalFloatyContext: [],\n      ...options,\n    };\n  }\n\n  describe('SideEffects', () => {\n    it('should show SideEffects when the step contains \"sideEffect\" object', async () => {\n      initializePersistenceImplForTests();\n      setupAutomaticFileSystem();\n\n      const props = getProp({\n        messages: [\n          {\n            entity: AiAssistancePanel.ChatMessage.ChatMessageEntity.MODEL,\n            parts: [\n              {\n                type: 'step',\n                step: {\n                  isLoading: false,\n                  title: 'Updating element styles',\n                  thought: 'Updating element styles',\n                  code: '$0.style.background = \"blue\";',\n                  sideEffect: {\n                    onAnswer: () => {},\n                  },\n                },\n              },\n            ],\n          },\n        ],\n      });\n      const chat = new AiAssistancePanel.ChatView(props);\n      renderElementIntoDOM(chat);\n\n      const sideEffect = chat.shadowRoot!.querySelector('.side-effect-confirmation');\n      assert.exists(sideEffect);\n    });\n  });\n});\n"]}