{"version":3,"file":"ChatMessage.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/ChatMessage.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport {assertScreenshot, renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {\n  describeWithEnvironment,\n} from '../../../testing/EnvironmentHelpers.js';\nimport {createViewFunctionStub, type ViewFunctionStub} from '../../../testing/ViewFunctionHelpers.js';\nimport * as AiAssistance from '../ai_assistance.js';\n\ndescribeWithEnvironment('ChatMessage', () => {\n  function createComponent(props: AiAssistance.ChatMessage.MessageInput):\n      [ViewFunctionStub<typeof AiAssistance.ChatMessage.ChatMessage>, AiAssistance.ChatMessage.ChatMessage] {\n    const view = createViewFunctionStub(AiAssistance.ChatMessage.ChatMessage);\n    const component = new AiAssistance.ChatMessage.ChatMessage(undefined, view);\n    Object.assign(component, props);\n    component.wasShown();\n    return [view, component];\n  }\n\n  it('should show the feedback form when canShowFeedbackForm is true', async () => {\n    const [view] = createComponent({\n      message: {\n        entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n        parts: [],\n        rpcId: 99,\n      },\n      isLoading: false,\n      isReadOnly: false,\n      isLastMessage: true,\n      userInfo: {},\n      markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n      canShowFeedbackForm: true,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.showRateButtons).equals(true);\n      expect(view.input.isShowingFeedbackForm).equals(false);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n    {\n      expect(view.input.isShowingFeedbackForm).equals(true);\n    }\n  });\n\n  it('should not show the feedback form when canShowFeedbackForm is false', async () => {\n    const [view] = createComponent({\n      message: {\n        entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n        parts: [],\n        rpcId: 99,\n      },\n      isLoading: false,\n      isReadOnly: false,\n      isLastMessage: true,\n      userInfo: {},\n      markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n      canShowFeedbackForm: false,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.isShowingFeedbackForm).equals(false);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n    {\n      expect(view.input.isShowingFeedbackForm).equals(false);\n    }\n  });\n\n  it('should disable the submit button when the input is empty', async () => {\n    const [view] = createComponent({\n      message: {\n        entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n        parts: [],\n        rpcId: 99,\n      },\n      isLoading: false,\n      isReadOnly: false,\n      isLastMessage: false,\n      userInfo: {},\n      markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n      canShowFeedbackForm: true,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(true);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n\n    {\n      expect(view.input.isShowingFeedbackForm).equals(true);\n      view.input.onInputChange('test');\n    }\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(false);\n      view.input.onSubmit(new SubmitEvent('submit'));\n    }\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(true);\n    }\n  });\n\n  it('shows no rate buttons when rpcId is not present', async () => {\n    const [view] = createComponent({\n      message: {\n        entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n        parts: [],\n      },\n      isLoading: false,\n      isReadOnly: false,\n      isLastMessage: true,\n      userInfo: {},\n      markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n      canShowFeedbackForm: true,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n    expect(view.input.showRateButtons).equals(false);\n  });\n\n  describe('view', () => {\n    it('renders a minimal model message', async () => {\n      const target = document.createElement('div');\n      renderElementIntoDOM(target);\n      AiAssistance.ChatMessage.DEFAULT_VIEW(\n          {\n            onRatingClick: () => {},\n            onReportClick: () => {},\n            onCopyResponseClick: () => {},\n            scrollSuggestionsScrollContainer: () => {},\n            onSuggestionsScrollOrResize: () => {},\n            onSuggestionClick: () => {},\n            onSubmit: () => {},\n            onClose: () => {},\n            onInputChange: () => {},\n            onFeedbackSubmit: () => {},\n            showRateButtons: true,\n            isSubmitButtonDisabled: false,\n            isShowingFeedbackForm: true,\n            isLastMessage: true,\n            message: {\n              entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n              parts: [],\n              rpcId: 99,\n            },\n            isLoading: false,\n            isReadOnly: false,\n            canShowFeedbackForm: true,\n            userInfo: {},\n            markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n            currentRating: undefined,\n          },\n          {}, target);\n      await assertScreenshot('ai_assistance/user_action_row_minimal.png');\n    });\n\n    it('renders a complete model message', async () => {\n      const target = document.createElement('div');\n      renderElementIntoDOM(target);\n      AiAssistance.ChatMessage.DEFAULT_VIEW(\n          {\n            onRatingClick: () => {},\n            onReportClick: () => {},\n            onCopyResponseClick: () => {},\n            scrollSuggestionsScrollContainer: () => {},\n            onSuggestionsScrollOrResize: () => {},\n            onSuggestionClick: () => {},\n            onSubmit: () => {},\n            onClose: () => {},\n            onInputChange: () => {},\n            onFeedbackSubmit: () => {},\n            showRateButtons: true,\n            isSubmitButtonDisabled: false,\n            isShowingFeedbackForm: true,\n            isLastMessage: true,\n            message: {\n              entity: AiAssistance.ChatMessage.ChatMessageEntity.MODEL,\n              rpcId: 99,\n              parts: [\n                {\n                  type: 'step',\n                  step: {\n                    isLoading: false,\n                    title: 'Analyzing the page',\n                    thought: 'I am checking the page content to find the issue.',\n                    code: 'document.body.innerHTML',\n                    output: '<body>...</body>',\n                  }\n                },\n                {\n                  type: 'answer',\n                  text: 'The page seems to have some content.',\n                  suggestions: ['Fix the issue', 'Explain more'],\n                }\n              ],\n            },\n            isLoading: false,\n            isReadOnly: false,\n            canShowFeedbackForm: true,\n            userInfo: {},\n            markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n            currentRating: undefined,\n            suggestions: ['Fix the issue', 'Explain more'],\n          },\n          {}, target);\n      await assertScreenshot('ai_assistance/user_action_row_complete.png');\n    });\n\n    it('renders a complete user message', async () => {\n      const target = document.createElement('div');\n      renderElementIntoDOM(target);\n      AiAssistance.ChatMessage.DEFAULT_VIEW(\n          {\n            onRatingClick: () => {},\n            onReportClick: () => {},\n            onCopyResponseClick: () => {},\n            scrollSuggestionsScrollContainer: () => {},\n            onSuggestionsScrollOrResize: () => {},\n            onSuggestionClick: () => {},\n            onSubmit: () => {},\n            onClose: () => {},\n            onInputChange: () => {},\n            onFeedbackSubmit: () => {},\n            showRateButtons: false,\n            isSubmitButtonDisabled: false,\n            isShowingFeedbackForm: false,\n            isLastMessage: true,\n            message: {\n              entity: AiAssistance.ChatMessage.ChatMessageEntity.USER,\n              text: 'Can you help me fix specific CSS rules?',\n            },\n            isLoading: false,\n            isReadOnly: false,\n            canShowFeedbackForm: false,\n            userInfo: {\n              accountFullName: 'Test',\n            },\n            markdownRenderer: new AiAssistance.MarkdownRendererWithCodeBlock(),\n            currentRating: undefined,\n          },\n          {}, target);\n      await assertScreenshot('ai_assistance/user_action_row_user_message.png');\n    });\n  });\n});\n"]}