{"version":3,"file":"UserActionRow.test.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/UserActionRow.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport {assertScreenshot, renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\nimport {\n  describeWithEnvironment,\n} from '../../../testing/EnvironmentHelpers.js';\nimport {createViewFunctionStub, type ViewFunctionStub} from '../../../testing/ViewFunctionHelpers.js';\nimport * as AiAssistance from '../ai_assistance.js';\n\ndescribeWithEnvironment('UserActionRow', () => {\n  function createComponent(props: AiAssistance.UserActionRow.UserActionRowWidgetParams):\n      [ViewFunctionStub<typeof AiAssistance.UserActionRow.UserActionRow>, AiAssistance.UserActionRow.UserActionRow] {\n    const view = createViewFunctionStub(AiAssistance.UserActionRow.UserActionRow);\n    const component = new AiAssistance.UserActionRow.UserActionRow(undefined, view);\n    Object.assign(component, props);\n    component.wasShown();\n    return [view, component];\n  }\n\n  it('should show the feedback form when canShowFeedbackForm is true', async () => {\n    const [view] = createComponent({\n      showRateButtons: true,\n      canShowFeedbackForm: true,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.isShowingFeedbackForm).equals(false);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n    {\n      expect(view.input.isShowingFeedbackForm).equals(true);\n    }\n  });\n\n  it('should not show the feedback form when canShowFeedbackForm is false', async () => {\n    const [view] = createComponent({\n      showRateButtons: true,\n      canShowFeedbackForm: false,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.isShowingFeedbackForm).equals(false);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n    {\n      expect(view.input.isShowingFeedbackForm).equals(false);\n    }\n  });\n\n  it('should disable the submit button when the input is empty', async () => {\n    const [view] = createComponent({\n      showRateButtons: true,\n      canShowFeedbackForm: true,\n      onSuggestionClick: sinon.stub(),\n      onCopyResponseClick: sinon.stub(),\n      onFeedbackSubmit: sinon.stub(),\n    });\n\n    sinon.assert.callCount(view, 1);\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(true);\n      view.input.onRatingClick(Host.AidaClient.Rating.POSITIVE);\n    }\n\n    sinon.assert.callCount(view, 2);\n\n    {\n      expect(view.input.isShowingFeedbackForm).equals(true);\n      view.input.onInputChange('test');\n    }\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(false);\n      view.input.onSubmit(new SubmitEvent('submit'));\n    }\n\n    {\n      expect(view.input.isSubmitButtonDisabled).equals(true);\n    }\n  });\n\n  describe('view', () => {\n    it('looks fine', async () => {\n      const target = document.createElement('div');\n      renderElementIntoDOM(target);\n      AiAssistance.UserActionRow.DEFAULT_VIEW(\n          {\n            onRatingClick: () => {},\n            onReportClick: () => {},\n            onCopyResponseClick: () => {},\n            scrollSuggestionsScrollContainer: () => {},\n            onSuggestionsScrollOrResize: () => {},\n            onSuggestionClick: () => {},\n            onSubmit: () => {},\n            onClose: () => {},\n            onInputChange: () => {},\n            showRateButtons: true,\n            isSubmitButtonDisabled: false,\n            isShowingFeedbackForm: true,\n          },\n          {}, target);\n      await assertScreenshot('ai_assistance/user_action_row.png');\n    });\n  });\n});\n"]}