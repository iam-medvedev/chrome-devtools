{"version":3,"file":"UserActionRow.js","sourceRoot":"","sources":["../../../../../../../front_end/panels/ai_assistance/components/UserActionRow.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../../core/common/common.js';\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport type * as Platform from '../../../core/platform/platform.js';\nimport * as Buttons from '../../../ui/components/buttons/buttons.js';\nimport * as Input from '../../../ui/components/input/input.js';\nimport * as UI from '../../../ui/legacy/legacy.js';\nimport * as Lit from '../../../ui/lit/lit.js';\nimport * as VisualLogging from '../../../ui/visual_logging/visual_logging.js';\n\nimport userActionRowStyles from './userActionRow.css.js';\n\nconst {html} = Lit;\n\n/*\n* Strings that don't need to be translated at this time.\n*/\nconst UIStringsNotTranslate = {\n\n  /**\n   * @description The title of the button that allows submitting positive\n   * feedback about the response for AI assistance.\n   */\n  thumbsUp: 'Good response',\n  /**\n   * @description The title of the button that allows submitting negative\n   * feedback about the response for AI assistance.\n   */\n  thumbsDown: 'Bad response',\n  /**\n   * @description The placeholder text for the feedback input.\n   */\n  provideFeedbackPlaceholder: 'Provide additional feedback',\n  /**\n   * @description The disclaimer text that tells the user what will be shared\n   * and what will be stored.\n   */\n  disclaimer: 'Submitted feedback will also include your conversation',\n  /**\n   * @description The button text for the action of submitting feedback.\n   */\n  submit: 'Submit',\n  /**\n   * @description The header of the feedback form asking.\n   */\n  whyThisRating: 'Why did you choose this rating? (optional)',\n  /**\n   * @description The button text for the action that hides the feedback form.\n   */\n  close: 'Close',\n  /**\n   * @description The title of the button that opens a page to report a legal\n   * issue with the AI assistance message.\n   */\n  report: 'Report legal issue',\n  /**\n   * @description The title of the button for scrolling to see next suggestions\n   */\n  scrollToNext: 'Scroll to next suggestions',\n  /**\n   * @description The title of the button for scrolling to see previous suggestions\n   */\n  scrollToPrevious: 'Scroll to previous suggestions',\n} as const;\n\nconst lockedString = i18n.i18n.lockedString;\n\nconst REPORT_URL = 'https://support.google.com/legal/troubleshooter/1114905?hl=en#ts=1115658%2C13380504' as\n    Platform.DevToolsPath.UrlString;\nconst SCROLL_ROUNDING_OFFSET = 1;\n\nexport interface RatingViewInput {\n  currentRating?: Host.AidaClient.Rating;\n  onRatingClick: (rating: Host.AidaClient.Rating) => void;\n  showRateButtons: boolean;\n  onReportClick: () => void;\n}\n\nexport interface SuggestionViewInput {\n  suggestions?: [string, ...string[]];\n  scrollSuggestionsScrollContainer: (direction: 'left'|'right') => void;\n  onSuggestionsScrollOrResize: () => void;\n  onSuggestionClick: (suggestion: string) => void;\n}\n\nexport interface FeedbackFormViewInput {\n  isShowingFeedbackForm: boolean;\n  onSubmit: (event: SubmitEvent) => void;\n  onClose: () => void;\n  onInputChange: (input: string) => void;\n  isSubmitButtonDisabled: boolean;\n}\n\nexport type UserActionRowViewInput = RatingViewInput&SuggestionViewInput&FeedbackFormViewInput;\n\nexport interface ViewOutput {\n  suggestionsLeftScrollButtonContainer?: Element;\n  suggestionsScrollContainer?: Element;\n  suggestionsRightScrollButtonContainer?: Element;\n}\n\nexport interface UserActionRowWidgetParams {\n  showRateButtons: boolean;\n  onFeedbackSubmit: (rate: Host.AidaClient.Rating, feedback?: string) => void;\n  suggestions?: [string, ...string[]];\n  onSuggestionClick: (suggestion: string) => void;\n  canShowFeedbackForm: boolean;\n}\n\nexport type View = (input: UserActionRowViewInput, output: ViewOutput, target: HTMLElement) => void;\n\n/**\n * This presenter has too many responsibilities (rating buttons, feedback\n * form, suggestions).\n */\nexport class UserActionRow extends UI.Widget.Widget implements UserActionRowWidgetParams {\n  showRateButtons = false;\n  onFeedbackSubmit: (rate: Host.AidaClient.Rating, feedback?: string) => void = () => {};\n  suggestions: [string, ...string[]]|undefined;\n  onSuggestionClick: (suggestion: string) => void = () => {};\n  canShowFeedbackForm = false;\n\n  #suggestionsResizeObserver = new ResizeObserver(() => this.#handleSuggestionsScrollOrResize());\n  #suggestionsEvaluateLayoutThrottler = new Common.Throttler.Throttler(50);\n\n  #feedbackValue = '';\n  #currentRating: Host.AidaClient.Rating|undefined;\n  #isShowingFeedbackForm = false;\n  #isSubmitButtonDisabled = false;\n\n  #view: View;\n  #viewOutput: ViewOutput = {};\n\n  constructor(element?: HTMLElement, view?: View) {\n    super(false, false, element);\n    this.registerRequiredCSS(Input.textInputStylesRaw);\n    this.registerRequiredCSS(userActionRowStyles);\n    // clang-format off\n    this.#view = view ?? ((input, output, target) => {\n      Lit.render(\n        html`\n          <div class=\"ai-assistance-feedback-row\">\n            ${renderButtons(input)}\n            ${renderSuggestions(input, output)}\n          </div>\n          ${renderFeedbackForm(input)}\n        `,\n        target,\n        {host: target}\n      );\n    }) as View;\n    // clang-format on\n  }\n\n  override wasShown(): void {\n    super.wasShown();\n    void this.performUpdate();\n    this.#evaluateSuggestionsLayout();\n\n    if (this.#viewOutput.suggestionsScrollContainer) {\n      this.#suggestionsResizeObserver.observe(this.#viewOutput.suggestionsScrollContainer);\n    }\n  }\n\n  override performUpdate(): Promise<void>|void {\n    this.#view(\n        {\n          onSuggestionClick: this.onSuggestionClick,\n          onRatingClick: this.#handleRateClick.bind(this),\n          onReportClick: () => Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(REPORT_URL),\n          scrollSuggestionsScrollContainer: this.#scrollSuggestionsScrollContainer.bind(this),\n          onSuggestionsScrollOrResize: this.#handleSuggestionsScrollOrResize.bind(this),\n          onSubmit: this.#handleSubmit.bind(this),\n          onClose: this.#handleClose.bind(this),\n          onInputChange: this.#handleInputChange.bind(this),\n          isSubmitButtonDisabled: this.#isSubmitButtonDisabled,\n          showRateButtons: this.showRateButtons,\n          suggestions: this.suggestions,\n          currentRating: this.#currentRating,\n          isShowingFeedbackForm: this.#isShowingFeedbackForm,\n        },\n        this.#viewOutput, this.contentElement);\n  }\n\n  #handleInputChange(value: string): void {\n    this.#feedbackValue = value;\n    const disableSubmit = !value;\n    if (disableSubmit !== this.#isSubmitButtonDisabled) {\n      this.#isSubmitButtonDisabled = disableSubmit;\n      void this.performUpdate();\n    }\n  }\n\n  #evaluateSuggestionsLayout = (): void => {\n    const suggestionsScrollContainer = this.#viewOutput.suggestionsScrollContainer;\n    const leftScrollButtonContainer = this.#viewOutput.suggestionsLeftScrollButtonContainer;\n    const rightScrollButtonContainer = this.#viewOutput.suggestionsRightScrollButtonContainer;\n    if (!suggestionsScrollContainer || !leftScrollButtonContainer || !rightScrollButtonContainer) {\n      return;\n    }\n\n    const shouldShowLeftButton = suggestionsScrollContainer.scrollLeft > SCROLL_ROUNDING_OFFSET;\n    const shouldShowRightButton = suggestionsScrollContainer.scrollLeft +\n            (suggestionsScrollContainer as HTMLElement).offsetWidth + SCROLL_ROUNDING_OFFSET <\n        suggestionsScrollContainer.scrollWidth;\n    leftScrollButtonContainer.classList.toggle('hidden', !shouldShowLeftButton);\n    rightScrollButtonContainer.classList.toggle('hidden', !shouldShowRightButton);\n  };\n\n  disconnectedCallback(): void {\n    this.#suggestionsResizeObserver.disconnect();\n  }\n\n  #handleSuggestionsScrollOrResize(): void {\n    void this.#suggestionsEvaluateLayoutThrottler.schedule(() => {\n      this.#evaluateSuggestionsLayout();\n      return Promise.resolve();\n    });\n  }\n\n  #scrollSuggestionsScrollContainer(direction: 'left'|'right'): void {\n    const suggestionsScrollContainer = this.#viewOutput.suggestionsScrollContainer;\n    if (!suggestionsScrollContainer) {\n      return;\n    }\n\n    suggestionsScrollContainer.scroll({\n      top: 0,\n      left: direction === 'left' ? suggestionsScrollContainer.scrollLeft - suggestionsScrollContainer.clientWidth :\n                                   suggestionsScrollContainer.scrollLeft + suggestionsScrollContainer.clientWidth,\n      behavior: 'smooth',\n    });\n  }\n\n  #handleRateClick(rating: Host.AidaClient.Rating): void {\n    if (this.#currentRating === rating) {\n      this.#currentRating = undefined;\n      this.#isShowingFeedbackForm = false;\n      this.#isSubmitButtonDisabled = true;\n      // This effectively reset the user rating\n      this.onFeedbackSubmit(Host.AidaClient.Rating.SENTIMENT_UNSPECIFIED);\n      void this.performUpdate();\n      return;\n    }\n\n    this.#currentRating = rating;\n    this.#isShowingFeedbackForm = this.canShowFeedbackForm;\n    this.onFeedbackSubmit(rating);\n    void this.performUpdate();\n  }\n\n  #handleClose(): void {\n    this.#isShowingFeedbackForm = false;\n    this.#isSubmitButtonDisabled = true;\n    void this.performUpdate();\n  }\n\n  #handleSubmit(ev: SubmitEvent): void {\n    ev.preventDefault();\n    const input = this.#feedbackValue;\n    if (!this.#currentRating || !input) {\n      return;\n    }\n    this.onFeedbackSubmit(this.#currentRating, input);\n    this.#isShowingFeedbackForm = false;\n    this.#isSubmitButtonDisabled = true;\n    void this.performUpdate();\n  }\n}\n\nfunction renderButtons({currentRating, showRateButtons, onRatingClick, onReportClick}: RatingViewInput):\n    Lit.LitTemplate {\n  // clang-format off\n  const rateButtons = html`\n    <devtools-button\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'thumb-up',\n          toggledIconName: 'thumb-up-filled',\n          toggled: currentRating === Host.AidaClient.Rating.POSITIVE,\n          toggleType: Buttons.Button.ToggleType.PRIMARY,\n          title: lockedString(UIStringsNotTranslate.thumbsUp),\n          jslogContext: 'thumbs-up',\n        } as Buttons.Button.ButtonData}\n        @click=${() => onRatingClick(Host.AidaClient.Rating.POSITIVE)}\n      ></devtools-button>\n      <devtools-button\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'thumb-down',\n          toggledIconName: 'thumb-down-filled',\n          toggled: currentRating === Host.AidaClient.Rating.NEGATIVE,\n          toggleType: Buttons.Button.ToggleType.PRIMARY,\n          title: lockedString(UIStringsNotTranslate.thumbsDown),\n          jslogContext: 'thumbs-down',\n        } as Buttons.Button.ButtonData}\n        @click=${() => onRatingClick(Host.AidaClient.Rating.NEGATIVE)}\n      ></devtools-button>\n      <div class=\"vertical-separator\"></div>`;\n  // clang-format off\n\n  // clang-format off\n  return html`\n  <div class=\"rate-buttons\">\n    ${showRateButtons ? rateButtons : Lit.nothing}\n    <devtools-button\n      .data=${\n        {\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          title: lockedString(UIStringsNotTranslate.report),\n          iconName: 'report',\n          jslogContext: 'report',\n        } as Buttons.Button.ButtonData\n      }\n      @click=${onReportClick}\n    ></devtools-button>\n  </div>`;\n  // clang-format on\n}\n\nfunction renderSuggestions(\n    {suggestions, scrollSuggestionsScrollContainer, onSuggestionClick, onSuggestionsScrollOrResize}:\n        SuggestionViewInput, output: ViewOutput): Lit.LitTemplate {\n  if (!suggestions) {\n    return Lit.nothing;\n  }\n  // clang-format off\n  return html`<div class=\"suggestions-container\">\n    <div class=\"scroll-button-container left hidden\" ${Lit.Directives.ref(element => { output.suggestionsLeftScrollButtonContainer = element; } )}>\n      <devtools-button\n        class='scroll-button'\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'chevron-left',\n          title: lockedString(UIStringsNotTranslate.scrollToPrevious),\n          jslogContext: 'chevron-left',\n        } as Buttons.Button.ButtonData}\n        @click=${() => scrollSuggestionsScrollContainer('left')}\n      ></devtools-button>\n    </div>\n    <div class=\"suggestions-scroll-container\" @scroll=${onSuggestionsScrollOrResize} ${Lit.Directives.ref(element => { output.suggestionsScrollContainer = element; })}>\n      ${suggestions.map(suggestion => html`<devtools-button\n        class='suggestion'\n        .data=${{\n          variant: Buttons.Button.Variant.OUTLINED,\n          title: suggestion,\n          jslogContext: 'suggestion',\n        } as Buttons.Button.ButtonData}\n        @click=${() => onSuggestionClick(suggestion)}\n      >${suggestion}</devtools-button>`)}\n    </div>\n    <div class=\"scroll-button-container right hidden\" ${Lit.Directives.ref(element => { output.suggestionsRightScrollButtonContainer = element; })}>\n      <devtools-button\n        class='scroll-button'\n        .data=${{\n          variant: Buttons.Button.Variant.ICON,\n          size: Buttons.Button.Size.SMALL,\n          iconName: 'chevron-right',\n          title: lockedString(UIStringsNotTranslate.scrollToNext),\n          jslogContext: 'chevron-right',\n        } as Buttons.Button.ButtonData}\n        @click=${() => scrollSuggestionsScrollContainer('right')}\n      ></devtools-button>\n    </div>\n  </div>`;\n  // clang-format on\n}\n\nfunction renderFeedbackForm({isShowingFeedbackForm, isSubmitButtonDisabled, onSubmit, onClose, onInputChange}:\n                                FeedbackFormViewInput): Lit.LitTemplate {\n  if (!isShowingFeedbackForm) {\n    return Lit.nothing;\n  }\n\n  // clang-format off\n  return html`\n    <form class=\"feedback-form\" @submit=${onSubmit}>\n      <div class=\"feedback-header\">\n        <h4 class=\"feedback-title\">${lockedString(\n            UIStringsNotTranslate.whyThisRating,\n        )}</h4>\n        <devtools-button\n          aria-label=${lockedString(UIStringsNotTranslate.close)}\n          @click=${onClose}\n          .data=${\n            {\n              variant: Buttons.Button.Variant.ICON,\n              iconName: 'cross',\n              size: Buttons.Button.Size.SMALL,\n              title: lockedString(UIStringsNotTranslate.close),\n              jslogContext: 'close',\n            } as Buttons.Button.ButtonData\n          }\n        ></devtools-button>\n      </div>\n      <input\n        type=\"text\"\n        class=\"devtools-text-input feedback-input\"\n        @input=${(event: KeyboardEvent) => onInputChange((event.target as HTMLInputElement).value)}\n        placeholder=${lockedString(\n         UIStringsNotTranslate.provideFeedbackPlaceholder,\n        )}\n        jslog=${VisualLogging.textField('feedback').track({ keydown: 'Enter' })}\n      >\n      <span class=\"feedback-disclaimer\">${\n        lockedString(UIStringsNotTranslate.disclaimer)\n      }</span>\n      <div>\n        <devtools-button\n        aria-label=${lockedString(UIStringsNotTranslate.submit)}\n        .data=${\n          {\n              type: 'submit',\n              disabled: isSubmitButtonDisabled,\n              variant: Buttons.Button.Variant.OUTLINED,\n              size: Buttons.Button.Size.SMALL,\n              title: lockedString(UIStringsNotTranslate.submit),\n              jslogContext: 'send',\n            } as Buttons.Button.ButtonData\n          }\n        >${\n          lockedString(UIStringsNotTranslate.submit)\n        }</devtools-button>\n      </div>\n    </div>\n  </form>\n  `;\n  // clang-format on\n}\n"]}