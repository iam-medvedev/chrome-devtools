{"version":3,"file":"CodeBlock.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/markdown_view/CodeBlock.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../core/host/host.js';\nimport * as i18n from '../../../core/i18n/i18n.js';\nimport * as ComponentHelpers from '../../components/helpers/helpers.js';\nimport * as IconButton from '../../components/icon_button/icon_button.js';\nimport * as LitHtml from '../../lit-html/lit-html.js';\n\nimport styles from './codeBlock.css.js';\n\nconst UIStrings = {\n  /**\n   * @description The title of the button to copy the codeblock from a Markdown view.\n   */\n  copy: 'Copy code',\n  /**\n   * @description The title of the button after it was pressed and the text was copied to clipboard.\n   */\n  copied: 'Copied to clipboard',\n};\nconst str_ = i18n.i18n.registerUIStrings('ui/components/markdown_view/CodeBlock.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\n\nexport class CodeBlock extends HTMLElement {\n  static readonly litTagName = LitHtml.literal`devtools-code-block`;\n\n  readonly #shadow = this.attachShadow({mode: 'open'});\n\n  #code = '';\n  #codeLang = '';\n  #copyTimeout = 1000;\n  #timer?: ReturnType<typeof setTimeout>;\n  #copied = false;\n\n  connectedCallback(): void {\n    this.#shadow.adoptedStyleSheets = [styles];\n    this.#render();\n  }\n\n  set code(value: string) {\n    this.#code = value;\n    this.#render();\n  }\n\n  get code(): string {\n    return this.#code;\n  }\n\n  set codeLang(value: string) {\n    this.#codeLang = value;\n    this.#render();\n  }\n\n  set timeout(value: number) {\n    this.#copyTimeout = value;\n    this.#render();\n  }\n\n  #onCopy(): void {\n    Host.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(this.#code);\n    this.#copied = true;\n    this.#render();\n    clearTimeout(this.#timer);\n    this.#timer = setTimeout(() => {\n      this.#copied = false;\n      this.#render();\n    }, this.#copyTimeout);\n  }\n\n  #render(): void {\n    const copyButtonClasses = LitHtml.Directives.classMap({\n      copied: this.#copied,\n      'copy-button': true,\n    });\n    // clang-format off\n    LitHtml.render(LitHtml.html`<div class=\"codeblock\">\n      <div class=\"toolbar\">\n        <div class=\"lang\">${this.#codeLang}</div>\n        <div class=\"copy\">\n          <button class=${copyButtonClasses}\n            title=${i18nString(UIStrings.copy)}\n            @click=${this.#onCopy}>\n            <${IconButton.Icon.Icon.litTagName}\n              .data=${{\n                iconName: 'copy',\n                width: '16px',\n                height: '16px',\n                color: 'var(--copy-icon-color, var(--icon-default))',\n              } as IconButton.Icon.IconData}\n            >\n            </${IconButton.Icon.Icon.litTagName}>\n            <span>${this.#copied ?\n              i18nString(UIStrings.copied) :\n              i18nString(UIStrings.copy)}</span>\n          </button>\n        </div>\n      </div>\n      <code>${this.#code}</code>\n    </div>`, this.#shadow, {\n      host: this,\n    });\n    // clang-format one\n  }\n}\n\nComponentHelpers.CustomElements.defineComponent('devtools-code-block', CodeBlock);\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  interface HTMLElementTagNameMap {\n    'devtools-code-block': CodeBlock;\n  }\n}\n"]}