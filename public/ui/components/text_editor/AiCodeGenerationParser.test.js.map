{"version":3,"file":"AiCodeGenerationParser.test.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/text_editor/AiCodeGenerationParser.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as CodeMirror from '../../../third_party/codemirror.next/codemirror.next.js';\n\nimport {AiCodeGenerationParser, TextEditor} from './text_editor.js';\n\ndescribe('AiCodeGenerationParser', () => {\n  function createEditor(doc: string) {\n    const editor = new TextEditor.TextEditor(\n        CodeMirror.EditorState.create({\n          doc,\n          extensions: [\n            CodeMirror.javascript.javascriptLanguage,\n          ],\n        }),\n    );\n    return editor;\n  }\n\n  describe('extractCommentText', () => {\n    it('extracts text from a single-line comment', () => {\n      const code = '// This is a test comment';\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.strictEqual(result?.text, 'This is a test comment');\n    });\n\n    it('extracts text from a single-line comment even with trailing whitespace', () => {\n      const code = '// Spaced comment  \\t ';\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.strictEqual(result?.text, 'Spaced comment');\n    });\n\n    it('extracts text from a block comment', () => {\n      const code = '/* Simple block */';\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.strictEqual(result?.text, 'Simple block');\n      assert.strictEqual(result?.to, code.length);\n    });\n\n    it('extracts text from a block comment if cursor in middle of the block', () => {\n      const code = '/* Simple block */';\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, 5);\n      assert.strictEqual(result?.text, 'Simple block');\n      assert.strictEqual(result?.to, code.length);\n    });\n\n    it('cleans up multi-line block comments with leading asterisks', () => {\n      const code = `/**\n    * First line\n    * Second line\n    */`;\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.strictEqual(result?.text, 'First line\\nSecond line');\n    });\n\n    it('returns undefined if the cursor is not at a comment', () => {\n      const code = 'const x = 10;';\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.isUndefined(result);\n    });\n\n    it('handles unclosed block comments by returning undefined (syntax error)', () => {\n      const code = `/**\n* This is never closed`;\n      const editor = createEditor(code);\n      const result = AiCodeGenerationParser.AiCodeGenerationParser.extractCommentNodeInfo(editor.state, code.length);\n      assert.isUndefined(result);\n    });\n  });\n});\n"]}