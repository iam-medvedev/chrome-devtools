{"version":3,"file":"MarkupHighlight.test.js","sourceRoot":"","sources":["../../../../../../../front_end/ui/components/highlighting/MarkupHighlight.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as TextUtils from '../../../models/text_utils/text_utils.js';\nimport {renderElementIntoDOM} from '../../../testing/DOMHelpers.js';\n\nimport * as Highlighting from './highlighting.js';\n\ndescribe('MarkupHighlight', () => {\n  let container: HTMLDivElement;\n\n  beforeEach(() => {\n    container = document.createElement('div');\n    renderElementIntoDOM(container);\n  });\n\n  function range(offset: number, length: number): TextUtils.TextRange.SourceRange {\n    return new TextUtils.TextRange.SourceRange(offset, length);\n  }\n\n  function performTest(innerHTML: string[], ranges: TextUtils.TextRange.SourceRange[], expectedHighlighted: string[]) {\n    const element = document.createElement('div');\n    element.innerHTML = innerHTML.join('');\n    container.appendChild(element);\n\n    const initialHTML = element.innerHTML;\n    const initialText = element.textContent || '';\n    const changes: Highlighting.HighlightChange[] = [];\n    Highlighting.highlightRangesWithStyleClass(element, ranges, 'highlighted', changes);\n    assert.strictEqual(element.innerHTML, expectedHighlighted.join(''), 'After highlight');\n    Highlighting.revertDomChanges(changes);\n    assert.strictEqual(element.innerHTML, initialHTML, 'After revert');\n    assert.strictEqual(element.textContent, initialText, 'After revert');\n  }\n\n  it('highlights whole text node', () => {\n    performTest(['function'], [range(0, 8)], ['<span class=\"highlighted\">function</span>']);\n  });\n\n  it('highlights only text node beginning', () => {\n    performTest(['function'], [range(0, 7)], ['<span class=\"highlighted\">functio</span>n']);\n  });\n\n  it('highlights only text node ending', () => {\n    performTest(['function'], [range(1, 7)], ['f<span class=\"highlighted\">unction</span>']);\n  });\n\n  it('highlights in the middle of text node', () => {\n    performTest(['function'], [range(1, 6)], ['f<span class=\"highlighted\">unctio</span>n']);\n  });\n\n  it('highlights all text in 3 text nodes', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'], [range(0, 21)],\n        ['<span><span class=\"highlighted\">function functionName</span></span>', '<span></span>', '<span></span>']);\n  });\n\n  it('highlights all text in 3 text nodes except for the last character', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'], [range(0, 20)],\n        ['<span><span class=\"highlighted\">function functionNam</span></span>', '<span></span>', '<span>e</span>']);\n  });\n\n  it('highlights all text in 3 text nodes except for the first character', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'], [range(1, 20)],\n        ['<span>f<span class=\"highlighted\">unction functionName</span></span>', '<span></span>', '<span></span>']);\n  });\n\n  it('highlights all text in 3 text nodes except for the first and the last characters', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'], [range(1, 19)],\n        ['<span>f<span class=\"highlighted\">unction functionNam</span></span>', '<span></span>', '<span>e</span>']);\n  });\n\n  it('highlights across nodes', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'], [range(7, 3)],\n        ['<span>functio<span class=\"highlighted\">n f</span></span>', '<span></span>', '<span>unctionName</span>']);\n  });\n\n  it('highlights first characters in text nodes', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'],\n        [range(0, 1), range(8, 1), range(9, 1)], [\n          '<span><span class=\"highlighted\">f</span>unction</span>',  //\n          '<span><span class=\"highlighted\"> </span></span>',\n          '<span><span class=\"highlighted\">f</span>unctionName</span>'\n        ]);\n  });\n\n  it('highlights last characters in text node', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'],\n        [range(7, 1), range(8, 1), range(20, 1)], [\n          '<span>functio<span class=\"highlighted\">n</span></span>',  //\n          '<span><span class=\"highlighted\"> </span></span>',\n          '<span>functionNam<span class=\"highlighted\">e</span></span>'\n        ]);\n  });\n\n  it('highlights across nodes with first and last characters', () => {\n    performTest(\n        ['<span>function</span>', '<span> </span>', '<span>functionName</span>'],\n        [range(0, 1), range(7, 3), range(20, 1)], [\n          '<span><span class=\"highlighted\">f</span>unctio<span class=\"highlighted\">n f</span></span>',  //\n          '<span></span>',                                                                              //\n          '<span>unctionNam<span class=\"highlighted\">e</span></span>'\n        ]);\n  });\n});\n"]}