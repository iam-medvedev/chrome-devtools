{"version":3,"file":"LoggingDriver.test.js","sourceRoot":"","sources":["../../../../../../front_end/ui/visual_logging/LoggingDriver.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {renderElementIntoDOM} from '../../../test/unittests/front_end/helpers/DOMHelpers.js';\nimport {stabilizeEvent, stabilizeImpressions} from '../../../test/unittests/front_end/helpers/VisualLoggingHelpers.js';\nimport * as Common from '../../core/common/common.js';\nimport * as Host from '../../core/host/host.js';\nimport {assertNotNullOrUndefined} from '../../core/platform/platform.js';\n\nimport * as VisualLoggingTesting from './visual_logging-testing.js';\n\nconst {assert} = chai;\n\ndescribe('LoggingDriver', () => {\n  let recordImpression: sinon.SinonStub;\n  let throttler: Common.Throttler.Throttler;\n\n  beforeEach(() => {\n    throttler = new Common.Throttler.Throttler(1000000000);\n    recordImpression = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordImpression',\n    );\n  });\n\n  afterEach(() => {\n    VisualLoggingTesting.LoggingDriver.stopLogging();\n  });\n\n  function addLoggableElements() {\n    const parent = document.createElement('div') as HTMLElement;\n    parent.id = 'parent';\n    parent.setAttribute('jslog', 'TreeItem; track: hover');\n    parent.style.width = '300px';\n    parent.style.height = '300px';\n    const element = document.createElement('div') as HTMLElement;\n    element.id = 'element';\n    element.setAttribute('jslog', 'TreeItem; context:42; track: click, keydown, hover, drag, resize');\n    element.style.width = '300px';\n    element.style.height = '300px';\n    parent.appendChild(element);\n    renderElementIntoDOM(parent);\n  }\n\n  it('logs impressions on startLogging', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging();\n    assert.isTrue(recordImpression.calledOnce);\n    assert.sameDeepMembers(stabilizeImpressions(recordImpression.firstCall.firstArg.impressions), [\n      {id: 1, type: 1, context: 42, parent: 0, 'width': 300, 'height': 300},\n      {id: 0, type: 1, 'width': 300, 'height': 300},\n    ]);\n  });\n\n  async function assertImpressionRecordedDeferred() {\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.isFalse(recordImpression.called);\n\n    assert.exists(throttler.process);\n    await throttler.process?.();\n    assert.isTrue(recordImpression.called);\n  }\n\n  it('does not log impressions when hidden', async () => {\n    addLoggableElements();\n    sinon.stub(document, 'hidden').value(true);\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n    assert.isFalse(recordImpression.called);\n  });\n\n  it('logs impressions when visibility changes', async () => {\n    let hidden = true;\n    addLoggableElements();\n    sinon.stub(document, 'hidden').get(() => hidden);\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n\n    hidden = false;\n    const event = document.createEvent('Event');\n    event.initEvent('visibilitychange', true, true);\n    document.dispatchEvent(event);\n\n    await assertImpressionRecordedDeferred();\n  });\n\n  it('logs impressions on scroll', async () => {\n    addLoggableElements();\n    const parent = document.getElementById('parent') as HTMLElement;\n    parent.style.marginTop = '2000px';\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n\n    let scrollendPromise = new Promise(resolve => window.addEventListener('scrollend', resolve, {once: true}));\n    window.scrollTo({\n      top: 2000,\n      left: 0,\n      behavior: 'instant',\n    });\n    await scrollendPromise;\n    await assertImpressionRecordedDeferred();\n\n    scrollendPromise = new Promise(resolve => window.addEventListener('scrollend', resolve, {once: true}));\n    window.scrollTo({\n      top: 0,\n      left: 0,\n      behavior: 'instant',\n    });\n    await scrollendPromise;\n  });\n\n  it('logs impressions on mutation', async () => {\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n    addLoggableElements();\n    await assertImpressionRecordedDeferred();\n  });\n\n  it('logs impressions on mutation in shadow DOM', async () => {\n    const parent = document.createElement('div') as HTMLElement;\n    renderElementIntoDOM(parent);\n    const shadow = parent.attachShadow({mode: 'open'});\n    const shadowContent = document.createElement('div');\n    shadow.appendChild(shadowContent);\n\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n    shadowContent.innerHTML = '<div jslog=\"TreeItem\" style=\"width:300px;height:300px\"></div>';\n    await assertImpressionRecordedDeferred();\n  });\n\n  it('logs impressions on mutation in additional document', async () => {\n    const iframe = document.createElement('iframe') as HTMLIFrameElement;\n    renderElementIntoDOM(iframe);\n\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n    const iframeDocument = iframe.contentDocument;\n    assertNotNullOrUndefined(iframeDocument);\n    await VisualLoggingTesting.LoggingDriver.addDocument(iframeDocument);\n    iframeDocument.body.innerHTML = '<div jslog=\"TreeItem\" style=\"width:300px;height:300px\"></div>';\n    await assertImpressionRecordedDeferred();\n  });\n\n  it('correctly determines visiblity in additional document', async () => {\n    const iframe = document.createElement('iframe') as HTMLIFrameElement;\n    renderElementIntoDOM(iframe);\n    iframe.style.width = '100px';\n    iframe.style.height = '100px';\n    iframe.width = '100';\n    iframe.height = '100';\n    const iframeDocument = iframe.contentDocument;\n    assertNotNullOrUndefined(iframeDocument);\n    iframeDocument.body.innerHTML =  // Second div should not be out of viewport and not logged\n        `<div style=\"width:150px;height:150px\"></div>\n         <div jslog=\"TreeItem\" style=\"width:150px;height:150px\"></div>`;\n\n    await VisualLoggingTesting.LoggingDriver.startLogging({processingThrottler: throttler});\n    await VisualLoggingTesting.LoggingDriver.addDocument(iframeDocument);\n    assert.isFalse(recordImpression.called);\n  });\n\n  it('logs clicks', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging();\n    const recordClick = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordClick',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.click();\n\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.isTrue(recordClick.calledOnce);\n  });\n\n  it('does not log clicks if not configured', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging();\n    const recordClick = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordClick',\n    );\n\n    const parent = document.getElementById('parent') as HTMLElement;\n    parent.click();\n\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.isFalse(recordClick.called);\n  });\n\n  it('does not log click on double click', async () => {\n    const clickLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    const element = document.getElementById('element') as HTMLElement;\n    element.setAttribute('jslog', 'TreeItem; context:42; track: click, dblclick');\n    await VisualLoggingTesting.LoggingDriver.startLogging({clickLogThrottler});\n    const recordClick = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordClick',\n    );\n\n    element.dispatchEvent(new MouseEvent('click'));\n    element.dispatchEvent(new MouseEvent('dblclick'));\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.exists(clickLogThrottler.process);\n    assert.isFalse(recordClick.called);\n\n    await clickLogThrottler.process?.();\n    assert.isTrue(recordClick.calledOnce);\n    assert.deepStrictEqual(\n        stabilizeEvent(recordClick.firstCall.firstArg), {veid: 0, context: 42, mouseButton: 0, doubleClick: true});\n  });\n\n  it('does not log click on parent when clicked on child', async () => {\n    const clickLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    const parent = document.getElementById('parent') as HTMLElement;\n    parent.setAttribute('jslog', 'TreeItem; track: click');\n    await VisualLoggingTesting.LoggingDriver.startLogging({clickLogThrottler});\n    const recordClick = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordClick',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.click();\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.exists(clickLogThrottler.process);\n    assert.isFalse(recordClick.called);\n\n    await clickLogThrottler.process?.();\n    assert.isTrue(recordClick.calledOnce);\n    assert.deepStrictEqual(\n        stabilizeEvent(recordClick.firstCall.firstArg), {veid: 0, context: 42, mouseButton: 0, doubleClick: false});\n  });\n\n  it('logs keydown', async () => {\n    const keyboardLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({keyboardLogThrottler});\n    const recordKeyDown = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordKeyDown',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.dispatchEvent(new KeyboardEvent('keydown', {'key': 'a'}));\n    element.dispatchEvent(new KeyboardEvent('keydown', {'key': 'b'}));\n    await new Promise(resolve => setTimeout(resolve, 0));\n    assert.exists(keyboardLogThrottler.process);\n    assert.isFalse(recordKeyDown.called);\n\n    await keyboardLogThrottler.process?.();\n    assert.isTrue(recordKeyDown.calledOnce);\n  });\n\n  it('logs hover', async () => {\n    const hoverLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({hoverLogThrottler});\n    const recordHover = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordHover',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.dispatchEvent(new MouseEvent('mouseover'));\n    assert.exists(hoverLogThrottler.process);\n    assert.isFalse(recordHover.called);\n\n    await hoverLogThrottler.process?.();\n    assert.isTrue(recordHover.calledOnce);\n  });\n\n  it('does not log hover if too short', async () => {\n    const hoverLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({hoverLogThrottler});\n    const recordHover = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordHover',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.dispatchEvent(new MouseEvent('mouseover'));\n    assert.exists(hoverLogThrottler.process);\n    assert.isFalse(recordHover.called);\n\n    element.dispatchEvent(new MouseEvent('mouseout'));\n\n    await hoverLogThrottler.process?.();\n    assert.isFalse(recordHover.called);\n  });\n\n  it('does not log hover if in descendent', async () => {\n    const hoverLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({hoverLogThrottler});\n    const recordHover = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordHover',\n    );\n\n    const parent = document.getElementById('parent') as HTMLElement;\n    const element = document.getElementById('element') as HTMLElement;\n    parent.dispatchEvent(new MouseEvent('mouseover'));\n    assert.exists(hoverLogThrottler.process);\n    assert.isFalse(recordHover.called);\n\n    element.dispatchEvent(new MouseEvent('mouseover'));\n\n    await hoverLogThrottler.process?.();\n    assert.isTrue(recordHover.called);\n    assert.deepStrictEqual(stabilizeEvent(recordHover.firstCall.firstArg), {veid: 0, context: 42});\n  });\n\n  it('logs drag', async () => {\n    const dragLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({dragLogThrottler});\n    const recordDrag = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordDrag',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.dispatchEvent(new MouseEvent('pointerdown'));\n    assert.exists(dragLogThrottler.process);\n    assert.isFalse(recordDrag.called);\n\n    await dragLogThrottler.process?.();\n    assert.isTrue(recordDrag.calledOnce);\n  });\n\n  it('does not log drag if too short', async () => {\n    const dragLogThrottler = new Common.Throttler.Throttler(1000000000);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({dragLogThrottler});\n    const recordDrag = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordDrag',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.dispatchEvent(new MouseEvent('pointerdown'));\n    assert.exists(dragLogThrottler.process);\n    assert.isFalse(recordDrag.called);\n\n    element.dispatchEvent(new MouseEvent('pointerup'));\n\n    await dragLogThrottler.process?.();\n    assert.isFalse(recordDrag.called);\n  });\n\n  it('logs resize', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({resizeLogThrottler: throttler});\n    const recordResize = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordResize',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n\n    element.style.height = '400px';\n    await new Promise(resolve => new ResizeObserver(resolve).observe(element));\n    assert.exists(throttler.process);\n    assert.isFalse(recordResize.called);\n\n    await throttler.process?.();\n    assert.isTrue(recordResize.calledOnce);\n  });\n\n  it('does not log resize if too small', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({resizeLogThrottler: throttler});\n    const recordResize = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordResize',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    element.style.height = '301px';\n    assert.isFalse(recordResize.called);\n  });\n\n  it('logs resize on visibility change', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({resizeLogThrottler: throttler});\n    const recordResize = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordResize',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n\n    element.style.display = 'none';\n    await new Promise(resolve => new IntersectionObserver(resolve).observe(element));\n    assert.exists(throttler.process);\n    assert.isFalse(recordResize.called);\n\n    await throttler.process?.();\n    assert.isTrue(recordResize.calledOnce);\n    assert.deepStrictEqual(stabilizeEvent(recordResize.firstCall.firstArg), {veid: 0, width: 0, height: 0});\n\n    recordResize.resetHistory();\n\n    element.style.display = 'block';\n    await new Promise(resolve => new IntersectionObserver(resolve).observe(element));\n    assert.exists(throttler.process);\n    assert.isFalse(recordResize.called);\n\n    await throttler.process?.();\n    assert.isTrue(recordResize.calledOnce);\n    assert.deepStrictEqual(stabilizeEvent(recordResize.firstCall.firstArg), {veid: 0, width: 300, height: 300});\n  });\n\n  it('logs resize when removed from DOM', async () => {\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging({resizeLogThrottler: throttler});\n    const recordResize = sinon.stub(\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance,\n        'recordResize',\n    );\n\n    const element = document.getElementById('element') as HTMLElement;\n    const parent = document.getElementById('parent') as HTMLElement;\n\n    parent.removeChild(element);\n    await new Promise(resolve => new IntersectionObserver(resolve).observe(element));\n    await new Promise(resolve => new IntersectionObserver(resolve).observe(element));\n    assert.exists(throttler.process);\n    assert.isFalse(recordResize.called);\n\n    await throttler.process?.();\n    assert.isTrue(recordResize.calledOnce);\n    assert.deepStrictEqual(stabilizeEvent(recordResize.firstCall.firstArg), {veid: 0, width: 0, height: 0});\n  });\n\n  it('marks loggable elements for debugging', async () => {\n    // @ts-ignore\n    globalThis.setVeDebuggingEnabled(true);\n    addLoggableElements();\n    await VisualLoggingTesting.LoggingDriver.startLogging();\n    assert.strictEqual(document.getElementById('parent')?.style.outline, 'red solid 1px');\n    assert.strictEqual(document.getElementById('element')?.style.outline, 'red solid 1px');\n  });\n\n  it('logs non-DOM impressions', async () => {\n    addLoggableElements();\n    const loggable = {};\n    VisualLoggingTesting.NonDomState.registerLoggable(\n        loggable, {ve: 1, context: '123'}, document.getElementById('parent') || undefined);\n    await VisualLoggingTesting.LoggingDriver.startLogging();\n    assert.isTrue(recordImpression.calledOnce);\n\n    assert.sameDeepMembers(stabilizeImpressions(recordImpression.firstCall.firstArg.impressions), [\n      {id: 2, type: 1, context: 123, parent: 0},\n      {id: 1, type: 1, context: 42, parent: 0, 'width': 300, 'height': 300},\n      {id: 0, type: 1, 'width': 300, 'height': 300},\n    ]);\n    assert.isEmpty(VisualLoggingTesting.NonDomState.getNonDomState().loggables);\n  });\n});\n"]}