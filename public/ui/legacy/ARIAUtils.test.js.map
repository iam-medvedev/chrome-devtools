{"version":3,"file":"ARIAUtils.test.js","sourceRoot":"","sources":["../../../../../../front_end/ui/legacy/ARIAUtils.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {describeWithEnvironment} from '../../testing/EnvironmentHelpers.js';\n\nimport * as UI from './legacy.js';\n\nconst NBSP = '\\u00A0';\n\nfunction clearAlerts() {\n  for (const alert of document.querySelectorAll('body > [role=alert]')) {\n    alert.remove();\n  }\n}\n\nfunction clearStatuses() {\n  for (const status of document.querySelectorAll('body > [role=status]')) {\n    status.remove();\n  }\n}\n\ndescribeWithEnvironment('ARIAUtils', () => {\n  beforeEach(() => {\n    UI.Dialog.Dialog.getInstance()?.hide();\n    clearAlerts();\n    clearStatuses();\n  });\n\n  afterEach(() => {\n    UI.Dialog.Dialog.getInstance()?.hide();\n    clearAlerts();\n    clearStatuses();\n  });\n\n  describe('ARIAUtils.LiveAnnouncer.alert', () => {\n    it('shows alerts in the dialog if it is shown', () => {\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT);\n      const dialog = new UI.Dialog.Dialog();\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.ALERT);\n      dialog.show();\n\n      UI.ARIAUtils.LiveAnnouncer.alert('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          '');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer\n              .getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          'test');\n    });\n\n    it('repeated alerts include a non breaking space to trigger announcement for the same text multiple times', () => {\n      UI.ARIAUtils.LiveAnnouncer.alert('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          'test');\n\n      UI.ARIAUtils.LiveAnnouncer.alert('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          `test${NBSP}`);\n    });\n\n    it('shows alerts in the body if the dialog is not shown', () => {\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT);\n      const dialog = new UI.Dialog.Dialog();\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.ALERT);\n      dialog.hide();\n\n      UI.ARIAUtils.LiveAnnouncer.alert('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          'test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer\n              .getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.ALERT)\n              .textContent,\n          '');\n    });\n  });\n\n  describe('ARIAUtils.status', () => {\n    it('shows status texts in the dialog if it is shown', () => {\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS);\n      const dialog = new UI.Dialog.Dialog();\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.STATUS);\n      dialog.show();\n\n      UI.ARIAUtils.LiveAnnouncer.status('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS)\n              .textContent,\n          '');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer\n              .getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.STATUS)\n              .textContent,\n          'test');\n    });\n\n    it('repeated status calls include a non breaking space to trigger announcement for the same text multiple times',\n       () => {\n         UI.ARIAUtils.LiveAnnouncer.status('test');\n         assert.strictEqual(\n             UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS)\n                 .textContent,\n             'test');\n\n         UI.ARIAUtils.LiveAnnouncer.status('test');\n         assert.strictEqual(\n             UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS)\n                 .textContent,\n             `test${NBSP}`);\n       });\n\n    it('shows status calls in the body if the dialog is not shown', () => {\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS);\n      const dialog = new UI.Dialog.Dialog();\n      UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.STATUS);\n      dialog.hide();\n\n      UI.ARIAUtils.LiveAnnouncer.status('test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer.getOrCreateAnnouncerElement(document.body, UI.ARIAUtils.AnnouncerRole.STATUS)\n              .textContent,\n          'test');\n      assert.strictEqual(\n          UI.ARIAUtils.LiveAnnouncer\n              .getOrCreateAnnouncerElement(dialog.contentElement, UI.ARIAUtils.AnnouncerRole.STATUS)\n              .textContent,\n          '');\n    });\n  });\n});\n"]}