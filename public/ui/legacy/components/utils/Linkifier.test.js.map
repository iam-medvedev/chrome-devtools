{"version":3,"file":"Linkifier.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/utils/Linkifier.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../../../core/platform/platform.js';\nimport * as SDK from '../../../../core/sdk/sdk.js';\nimport type * as Protocol from '../../../../generated/protocol.js';\nimport * as Bindings from '../../../../models/bindings/bindings.js';\nimport * as Breakpoints from '../../../../models/breakpoints/breakpoints.js';\nimport * as Workspace from '../../../../models/workspace/workspace.js';\nimport {findMenuItemWithLabel} from '../../../../testing/ContextMenuHelpers.js';\nimport {\n  createTarget,\n  describeWithEnvironment,\n} from '../../../../testing/EnvironmentHelpers.js';\nimport {\n  describeWithMockConnection,\n  dispatchEvent,\n} from '../../../../testing/MockConnection.js';\nimport {MockProtocolBackend} from '../../../../testing/MockScopeChain.js';\nimport * as UI from '../../legacy.js';\n\nimport * as Components from './utils.js';\n\nconst {urlString} = Platform.DevToolsPath;\nconst scriptId1 = '1' as Protocol.Runtime.ScriptId;\nconst scriptId2 = '2' as Protocol.Runtime.ScriptId;\nconst executionContextId = 1234 as Protocol.Runtime.ExecutionContextId;\n\nconst simpleScriptContent = `\nfunction foo(x) {\n  const y = x + 3;\n  return y;\n}\n`;\n\ndescribeWithMockConnection('Linkifier', () => {\n  function setUpEnvironment() {\n    const target = createTarget();\n    const linkifier = new Components.Linkifier.Linkifier(100, false);\n    linkifier.targetAdded(target);\n    const workspace = Workspace.Workspace.WorkspaceImpl.instance();\n    const forceNew = true;\n    const targetManager = target.targetManager();\n    const resourceMapping = new Bindings.ResourceMapping.ResourceMapping(targetManager, workspace);\n    const ignoreListManager = Workspace.IgnoreListManager.IgnoreListManager.instance({forceNew: true});\n    const debuggerWorkspaceBinding = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance({\n      forceNew: true,\n      resourceMapping,\n      targetManager,\n      ignoreListManager,\n    });\n    Breakpoints.BreakpointManager.BreakpointManager.instance(\n        {forceNew, targetManager, workspace, debuggerWorkspaceBinding});\n    const backend = new MockProtocolBackend();\n    return {target, linkifier, backend};\n  }\n\n  describe('Linkifier.linkifyURL', () => {\n    it('prefers text over the URL if it is present', async () => {\n      const url = urlString`http://www.example.com`;\n      const link = Components.Linkifier.Linkifier.linkifyURL(url, {\n        text: 'foo',\n        showColumnNumber: false,\n        inlineFrameIndex: 1,\n      });\n      assert.strictEqual(link.innerText, 'foo');\n    });\n\n    it('falls back to the URL if given an empty text value', async () => {\n      const url = urlString`http://www.example.com`;\n      const link = Components.Linkifier.Linkifier.linkifyURL(url, {\n        text: '',\n        showColumnNumber: false,\n        inlineFrameIndex: 1,\n      });\n      assert.strictEqual(link.innerText, 'www.example.com');\n    });\n\n    it('falls back to unknown if the URL and text are empty', async () => {\n      const url = urlString``;\n      const link = Components.Linkifier.Linkifier.linkifyURL(url, {\n        text: '',\n        showColumnNumber: false,\n        inlineFrameIndex: 1,\n      });\n      assert.strictEqual(link.innerText, '(unknown)');\n    });\n  });\n\n  it('creates an empty placeholder anchor if the debugger is disabled and no url exists', () => {\n    const {target, linkifier} = setUpEnvironment();\n\n    const debuggerModel = target.model(SDK.DebuggerModel.DebuggerModel);\n    assert.exists(debuggerModel);\n    void debuggerModel.suspendModel();\n\n    const lineNumber = 4;\n    const url = Platform.DevToolsPath.EmptyUrlString;\n    const anchor = linkifier.maybeLinkifyScriptLocation(target, scriptId1, url, lineNumber);\n    assert.exists(anchor);\n    assert.strictEqual(anchor.textContent, '');\n\n    const info = Components.Linkifier.Linkifier.linkInfo(anchor);\n    assert.exists(info);\n    assert.isNull(info.uiLocation);\n  });\n\n  it('resolves url and updates link as soon as debugger is enabled', done => {\n    const {target, linkifier} = setUpEnvironment();\n\n    const debuggerModel = target.model(SDK.DebuggerModel.DebuggerModel);\n    assert.exists(debuggerModel);\n    void debuggerModel.suspendModel();\n\n    const lineNumber = 4;\n    // Explicitly set url to empty string and let it resolve through the live location.\n    const url = Platform.DevToolsPath.EmptyUrlString;\n    const anchor = linkifier.maybeLinkifyScriptLocation(target, scriptId1, url, lineNumber);\n    assert.exists(anchor);\n    assert.strictEqual(anchor.textContent, '');\n\n    void debuggerModel.resumeModel();\n    const scriptParsedEvent: Protocol.Debugger.ScriptParsedEvent = {\n      scriptId: scriptId1,\n      url: 'https://www.google.com/script.js',\n      startLine: 0,\n      startColumn: 0,\n      endLine: 10,\n      endColumn: 10,\n      executionContextId,\n      hash: '',\n      buildId: '',\n      isLiveEdit: false,\n      sourceMapURL: undefined,\n      hasSourceURL: false,\n      length: 10,\n    };\n    dispatchEvent(target, 'Debugger.scriptParsed', scriptParsedEvent);\n\n    const callback: MutationCallback = function(mutations: MutationRecord[]) {\n      for (const mutation of mutations) {\n        if (mutation.type === 'childList') {\n          const info = Components.Linkifier.Linkifier.linkInfo(anchor);\n          assert.exists(info);\n          assert.exists(info.uiLocation);\n          assert.strictEqual(anchor.textContent, `script.js:${lineNumber + 1}`);\n          observer.disconnect();\n          done();\n        }\n      }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(anchor, {childList: true});\n  });\n\n  it('always favors script ID over url', done => {\n    const {target, linkifier} = setUpEnvironment();\n    const lineNumber = 4;\n    const url = 'https://www.google.com/script.js';\n\n    const scriptParsedEvent1: Protocol.Debugger.ScriptParsedEvent = {\n      scriptId: scriptId1,\n      url,\n      startLine: 0,\n      startColumn: 0,\n      endLine: 10,\n      endColumn: 10,\n      executionContextId,\n      hash: '',\n      buildId: '',\n      isLiveEdit: false,\n      sourceMapURL: undefined,\n      hasSourceURL: false,\n      length: 10,\n    };\n    dispatchEvent(target, 'Debugger.scriptParsed', scriptParsedEvent1);\n\n    // Ask for a link to a script that has not been registered yet, but has the same url.\n    const anchor = linkifier.maybeLinkifyScriptLocation(target, scriptId2, urlString`${url}`, lineNumber);\n    assert.exists(anchor);\n\n    // This link should not pick up the first script with the same url, since there's no\n    // warranty that the first script has anything to do with this one (other than having\n    // the same url).\n    const info = Components.Linkifier.Linkifier.linkInfo(anchor);\n    assert.exists(info);\n    assert.isNull(info.uiLocation);\n\n    const scriptParsedEvent2: Protocol.Debugger.ScriptParsedEvent = {\n      scriptId: scriptId2,\n      url,\n      startLine: 0,\n      startColumn: 0,\n      endLine: 10,\n      endColumn: 10,\n      executionContextId,\n      hash: '',\n      buildId: '',\n      isLiveEdit: false,\n      sourceMapURL: undefined,\n      hasSourceURL: false,\n      length: 10,\n    };\n    dispatchEvent(target, 'Debugger.scriptParsed', scriptParsedEvent2);\n\n    const callback: MutationCallback = function(mutations: MutationRecord[]) {\n      for (const mutation of mutations) {\n        if (mutation.type === 'childList') {\n          const info = Components.Linkifier.Linkifier.linkInfo(anchor);\n          assert.exists(info);\n          assert.exists(info.uiLocation);\n\n          // Make sure that a uiSourceCode is linked to that anchor.\n          assert.exists(info.uiLocation.uiSourceCode);\n          observer.disconnect();\n          done();\n        }\n      }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(anchor, {childList: true});\n  });\n\n  it('optionally shows column numbers in the link text', done => {\n    const {target, linkifier} = setUpEnvironment();\n\n    const debuggerModel = target.model(SDK.DebuggerModel.DebuggerModel);\n    assert.exists(debuggerModel);\n    void debuggerModel.suspendModel();\n\n    const lineNumber = 4;\n    const options = {columnNumber: 8, showColumnNumber: true, inlineFrameIndex: 0};\n    // Explicitly set url to empty string and let it resolve through the live location.\n    const url = Platform.DevToolsPath.EmptyUrlString;\n    const anchor = linkifier.maybeLinkifyScriptLocation(target, scriptId1, url, lineNumber, options);\n    assert.exists(anchor);\n    assert.strictEqual(anchor.textContent, '');\n\n    void debuggerModel.resumeModel();\n    const scriptParsedEvent: Protocol.Debugger.ScriptParsedEvent = {\n      scriptId: scriptId1,\n      url: 'https://www.google.com/script.js',\n      startLine: 0,\n      startColumn: 0,\n      endLine: 10,\n      endColumn: 10,\n      executionContextId,\n      hash: '',\n      buildId: '',\n      isLiveEdit: false,\n      sourceMapURL: undefined,\n      hasSourceURL: false,\n      length: 10,\n    };\n    dispatchEvent(target, 'Debugger.scriptParsed', scriptParsedEvent);\n\n    const callback: MutationCallback = function(mutations: MutationRecord[]) {\n      for (const mutation of mutations) {\n        if (mutation.type === 'childList') {\n          const info = Components.Linkifier.Linkifier.linkInfo(anchor);\n          assert.exists(info);\n          assert.exists(info.uiLocation);\n          assert.strictEqual(anchor.textContent, `script.js:${lineNumber + 1}:${options.columnNumber + 1}`);\n          observer.disconnect();\n          done();\n        }\n      }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(anchor, {childList: true});\n  });\n\n  it('linkifyStackTraceTopFrame without a target returns an initiator link', () => {\n    const lineNumber = 165;\n    const {linkifier} = setUpEnvironment();\n\n    const anchor = linkifier.linkifyStackTraceTopFrame(null, {\n      callFrames: [{\n        url: 'https://w.com/a.js',\n        functionName: 'wow',\n        scriptId: '1' as Protocol.Runtime.ScriptId,\n        lineNumber,\n        columnNumber: 15,\n      }],\n    });\n\n    assert.exists(anchor);\n    assert.strictEqual(anchor.textContent, `w.com/a.js:${lineNumber + 1}`);\n  });\n\n  describe('maybeLinkifyScriptLocation', () => {\n    it('uses the BreakLocation as a revealable if the option is provided and a breakpoint is at the given location',\n       async () => {\n         const {target, linkifier, backend} = setUpEnvironment();\n         const breakpointManager = Breakpoints.BreakpointManager.BreakpointManager.instance();\n         const debuggerWorkspaceBinding = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n         const lineNumber = 1;\n         const columnNumber = 0;\n         const url = urlString`https://www.google.com/script.js`;\n\n         const script = await backend.addScript(target, {content: simpleScriptContent, url}, null);\n         const uiSourceCode = debuggerWorkspaceBinding.uiSourceCodeForScript(script);\n         assert.exists(uiSourceCode);\n\n         const responder = backend.responderToBreakpointByUrlRequest(url, lineNumber);\n         void responder({\n           breakpointId: 'BREAK_ID' as Protocol.Debugger.BreakpointId,\n           locations: [\n             {\n               scriptId: script.scriptId,\n               lineNumber,\n               columnNumber,\n             },\n           ],\n         });\n         const breakpoint = await breakpointManager.setBreakpoint(\n             uiSourceCode, lineNumber, columnNumber, 'x' as Breakpoints.BreakpointManager.UserCondition,\n             /* enabled */ true, /* isLogpoint */ true, Breakpoints.BreakpointManager.BreakpointOrigin.USER_ACTION);\n         assert.exists(breakpoint);\n\n         // Create a link that matches exactly the breakpoint location.\n         const anchor = linkifier.maybeLinkifyScriptLocation(\n             target, script.scriptId, url, lineNumber, {inlineFrameIndex: 0, revealBreakpoint: true});\n         assert.exists(anchor);\n\n         await debuggerWorkspaceBinding.pendingLiveLocationChangesPromise();\n\n         // Assert that the linkinfo has the `BreakLocation` as its revealable.\n         // When clicking the link, `revealables` have predecence over e.g. the\n         // UILocation or url.\n         const linkInfo = Components.Linkifier.Linkifier.linkInfo(anchor);\n         assert.exists(linkInfo);\n         assert.propertyVal(linkInfo.revealable, 'breakpoint', breakpoint);\n       });\n\n    it('fires the LiveLocationUpdate event for each LiveLocation update', async () => {\n      const {target, linkifier, backend} = setUpEnvironment();\n      const eventCallback = sinon.stub();\n      linkifier.addEventListener(Components.Linkifier.Events.LIVE_LOCATION_UPDATED, eventCallback);\n      const debuggerWorkspaceBinding = Bindings.DebuggerWorkspaceBinding.DebuggerWorkspaceBinding.instance();\n      const lineNumber = 1;\n      const url = urlString`https://www.google.com/script.js`;\n      const sourceMapContent = JSON.stringify({\n        version: 3,\n        names: ['adder', 'param1', 'param2', 'result'],\n        sources: ['/original-script.js'],\n        sourcesContent:\n            ['function adder(param1, param2) {\\n  const result = param1 + param2;\\n  return result;\\n}\\n\\n'],\n        mappings: 'AAAA,SAASA,MAAMC,EAAQC,GACrB,MAAMC,EAASF,EAASC,EACxB,OAAOC,CACT',\n      });\n\n      const script = await backend.addScript(target, {content: 'function adder(n,r){const t=n+r;return t}', url}, {\n        url: 'https://www.google.com/script.js.map',\n        content: sourceMapContent,\n      });\n\n      linkifier.maybeLinkifyScriptLocation(target, script.scriptId, url, lineNumber);\n\n      await debuggerWorkspaceBinding.pendingLiveLocationChangesPromise();\n      sinon.assert.calledOnce(eventCallback);\n\n      // Detach the source map and check we get the update event.\n      const debuggerModel = target.model(SDK.DebuggerModel.DebuggerModel);\n      assert.exists(debuggerModel);\n      debuggerModel.sourceMapManager().detachSourceMap(script);\n\n      await debuggerWorkspaceBinding.pendingLiveLocationChangesPromise();\n      // We currently receive more than one event after detaching the source map.\n      // This is also valid but might constitute unnecessary work.\n      assert.isTrue(eventCallback.callCount >= 2);\n    });\n  });\n\n  describe('linkActions', () => {\n    const registrations: Components.Linkifier.LinkHandlerRegistration[] = [];\n\n    afterEach(() => {\n      for (const registration of registrations) {\n        Components.Linkifier.Linkifier.unregisterLinkHandler(registration);\n      }\n      registrations.length = 0;\n    });\n\n    function registerHandler(registration: Components.Linkifier.LinkHandlerRegistration): void {\n      Components.Linkifier.Linkifier.registerLinkHandler(registration);\n      registrations.push(registration);\n    }\n\n    it('returns no actions when no link handlers are registered', () => {\n      const url = urlString`foo-extension://node/1`;\n      const actions = Components.Linkifier.Linkifier.linkActions({\n        url,\n        icon: null,\n        enableDecorator: false,\n        uiLocation: null,\n        liveLocation: null,\n        lineNumber: null,\n        columnNumber: null,\n        inlineFrameIndex: 0,\n        revealable: null,\n        fallback: null\n      });\n      const openUsingActions = actions.filter(action => action.title.startsWith('Open using'));\n      assert.isEmpty(openUsingActions);\n    });\n\n    it('returns an action for a registered scheme-specific link handler', async () => {\n      const handler = sinon.spy();\n\n      registerHandler({\n        title: 'Handler for foo-extension',\n        origin: urlString`foo-extension:abcdefghijklmnop`,\n        scheme: urlString`foo-extension:`,\n        handler,\n        shouldHandleOpenResource: (url, schemes) =>\n            Components.Linkifier.Linkifier.shouldHandleOpenResource(urlString`foo-extension:`, url, schemes),\n      });\n\n      const url = urlString`foo-extension://node/1`;\n      const actions = Components.Linkifier.Linkifier.linkActions({\n        url,\n        icon: null,\n        enableDecorator: false,\n        uiLocation: null,\n        liveLocation: null,\n        lineNumber: null,\n        columnNumber: null,\n        inlineFrameIndex: 0,\n        revealable: null,\n        fallback: null\n      });\n      const openUsingAction = actions.find(action => action.title === 'Open using Handler for foo-extension');\n      assert.exists(openUsingAction);\n      await openUsingAction?.handler();\n      sinon.assert.called(handler);\n    });\n\n    it('returns the right action for multiple link handler', async () => {\n      // Register a (global) handler for the global: origin.\n      registerHandler({\n        title: 'Global Handler',\n        origin: urlString`global:abcdefghijklmnop`,\n        scheme: undefined,\n        handler: () => {},\n        shouldHandleOpenResource: (url, schemes) =>\n            Components.Linkifier.Linkifier.shouldHandleOpenResource(null, url, schemes),\n      });\n\n      // Register a scheme-specific handler for the foo-extension: origin.\n      registerHandler({\n        title: 'Handler for foo-extension',\n        origin: urlString`foo-extension:abcdefghijklmnop`,\n        scheme: urlString`foo-extension:`,\n        handler: () => {},\n        shouldHandleOpenResource: (url, schemes) =>\n            Components.Linkifier.Linkifier.shouldHandleOpenResource(urlString`foo-extension:`, url, schemes),\n      });\n\n      {\n        // Ensure that the foo-extension is the main handler for foo-extension links, and that the\n        // global handler doesn't take precedent.\n        const url = urlString`foo-extension://node/1`;\n        const actions = Components.Linkifier.Linkifier.linkActions({\n          url,\n          icon: null,\n          enableDecorator: false,\n          uiLocation: null,\n          liveLocation: null,\n          lineNumber: null,\n          columnNumber: null,\n          inlineFrameIndex: 0,\n          revealable: null,\n          fallback: null\n        });\n        assert.lengthOf(actions, 3);  // Two fallback actions are always added.\n\n        const openUsingAction = actions.find(action => action.title === 'Open using Handler for foo-extension');\n        assert.exists(openUsingAction);\n      }\n\n      {\n        // Ensure that the Global handler handles its own links.\n        const url = urlString`global://node/1`;\n        const actions = Components.Linkifier.Linkifier.linkActions({\n          url,\n          icon: null,\n          enableDecorator: false,\n          uiLocation: null,\n          liveLocation: null,\n          lineNumber: null,\n          columnNumber: null,\n          inlineFrameIndex: 0,\n          revealable: null,\n          fallback: null\n        });\n        assert.lengthOf(actions, 3);  // One for our handler + 'Open in New Tab' and 'Copy link'.\n\n        const openUsingAction = actions.find(action => action.title === 'Open using Global Handler');\n        assert.exists(openUsingAction);\n      }\n\n      {\n        // Ensure that the Global handler handles all other links.\n        const url = urlString`http://www.example.com`;\n        const actions = Components.Linkifier.Linkifier.linkActions({\n          url,\n          icon: null,\n          enableDecorator: false,\n          uiLocation: null,\n          liveLocation: null,\n          lineNumber: null,\n          columnNumber: null,\n          inlineFrameIndex: 0,\n          revealable: null,\n          fallback: null\n        });\n        assert.lengthOf(actions, 3);  // One for our handler + 'Open in New Tab' and 'Copy link'.\n\n        const openUsingAction = actions.find(action => action.title === 'Open using Global Handler');\n        assert.exists(openUsingAction);\n      }\n    });\n  });\n});\n\ndescribeWithEnvironment('ContentProviderContextMenuProvider', () => {\n  it('does not add \\'Open in new tab\\'-entry for file URLs', async () => {\n    const provider = new Components.Linkifier.ContentProviderContextMenuProvider();\n\n    let contextMenu = new UI.ContextMenu.ContextMenu({} as Event);\n    let uiSourceCode = {\n      contentURL: () => 'https://www.example.com/index.html',\n    } as Workspace.UISourceCode.UISourceCode;\n    provider.appendApplicableItems({} as Event, contextMenu, uiSourceCode);\n    let openInNewTabItem = findMenuItemWithLabel(contextMenu.revealSection(), 'Open in new tab');\n    assert.exists(openInNewTabItem);\n\n    contextMenu = new UI.ContextMenu.ContextMenu({} as Event);\n    uiSourceCode = {\n      contentURL: () => 'file://usr/local/example/index.html',\n    } as Workspace.UISourceCode.UISourceCode;\n    provider.appendApplicableItems({} as Event, contextMenu, uiSourceCode);\n    openInNewTabItem = findMenuItemWithLabel(contextMenu.revealSection(), 'Open in new tab');\n    assert.isUndefined(openInNewTabItem);\n  });\n});\n"]}