{"version":3,"file":"TimelineOverviewCalculator.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/ui/legacy/components/perf_ui/TimelineOverviewCalculator.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Trace from '../../../../models/trace/trace.js';\nimport {describeWithLocale} from '../../../../testing/EnvironmentHelpers.js';\n\nimport * as PerfUI from './perf_ui.js';\n\nconst {Milli: MilliSeconds} = Trace.Types.Timing;\n\ndescribeWithLocale('TimelineOverviewCalculator', () => {\n  it('can calculate pixels for a given time', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n\n    assert.strictEqual(calculator.computePosition(MilliSeconds(50)), 100);\n  });\n\n  it('can calculate the time position for a pixel value', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n\n    assert.strictEqual(calculator.positionToTime(100), MilliSeconds(50));\n  });\n\n  it('formats time values', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n    const result = calculator.formatValue(MilliSeconds(55.234));\n    assert.deepEqual(result, '55\\u00A0ms');\n  });\n\n  it('formats time values with custom precision', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n    const result = calculator.formatValue(MilliSeconds(55.234), 2);\n    assert.deepEqual(result, '55.23\\u00A0ms');\n  });\n\n  it('adjusts times based on navigaton start times', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n    const fakeNavStart = {\n      // Trace Engine events are in microseconds\n      ts: 100_000,\n      args: {\n        data: {\n          documentLoaderURL: 'https://example.com',\n        },\n      },\n    } as unknown as Trace.Types.Events.NavigationStart;\n    calculator.setNavStartTimes([fakeNavStart]);\n    // There is a navigation at 100ms, so this time gets changed to 5ms\n    const result = calculator.formatValue(MilliSeconds(105));\n    assert.deepEqual(result, '5\\u00A0ms');\n  });\n\n  it('returns the correct range', async () => {\n    const calculator = new PerfUI.TimelineOverviewCalculator.TimelineOverviewCalculator();\n    calculator.setDisplayWidth(200);\n    calculator.setBounds(MilliSeconds(0), MilliSeconds(100));\n    assert.strictEqual(calculator.boundarySpan(), 100);\n  });\n});\n"]}