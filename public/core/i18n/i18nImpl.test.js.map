{"version":3,"file":"i18nImpl.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/i18n/i18nImpl.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,IAAI,MAAM,WAAW,CAAC;AAElC,QAAQ,CAAC,4BAA4B,EAAE,GAAG,EAAE;IAC1C,IAAI,SAA0B,CAAC;IAE/B,UAAU,CAAC,GAAG,EAAE;QACd,SAAS,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACxC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;YACxE,sCAAsC;YACtC,MAAM,EAAE,GAAG;YACX,OAAO,EAAE,EAAC,cAAc,EAAE,kBAAkB,EAAC;SAC9C,CAAC,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,GAAG,EAAE;QACb,SAAS,CAAC,OAAO,EAAE,CAAC;QACpB,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC;IACrC,CAAC,CAAC,CAAC;IAEH,MAAM,OAAO,GAAG,+CAA+C,CAAC;IAChE,MAAM,OAAO,GAAG,2CAA2C,CAAC;IAC5D,MAAM,YAAY,GAAG,+CAA+C,CAAC;IACrE,MAAM,MAAM,GAAG,GAAG,YAAY,cAAc,OAAO,GAAG,CAAC;IACvD,MAAM,YAAY,GAAG,GAAG,OAAO,eAAe,MAAM,kCAAkC,CAAC;IAEvF,EAAE,CAAC,2EAA2E,EAAE,KAAK,IAAI,EAAE;QACzF,MAAM,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;QAElE,6EAA6E;QAC7E,kFAAkF;QAClF,cAAc;QACd,MAAM,SAAS,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,wCAAwC,CAAC,EAAE,wBAAwB,SAAS,EAAE,CAAC,CAAC;IACnH,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,mEAAmE,EAAE,KAAK,IAAI,EAAE;QACjF,MAAM,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QAE/D,MAAM,CAAC,MAAM,CACT,SAAS,CAAC,UAAU,CAChB,2GAA2G,CAAC,EAChH,wBAAwB,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IACtD,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2025 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from './i18n.js';\n\ndescribe('fetchAndRegisterLocaleData', () => {\n  let fetchStub: sinon.SinonStub;\n\n  beforeEach(() => {\n    fetchStub = sinon.stub(window, 'fetch');\n    fetchStub.returns(Promise.resolve(new window.Response(JSON.stringify({}), {\n      // Always return an empty JSON object.\n      status: 200,\n      headers: {'Content-type': 'application/json'},\n    })));\n  });\n\n  afterEach(() => {\n    fetchStub.restore();\n    i18n.i18n.resetLocaleDataForTest();\n  });\n\n  const bundled = 'devtools://devtools/bundled/devtools_app.html';\n  const version = '@ffe848af6a5df4fa127e2929331116b7f9f1cb30';\n  const remoteOrigin = 'https://chrome-devtools-frontend.appspot.com/';\n  const remote = `${remoteOrigin}serve_file/${version}/`;\n  const fullLocation = `${bundled}?remoteBase=${remote}&can_dock=true&dockSide=undocked`;\n\n  it('fetches bundled locale files the same way as i18nImpl.ts itself is loaded', async () => {\n    await i18n.i18n.fetchAndRegisterLocaleData('en-US', fullLocation);\n\n    // We can't mock `import.meta.url` from i18nImpl so the Karam host leaks into\n    // this test. This means we only check the last part of the URL with which `fetch`\n    // was called.\n    const actualUrl = fetchStub.args[0][0];\n    assert.isTrue(actualUrl.endsWith('front_end/core/i18n/locales/en-US.json'), `Actually called with ${actualUrl}`);\n  });\n\n  it('fetches non-bundled locale files from the remote service endpoint', async () => {\n    await i18n.i18n.fetchAndRegisterLocaleData('de', fullLocation);\n\n    assert.isTrue(\n        fetchStub.calledWith(\n            'devtools://devtools/remote/serve_file/@ffe848af6a5df4fa127e2929331116b7f9f1cb30/core/i18n/locales/de.json'),\n        `Actually called with ${fetchStub.args[0][0]}`);\n  });\n});\n"]}