{"version":3,"file":"Runtime.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/root/Runtime.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Platform from '../platform/platform.js';\n\nimport * as Root from './root.js';\n\ndescribe('Runtime', () => {\n  beforeEach(() => {\n    Root.Runtime.experiments.clearForTest();\n  });\n\n  describe('Module', () => {\n    describe('getRemoteBase', () => {\n      const bundled = 'devtools://devtools/bundled/devtools_app.html';\n      const version = '@ffe848af6a5df4fa127e2929331116b7f9f1cb30';\n      const remoteOrigin = 'https://chrome-devtools-frontend.appspot.com/';\n      const remote = `${remoteOrigin}serve_file/${version}/`;\n      const fullLocation = `${bundled}?remoteBase=${remote}&can_dock=true&dockSide=undocked`;\n\n      it('provides remote base info', () => {\n        assert.deepEqual(Root.Runtime.getRemoteBase(fullLocation), {\n          version,\n          base: `devtools://devtools/remote/serve_file/${version}/`,\n        });\n      });\n\n      it('returns null when no remote base is provided', () => {\n        assert.isNull(Root.Runtime.getRemoteBase(bundled));\n      });\n\n      it('returns null when a remote base with no version provided.', () => {\n        assert.isNull(Root.Runtime.getRemoteBase(`${bundled}?remoteBase=${remoteOrigin}`));\n      });\n    });\n\n    describe('isNodeEntry', () => {\n      it('returns true for node_app', () => {\n        assert.isTrue(Root.Runtime.isNodeEntry('/bundled/node_app.html'));\n        assert.isTrue(Root.Runtime.isNodeEntry('/node_app'));\n      });\n\n      it('returns true for js_app', () => {\n        assert.isTrue(Root.Runtime.isNodeEntry('/bundled/js_app.html'));\n        assert.isTrue(Root.Runtime.isNodeEntry('/js_app'));\n      });\n\n      it('returns false for other entries', () => {\n        assert.isFalse(Root.Runtime.isNodeEntry('/bundled/inspector.html'));\n        assert.isFalse(Root.Runtime.isNodeEntry('/inspector'));\n      });\n    });\n  });\n\n  it('allConfigurableExperiments returns all registered experiments', () => {\n    Root.Runtime.experiments.register(\n        Root.ExperimentNames.ExperimentName.FONT_EDITOR, 'font editor' as Platform.UIString.LocalizedString);\n    Root.Runtime.experiments.register(\n        Root.ExperimentNames.ExperimentName.APCA, 'apca' as Platform.UIString.LocalizedString);\n\n    const experiments = Root.Runtime.experiments.allConfigurableExperiments();\n\n    assert.deepEqual(\n        experiments.map(experiment => experiment.name),\n        [Root.ExperimentNames.ExperimentName.FONT_EDITOR, Root.ExperimentNames.ExperimentName.APCA]);\n  });\n\n  describe('ExperimentsSupport', () => {\n    it('throws for unknown experiment', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      assert.throws(() => support.isEnabled('test-experiment' as Root.ExperimentNames.ExperimentName));\n    });\n\n    it('throws if registering the same experiment twice', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.register(\n          'experiment' as Root.ExperimentNames.ExperimentName, 'experiment title' as Platform.UIString.LocalizedString);\n      assert.throws(() => {\n        support.register(\n            'experiment' as Root.ExperimentNames.ExperimentName,\n            'experiment title' as Platform.UIString.LocalizedString);\n      });\n    });\n\n    it('registers a host experiment', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.registerHostExperiment({\n        name: 'experiment' as Root.ExperimentNames.ExperimentName,\n        title: 'experiment title',\n        aboutFlag: 'about:flag',\n        isEnabled: false,\n      });\n      assert.isFalse(support.isEnabled('experiment' as Root.ExperimentNames.ExperimentName));\n    });\n\n    it('enables a host experiment', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.registerHostExperiment({\n        name: 'experiment' as Root.ExperimentNames.ExperimentName,\n        title: 'experiment title',\n        aboutFlag: 'about:flag',\n        isEnabled: false,\n      });\n      support.setEnabled('experiment' as Root.ExperimentNames.ExperimentName, true);\n      assert.isTrue(support.isEnabled('experiment' as Root.ExperimentNames.ExperimentName));\n    });\n\n    it('enables a host experiment via initialization', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.registerHostExperiment({\n        name: 'experiment' as Root.ExperimentNames.ExperimentName,\n        title: 'experiment title',\n        aboutFlag: 'about:flag',\n        isEnabled: true,\n      });\n      assert.isTrue(support.isEnabled('experiment' as Root.ExperimentNames.ExperimentName));\n    });\n\n    it('enables a host experiment for test', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.registerHostExperiment({\n        name: 'experiment' as Root.ExperimentNames.ExperimentName,\n        title: 'experiment title',\n        aboutFlag: 'about:flag',\n        isEnabled: false,\n      });\n      assert.isFalse(support.isEnabled('experiment' as Root.ExperimentNames.ExperimentName));\n      support.enableForTest('experiment' as Root.ExperimentNames.ExperimentName);\n      assert.isTrue(support.isEnabled('experiment' as Root.ExperimentNames.ExperimentName));\n    });\n\n    it('throws if registering a host experiment with the same name as an existing experiment', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.register(\n          'experiment' as Root.ExperimentNames.ExperimentName, 'experiment title' as Platform.UIString.LocalizedString);\n      assert.throws(() => {\n        support.registerHostExperiment({\n          name: 'experiment' as Root.ExperimentNames.ExperimentName,\n          title: 'experiment title',\n          aboutFlag: 'about:flag',\n          isEnabled: false,\n        });\n      });\n    });\n\n    it('throws if registering a host experiment with the same name as an existing host experiment', () => {\n      const support = new Root.Runtime.ExperimentsSupport();\n      support.registerHostExperiment({\n        name: 'experiment' as Root.ExperimentNames.ExperimentName,\n        title: 'experiment title',\n        aboutFlag: 'about:flag',\n        isEnabled: false,\n      });\n      assert.throws(() => {\n        support.registerHostExperiment({\n          name: 'experiment' as Root.ExperimentNames.ExperimentName,\n          title: 'experiment title',\n          aboutFlag: 'about:flag',\n          isEnabled: false,\n        });\n      });\n    });\n  });\n});\n"]}