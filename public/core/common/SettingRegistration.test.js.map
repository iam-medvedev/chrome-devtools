{"version":3,"file":"SettingRegistration.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/common/SettingRegistration.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,EACL,gBAAgB,GACjB,MAAM,qCAAqC,CAAC;AAE7C,OAAO,KAAK,MAAM,MAAM,aAAa,CAAC;AAEtC,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACnC,UAAU,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC,CAAC;IAClD,SAAS,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,QAAQ,CAAC,aAAa,EAAE,CAAC,CAAC;IAEjD,MAAM,WAAW,GAAG,cAAc,CAAC,CAAE,2EAA2E;IAEhH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;QAC3E,MAAM,CAAC,QAAQ,CAAC,wBAAwB,CAAC;YACvC,WAAW;YACX,WAAW,qDAAqC;YAChD,YAAY,EAAE,KAAK;SACpB,CAAC,CAAC;QAEH,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE;YACjB,MAAM,CAAC,QAAQ,CAAC,wBAAwB,CAAC;gBACvC,WAAW;gBACX,WAAW,qDAAqC;gBAChD,YAAY,EAAE,KAAK;aACpB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6CAA6C,EAAE,GAAG,EAAE;QACrD,MAAM,CAAC,QAAQ,CAAC,wBAAwB,CAAC;YACvC,WAAW;YACX,WAAW,qDAAqC;YAChD,YAAY,EAAE,KAAK;SACpB,CAAC,CAAC;QAEH,MAAM,aAAa,GAAG,MAAM,CAAC,QAAQ,CAAC,2BAA2B,CAAC,WAAW,CAAC,CAAC;QAE/E,MAAM,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;QAC7B,MAAM,CAAC,YAAY,CAAC,GAAG,EAAE;YACvB,MAAM,CAAC,QAAQ,CAAC,wBAAwB,CAAC;gBACvC,WAAW;gBACX,WAAW,qDAAqC;gBAChD,YAAY,EAAE,KAAK;aACpB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iEAAiE,EAAE,GAAG,EAAE;QACzE,gBAAgB,CAAC;YACf,uBAAuB,EAAE;gBACvB,OAAO,EAAE,WAAW;gBACpB,WAAW,EAAE,CAAC,CAAC;gBACf,OAAO,EAAE,IAAI;aACd;SACF,CAAC,CAAC;QACH,MAAM,oBAAoB,GAAqD,CAAC;gBAC9E,WAAW;gBACX,WAAW,qDAAqC;gBAChD,YAAY,EAAE,KAAK;gBACnB,SAAS,EAAE,MAAM,CAAC,EAAE;oBAClB,OAAO,MAAM,EAAE,uBAAuB,EAAE,OAAO,KAAK,IAAI,CAAC;gBAC3D,CAAC;aACF,CAAC,CAAC;QAEH,MAAM,YAAY,GAAG,IAAI,MAAM,CAAC,QAAQ,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;QAC7D,MAAM,QAAQ,GAAG,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAC5C,aAAa,EAAE,YAAY;YAC3B,aAAa,EAAE,YAAY;YAC3B,YAAY,EAAE,YAAY;YAC1B,oBAAoB;SACrB,CAAC,CAAC;QACH,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QACpD,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAC1B,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC;IAChC,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {\n  updateHostConfig,\n} from '../../testing/EnvironmentHelpers.js';\n\nimport * as Common from './common.js';\n\ndescribe('SettingRegistration', () => {\n  beforeEach(() => Common.Settings.resetSettings());\n  afterEach(() => Common.Settings.resetSettings());\n\n  const settingName = 'mock-setting';  // Moved into a variable to prevent KnownContextValue linter to pick it up.\n\n  it('throws an error when trying to register a duplicated setting name', () => {\n    Common.Settings.registerSettingExtension({\n      settingName,\n      settingType: Common.Settings.SettingType.BOOLEAN,\n      defaultValue: false,\n    });\n\n    assert.throws(() => {\n      Common.Settings.registerSettingExtension({\n        settingName,\n        settingType: Common.Settings.SettingType.BOOLEAN,\n        defaultValue: false,\n      });\n    });\n  });\n\n  it('deletes a registered setting using its name', () => {\n    Common.Settings.registerSettingExtension({\n      settingName,\n      settingType: Common.Settings.SettingType.BOOLEAN,\n      defaultValue: false,\n    });\n\n    const removalResult = Common.Settings.maybeRemoveSettingExtension(settingName);\n\n    assert.isTrue(removalResult);\n    assert.doesNotThrow(() => {\n      Common.Settings.registerSettingExtension({\n        settingName,\n        settingType: Common.Settings.SettingType.BOOLEAN,\n        defaultValue: false,\n      });\n    });\n  });\n\n  it('can handle settings with condition which depends on host config', () => {\n    updateHostConfig({\n      devToolsConsoleInsights: {\n        modelId: 'mockModel',\n        temperature: -1,\n        enabled: true,\n      },\n    });\n    const settingRegistrations: Common.SettingRegistration.SettingRegistration[] = [{\n      settingName,\n      settingType: Common.Settings.SettingType.BOOLEAN,\n      defaultValue: false,\n      condition: config => {\n        return config?.devToolsConsoleInsights?.enabled === true;\n      },\n    }];\n\n    const dummyStorage = new Common.Settings.SettingsStorage({});\n    const settings = new Common.Settings.Settings({\n      syncedStorage: dummyStorage,\n      globalStorage: dummyStorage,\n      localStorage: dummyStorage,\n      settingRegistrations,\n    });\n    const setting = settings.moduleSetting(settingName);\n    assert.isNotNull(setting);\n    assert.isFalse(setting.get());\n  });\n});\n"]}