{"version":3,"file":"EnhancedTracesParser.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/EnhancedTracesParser.test.ts"],"names":[],"mappings":"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","sourcesContent":["\n// Copyright 2024 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\nimport type * as Protocol from '../../generated/protocol.js';\nimport {TraceLoader} from '../../testing/TraceLoader.js';\n\nimport type {RehydratingExecutionContext, RehydratingScript, RehydratingTarget} from './RehydratingObject.js';\nimport * as SDK from './sdk.js';\n\ndescribe('EnhancedTracesParser', () => {\n  let enhancedTracesParser: SDK.EnhancedTracesParser.EnhancedTracesParser;\n  const target1: RehydratingTarget = {\n    targetId: '21D58E83A5C17916277166140F6A464B' as Protocol.Target.TargetID,\n    type: 'page',\n    pid: 8050,\n    url: 'http://localhost:8080/index.html',\n  };\n  const target2: RehydratingTarget = {\n    targetId: '3E1717BE677B75D0536E292E00D6A34A' as Protocol.Target.TargetID,\n    type: 'iframe',\n    pid: 8051,\n    url: 'http://localhost:8080/test.html',\n  };\n  const target3: RehydratingTarget = {\n    targetId: '6A7611591E1EBABAACBAB2B23F0AEC93' as Protocol.Target.TargetID,\n    type: 'iframe',\n    pid: 8052,\n    url: 'test1',\n  };\n\n  const executionContext1: RehydratingExecutionContext = {\n    id: 1 as Protocol.Runtime.ExecutionContextId,\n    origin: 'http://localhost:8080',\n    v8Context: 'example context 1',\n    name: 'http://localhost:8080',\n    uniqueId: 'example context 1-12345',\n    auxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n    isolate: '12345',\n  };\n\n  const executionContext2: RehydratingExecutionContext = {\n    id: 2 as Protocol.Runtime.ExecutionContextId,\n    origin: 'http://localhost:8080',\n    v8Context: 'example context 2',\n    name: 'http://localhost:8080',\n    uniqueId: 'example context 2-12345',\n    auxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n    isolate: '12345',\n  };\n\n  const executionContext3: RehydratingExecutionContext = {\n    id: 1 as Protocol.Runtime.ExecutionContextId,\n    origin: 'http://localhost:8080',\n    v8Context: 'example context 3',\n    name: 'http://localhost:8080',\n    uniqueId: 'example context 3-6789',\n    auxData: {\n      frameId: '3E1717BE677B75D0536E292E00D6A34A' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n    isolate: '6789',\n  };\n\n  const executionContext4: RehydratingExecutionContext = {\n    id: 1 as Protocol.Runtime.ExecutionContextId,\n    origin: '',\n    v8Context: '',\n    name: '',\n    uniqueId: '6A7611591E1EBABAACBAB2B23F0AEC93-1357',\n    auxData: {\n      frameId: '6A7611591E1EBABAACBAB2B23F0AEC93' as Protocol.Page.FrameId,\n      isDefault: false,\n      type: 'type',\n    },\n    isolate: '1357',\n  };\n\n  const script1: RehydratingScript = {\n    scriptId: '1' as Protocol.Runtime.ScriptId,\n    isolate: '12345',\n    executionContextId: 1 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: 'http://localhost:8080/source.map.json',\n    length: 13,\n    pid: 8050,\n    sourceText: 'source text 1',\n    executionContextAuxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n  };\n\n  const script2: RehydratingScript = {\n    scriptId: '2' as Protocol.Runtime.ScriptId,\n    isolate: '12345',\n    executionContextId: 2 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: undefined,\n    length: 13,\n    pid: 8050,\n    sourceText: 'source text 2',\n    executionContextAuxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n  };\n\n  const script3: RehydratingScript = {\n    scriptId: '1' as Protocol.Runtime.ScriptId,\n    isolate: '6789',\n    executionContextId: 1 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: undefined,\n    length: 13,\n    pid: 8051,\n    sourceText: 'source text 3',\n    executionContextAuxData: {\n      frameId: '3E1717BE677B75D0536E292E00D6A34A' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n  };\n\n  const script4: RehydratingScript = {\n    scriptId: '3' as Protocol.Runtime.ScriptId,\n    isolate: '12345',\n    executionContextId: 1 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: 'http://localhost:8080/source.map.json',\n    pid: 8050,\n    executionContextAuxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n  };\n\n  const script5: RehydratingScript = {\n    scriptId: '4' as Protocol.Runtime.ScriptId,\n    isolate: '12345',\n    executionContextId: 1 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: 'http://localhost:8080/source.map.json',\n    pid: 8050,\n    executionContextAuxData: {\n      frameId: '21D58E83A5C17916277166140F6A464B' as Protocol.Page.FrameId,\n      isDefault: true,\n      type: 'type',\n    },\n  };\n\n  const script6: RehydratingScript = {\n    scriptId: '1' as Protocol.Runtime.ScriptId,\n    isolate: '1357',\n    executionContextId: 1 as Protocol.Runtime.ExecutionContextId,\n    startLine: 0,\n    startColumn: 0,\n    endLine: 1,\n    endColumn: 10,\n    hash: '',\n    buildId: '',\n    isModule: false,\n    url: 'http://localhost:8080/index.html',\n    hasSourceURL: false,\n    sourceURL: '',\n    sourceMapURL: 'http://localhost:8080/source.map.json',\n    pid: 8052,\n  };\n\n  beforeEach(async function() {\n    const events = await TraceLoader.rawEvents(this, 'enhanced-traces.json.gz');\n    enhancedTracesParser =\n        new SDK.EnhancedTracesParser.EnhancedTracesParser({traceEvents: events as object[], metadata: {}});\n  });\n\n  it('captures correct targets', async function() {\n    const data = enhancedTracesParser.data();\n    const targets: RehydratingTarget[] = [];\n    for (const hydrationData of data) {\n      const target = hydrationData.target;\n      targets.push(target);\n      if (target.pid === 8050) {\n        assert.deepEqual(target, target1);\n      } else if (target.pid === 8051) {\n        assert.deepEqual(target, target2);\n      } else if (target.pid === 8052) {\n        assert.deepEqual(target, target3);\n      }\n    }\n    assert.lengthOf(targets, 3);\n  });\n\n  it('captures execution context info', async function() {\n    const data = enhancedTracesParser.data();\n    let executionContexts: RehydratingExecutionContext[] = [];\n    for (const hydrationData of data) {\n      executionContexts = [...executionContexts, ...hydrationData.executionContexts];\n    }\n    assert.lengthOf(executionContexts, 4);\n    for (const executionContext of executionContexts) {\n      if (executionContext.id === 1 && executionContext.isolate === '12345') {\n        assert.deepEqual(executionContext, executionContext1);\n      } else if (executionContext.id === 2 && executionContext.isolate === '12345') {\n        assert.deepEqual(executionContext, executionContext2);\n      } else if (executionContext.id === 1 && executionContext.isolate === '6789') {\n        assert.deepEqual(executionContext, executionContext3);\n      }\n    }\n  });\n\n  it('captures script info and source text', async function() {\n    const data = enhancedTracesParser.data();\n    let scripts: RehydratingScript[] = [];\n    for (const hydrationData of data) {\n      scripts = [...scripts, ...hydrationData.scripts];\n    }\n    assert.lengthOf(scripts, 6);\n    for (const script of scripts) {\n      if (script.scriptId === '1' && script.isolate === '12345') {\n        assert.deepEqual(script, script1);\n      } else if (script.scriptId === '2' && script.isolate === '12345') {\n        assert.deepEqual(script, script2);\n      } else if (script.scriptId === '1' && script.isolate === '6789') {\n        assert.deepEqual(script, script3);\n      }\n    }\n  });\n\n  it('groups contexts and scripts under the right target', async function() {\n    const data = enhancedTracesParser.data();\n    for (const hydrationData of data) {\n      const target = hydrationData.target;\n      const executionContexts = hydrationData.executionContexts;\n      const scripts = hydrationData.scripts;\n      if (target.pid === 8050) {\n        assert.lengthOf(executionContexts, 2);\n        for (const executionContext of executionContexts) {\n          // We should be able to get the correct execution context without specifying isolate\n          // as the contexts and scripts are grouped under its respective target already.\n          if (executionContext.id === 1) {\n            assert.deepEqual(executionContext, executionContext1);\n          } else if (executionContext.id === 2) {\n            assert.deepEqual(executionContext, executionContext2);\n          }\n        }\n        assert.lengthOf(scripts, 4);\n        for (const script of scripts) {\n          if (script.scriptId === '1') {\n            assert.deepEqual(script, script1);\n          } else if (script.scriptId === '2') {\n            assert.deepEqual(script, script2);\n          } else if (script.scriptId === '3') {\n            // This script should be grouped under this target given the clue from FunctionCall\n            // trace event.\n            assert.deepEqual(script, script4);\n          } else if (script.scriptId === '4') {\n            // This script should be grouped under this target given the execution context @\n            // isoalte info.\n            assert.deepEqual(script, script5);\n          }\n        }\n      } else if (target.pid === 8051) {\n        assert.lengthOf(executionContexts, 1);\n        assert.lengthOf(scripts, 1);\n        assert.deepEqual(executionContexts[0], executionContext3);\n        assert.deepEqual(scripts[0], script3);\n      } else if (target.pid === 8052) {\n        assert.lengthOf(executionContexts, 1);\n        assert.lengthOf(scripts, 1);\n        assert.deepEqual(executionContexts[0], executionContext4);\n        // This script should be grouped under this target given the PID info.\n        assert.deepEqual(scripts[0], script6);\n      }\n    }\n  });\n\n});\n"]}