{"version":3,"file":"ChildTargetManager.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/ChildTargetManager.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport {\n  createTarget,\n} from '../../testing/EnvironmentHelpers.js';\nimport {\n  describeWithMockConnection,\n} from '../../testing/MockConnection.js';\n\nimport * as SDK from './sdk.js';\n\nconst TARGET_ID = 'TARGET_ID' as Protocol.Target.TargetID;\nconst TITLE = 'TITLE';\n\nlet nextTargetId = 0;\nfunction createTargetInfo(targetId?: string, type?: string, url?: string, title?: string) {\n  return {\n    targetId: (targetId ?? String(++nextTargetId)) as Protocol.Target.TargetID,\n    type: type ?? 'page',\n    title: title ?? '',\n    url: url ?? 'http://example.com',\n    attached: true,\n    canAccessOpener: true,\n  };\n}\n\nlet nextSessionId = 0;\nfunction createSessionId() {\n  return ('SESSION_ID' + ++nextSessionId) as Protocol.Target.SessionID;\n}\n\ndescribeWithMockConnection('ChildTargetManager', () => {\n  it('adds subtargets', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget(\n        {sessionId: createSessionId(), targetInfo: createTargetInfo(TARGET_ID), waitingForDebugger: false});\n    assert.lengthOf(childTargetManager.childTargets(), 1);\n    assert.strictEqual(childTargetManager.childTargets()[0].id(), TARGET_ID);\n  });\n\n  it('sets subtarget type', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    for (const [protocolType, sdkType] of [\n             ['iframe', SDK.Target.Type.FRAME],\n             ['webview', SDK.Target.Type.FRAME],\n             ['page', SDK.Target.Type.FRAME],\n             ['background_page', SDK.Target.Type.FRAME],\n             ['app', SDK.Target.Type.FRAME],\n             ['popup_page', SDK.Target.Type.FRAME],\n             ['worker', SDK.Target.Type.Worker],\n             ['shared_worker', SDK.Target.Type.SHARED_WORKER],\n             ['service_worker', SDK.Target.Type.ServiceWorker],\n             ['auction_worklet', SDK.Target.Type.AUCTION_WORKLET],\n             ['browser', SDK.Target.Type.BROWSER],\n    ]) {\n      await childTargetManager.attachedToTarget({\n        sessionId: createSessionId(),\n        targetInfo: createTargetInfo(undefined, protocolType),\n        waitingForDebugger: false,\n      });\n      const [subtarget] = childTargetManager.childTargets().slice(-1);\n      assert.strictEqual(subtarget.type(), sdkType);\n    }\n  });\n\n  it('sets subtarget to frame for devtools scheme if type is other', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'other', 'devtools://foo/bar'),\n      waitingForDebugger: false,\n    });\n    let [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.FRAME);\n\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'worker', 'devtools://foo/bar'),\n      waitingForDebugger: false,\n    });\n    [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.Worker);\n  });\n\n  it('sets subtarget to frame for chrome://print/ if type is other', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'other', 'chrome://print/'),\n      waitingForDebugger: false,\n    });\n    const [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.FRAME);\n  });\n\n  it('sets subtarget to frame for chrome://file-manager/ if type is other', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'other', 'chrome://file-manager/?%7B%22allowedPaths%22:%22anyPathOrUrl'),\n      waitingForDebugger: false,\n    });\n    const [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.FRAME);\n  });\n\n  it('sets subtarget to frame for sidebar URLs if type is other', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'other', 'chrome://read-later.top-chrome/'),\n      waitingForDebugger: false,\n    });\n    let [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.FRAME);\n\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'other', 'chrome://booksmarks-side-panel.top-chrome/'),\n      waitingForDebugger: false,\n    });\n    [subtarget] = childTargetManager.childTargets().slice(-1);\n    assert.strictEqual(subtarget.type(), SDK.Target.Type.FRAME);\n  });\n\n  it('sets worker target name to the target title', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'worker', 'http://example.com/worker.js', TITLE),\n      waitingForDebugger: false,\n    });\n    assert.strictEqual(childTargetManager.childTargets()[0].name(), TITLE);\n  });\n\n  it('sets non-frame target name to the last path component if present', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'service_worker', 'http://example.org/service_worker.html', TITLE),\n      waitingForDebugger: false,\n    });\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'worker', 'http://example.com/worker.js'),\n      waitingForDebugger: false,\n    });\n    assert.strictEqual(childTargetManager.childTargets()[0].name(), 'service_worker.html');\n    assert.strictEqual(childTargetManager.childTargets()[1].name(), 'worker.js');\n  });\n\n  it('sets non-frame target a numbered name if it cannot use URL path', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    assert.lengthOf(childTargetManager.childTargets(), 0);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'page', 'data:text/html,<!doctype html>'),\n      waitingForDebugger: false,\n    });\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'iframe', 'data:text/html,<!doctype html>'),\n      waitingForDebugger: false,\n    });\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'webview', 'data:text/html,<!doctype html>'),\n      waitingForDebugger: false,\n    });\n    // The targets above are frames and should not be given a numbered named\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo:\n          createTargetInfo(undefined, 'service_worker', 'data:application/javascript;console.log(\"Service Worker\")'),\n      waitingForDebugger: false,\n    });\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo(undefined, 'worker', 'data:application/javascript;console.log(\"Worker\")'),\n      waitingForDebugger: false,\n    });\n    assert.strictEqual(childTargetManager.childTargets()[3].name(), '#1');\n    assert.strictEqual(childTargetManager.childTargets()[4].name(), '#2');\n  });\n\n  it('calls attach callback', async () => {\n    const target = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(target);\n    const attachCallback = sinon.spy();\n    SDK.ChildTargetManager.ChildTargetManager.install(attachCallback);\n    await childTargetManager.attachedToTarget(\n        {sessionId: createSessionId(), targetInfo: createTargetInfo(TARGET_ID), waitingForDebugger: false});\n    sinon.assert.calledOnce(attachCallback);\n    assert.strictEqual(attachCallback.firstCall.firstArg.target.id(), TARGET_ID);\n    assert.isFalse(attachCallback.firstCall.firstArg.waitingForDebugger);\n\n    const OTHER_TARGET_ID = 'OTHER_TARGET_ID' as Protocol.Target.TargetID;\n    await childTargetManager.attachedToTarget(\n        {sessionId: createSessionId(), targetInfo: createTargetInfo(OTHER_TARGET_ID), waitingForDebugger: true});\n    sinon.assert.calledTwice(attachCallback);\n    assert.strictEqual(attachCallback.secondCall.firstArg.target.id(), OTHER_TARGET_ID);\n    assert.isTrue(attachCallback.secondCall.firstArg.waitingForDebugger);\n  });\n\n  it('marks the target as crashed when it crashes', async () => {\n    const parentTarget = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(parentTarget);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo('child-target-id'),\n      waitingForDebugger: false,\n    });\n    const target = childTargetManager.childTargets().at(0);\n    assert.isDefined(target);\n    assert.strictEqual(target.id(), 'child-target-id');\n    childTargetManager.targetCrashed(\n        {targetId: target.id() as Protocol.Target.TargetID, status: 'crashed', errorCode: 1});\n\n    assert.isTrue(target.hasCrashed());\n  });\n\n  it('\"un-crashes\" a target when the target info message is received', async () => {\n    const parentTarget = createTarget();\n    const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(parentTarget);\n    await childTargetManager.attachedToTarget({\n      sessionId: createSessionId(),\n      targetInfo: createTargetInfo('child-target-id'),\n      waitingForDebugger: false,\n    });\n    const target = childTargetManager.childTargets().at(0);\n    assert.isDefined(target);\n    assert.strictEqual(target.id(), 'child-target-id');\n    childTargetManager.targetCrashed(\n        {targetId: target.id() as Protocol.Target.TargetID, status: 'crashed', errorCode: 1});\n    assert.isTrue(target.hasCrashed());\n    childTargetManager.targetInfoChanged({targetInfo: createTargetInfo(target.id())});\n    assert.isFalse(target.hasCrashed());\n  });\n\n  describe('Storage initialization', () => {\n    it('should initialize storage for a top-level worker with STORAGE capability', async () => {\n      const parentTarget = createTarget({type: SDK.Target.Type.BROWSER});\n\n      const getStorageKeyStub = sinon.stub().resolves({\n        storageKey: 'https://example.com/' as Protocol.Storage.SerializedStorageKey,\n        getError: () => undefined,\n      });\n\n      sinon.stub(SDK.Target.Target.prototype, 'storageAgent').returns({\n        invoke_getStorageKey: getStorageKeyStub,\n      } as sinon.SinonStubbedInstance<ProtocolProxyApi.StorageApi>);\n\n      const setMainStorageKeySpy = sinon.spy(SDK.StorageKeyManager.StorageKeyManager.prototype, 'setMainStorageKey');\n      const updateStorageKeysSpy = sinon.spy(SDK.StorageKeyManager.StorageKeyManager.prototype, 'updateStorageKeys');\n      const setMainSecurityOriginSpy =\n          sinon.spy(SDK.SecurityOriginManager.SecurityOriginManager.prototype, 'setMainSecurityOrigin');\n      const updateSecurityOriginsSpy =\n          sinon.spy(SDK.SecurityOriginManager.SecurityOriginManager.prototype, 'updateSecurityOrigins');\n\n      const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(parentTarget);\n      await childTargetManager.attachedToTarget({\n        sessionId: createSessionId(),\n        targetInfo: createTargetInfo(undefined, 'service_worker'),\n        waitingForDebugger: false,\n      });\n\n      assert.isTrue(getStorageKeyStub.calledOnceWith({}));\n      assert.isTrue(setMainStorageKeySpy.calledOnceWith('https://example.com/'));\n      assert.isTrue(updateStorageKeysSpy.calledOnceWith(new Set(['https://example.com/'])));\n      assert.isTrue(setMainSecurityOriginSpy.calledOnceWith('https://example.com', ''));\n      assert.isTrue(updateSecurityOriginsSpy.calledOnceWith(new Set(['https://example.com'])));\n    });\n\n    it('should NOT initialize storage for a frame target', async () => {\n      const parentTarget = createTarget();\n      const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(parentTarget);\n      const initializeStorageSpy =\n          sinon.spy(childTargetManager, 'initializeStorage' as keyof typeof childTargetManager);\n\n      await childTargetManager.attachedToTarget({\n        sessionId: createSessionId(),\n        targetInfo: createTargetInfo(undefined, 'iframe'),\n        waitingForDebugger: false,\n      });\n\n      sinon.assert.notCalled(initializeStorageSpy);\n    });\n\n    it('should NOT initialize storage for a worker without STORAGE capability', async () => {\n      const parentTarget = createTarget();\n      const childTargetManager = new SDK.ChildTargetManager.ChildTargetManager(parentTarget);\n      const initializeStorageSpy =\n          sinon.spy(childTargetManager, 'initializeStorage' as keyof typeof childTargetManager);\n\n      await childTargetManager.attachedToTarget({\n        sessionId: createSessionId(),\n        targetInfo: createTargetInfo(undefined, 'service_worker'),\n        waitingForDebugger: false,\n      });\n\n      sinon.assert.notCalled(initializeStorageSpy);\n    });\n  });\n});\n"]}