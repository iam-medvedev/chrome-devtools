{"version":3,"file":"PreloadingModel.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/PreloadingModel.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Protocol from '../../generated/protocol.js';\nimport {createTarget} from '../../testing/EnvironmentHelpers.js';\nimport {\n  describeWithMockConnection,\n  dispatchEvent,\n} from '../../testing/MockConnection.js';\nimport {getMainFrame, navigate} from '../../testing/ResourceTreeHelpers.js';\nimport * as Platform from '../platform/platform.js';\n\nimport * as SDK from './sdk.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribeWithMockConnection('PreloadingModel', () => {\n  it('adds and deletes rule sets and preloading attempts', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.PreloadingModel.PreloadingModel);\n    assert.exists(model);\n\n    assert.deepEqual(model.getAllRuleSets(), []);\n\n    const loaderId = getMainFrame(target).loaderId;\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:1',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource.js',\n          },\n          ruleSetIds: ['ruleSetId:1'],\n          nodeIds: [1],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource.js',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n      requestId: 'requestId:1',\n    });\n\n    assert.deepEqual(model.getAllRuleSets(), [\n      {\n        id: 'ruleSetId:1' as Protocol.Preload.RuleSetId,\n        value: {\n          id: 'ruleSetId:1' as Protocol.Preload.RuleSetId,\n          loaderId,\n          sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource.js\"]\n    }\n  ]\n}\n`,\n        },\n      },\n    ]);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:2',\n        loaderId,\n        sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/page.html\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource.js',\n          },\n          ruleSetIds: ['ruleSetId:1'],\n          nodeIds: [1],\n        },\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: 'https://example.com/page.html',\n          },\n          ruleSetIds: ['ruleSetId:2'],\n          nodeIds: [2],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prerenderStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prerender,\n        url: 'https://example.com/page.html',\n      },\n      pipelineId: 'pipelineId:2',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n    });\n\n    assert.deepEqual(model.getAllRuleSets(), [\n      {\n        id: 'ruleSetId:1' as Protocol.Preload.RuleSetId,\n        value: {\n          id: 'ruleSetId:1' as Protocol.Preload.RuleSetId,\n          loaderId,\n          sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource.js\"]\n    }\n  ]\n}\n`,\n        },\n      },\n      {\n        id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n        value: {\n\n          id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n          loaderId,\n          sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/page.html\"]\n    }\n  ]\n}\n`,\n        },\n      },\n    ]);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n      {\n        id: `${loaderId}:Prerender:https://example.com/page.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/page.html`,\n          },\n          pipelineId: 'pipelineId:2' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    dispatchEvent(target, 'Preload.ruleSetRemoved', {\n      id: 'ruleSetId:1',\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: 'https://example.com/page.html',\n          },\n          ruleSetIds: ['ruleSetId:2'],\n          nodeIds: [2],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource.js',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n      prefetchStatus: Protocol.Preload.PrefetchStatus.PrefetchEvictedAfterCandidateRemoved,\n      requestId: 'requestId:1',\n    });\n\n    assert.deepEqual(model.getAllRuleSets(), [\n      {\n        id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n        value: {\n          id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n          loaderId,\n          sourceText: `\n{\n  \"prerender\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/page.html\"]\n    }\n  ]\n}\n`,\n        },\n      },\n    ]);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prerender:https://example.com/page.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/page.html`,\n          },\n          pipelineId: 'pipelineId:2' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n  });\n\n  it('registers preloading attempt with status NotTriggered', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.PreloadingModel.PreloadingModel);\n    assert.exists(model);\n\n    assert.deepEqual(model.getAllRuleSets(), []);\n\n    const loaderId = getMainFrame(target).loaderId;\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:1',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\":[\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource.js',\n          },\n          ruleSetIds: ['ruleSetId:1'],\n          nodeIds: [1],\n        },\n      ],\n    });\n\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource.js`,\n          },\n          pipelineId: null,\n          status: SDK.PreloadingModel.PreloadingStatus.NOT_TRIGGERED,\n          prefetchStatus: null,\n          // Invalid request id\n          requestId: '' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n  });\n\n  it('clears rule sets and preloading attempts for previous pages', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.PreloadingModel.PreloadingModel);\n    assert.exists(model);\n\n    assert.deepEqual(model.getAllRuleSets(), []);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), []);\n\n    let loaderId = getMainFrame(target).loaderId;\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:1',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource1.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource1.js',\n          },\n          ruleSetIds: ['ruleSetId:1'],\n          nodeIds: [1],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource1.js',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n    });\n\n    loaderId = 'loaderId:2' as Protocol.Network.LoaderId;\n    navigate(getMainFrame(target), {loaderId});\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:2',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource2.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource2.js',\n          },\n          ruleSetIds: ['ruleSetId:2'],\n          nodeIds: [2],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource2.js',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n      requestId: 'requestId:1',\n    });\n\n    assert.deepEqual(model.getAllRuleSets(), [\n      {\n        id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n        value: {\n          id: 'ruleSetId:2' as Protocol.Preload.RuleSetId,\n          loaderId,\n          sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource2.js\"]\n    }\n  ]\n}\n`,\n        },\n      },\n    ]);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource2.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource2.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n  });\n\n  it('filters preloading attempts by rule set id', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.PreloadingModel.PreloadingModel);\n    assert.exists(model);\n\n    assert.deepEqual(model.getAllRuleSets(), []);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), []);\n\n    const loaderId = getMainFrame(target).loaderId;\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:1',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource12.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:2',\n        loaderId,\n        sourceText: `\n{\n  \"prefetch\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/subresource12.js\", \"/subresource2.js\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource12.js',\n          },\n          ruleSetIds: ['ruleSetId:1', 'ruleSetId:2'],\n          nodeIds: [1, 2],\n        },\n        {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: 'https://example.com/subresource2.js',\n          },\n          ruleSetIds: ['ruleSetId:2'],\n          nodeIds: [2],\n        },\n      ],\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource12.js',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n      requestId: 'requestId:1',\n    });\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/subresource2.js',\n      },\n      pipelineId: 'pipelineId:2',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n      requestId: 'requestId:2',\n    });\n\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource12.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource12.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1', 'ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1, 2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource2.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource2.js`,\n          },\n          pipelineId: 'pipelineId:2' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:2' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    assert.deepEqual(model.getRepresentativePreloadingAttempts('ruleSetId:1' as Protocol.Preload.RuleSetId), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource12.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource12.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1', 'ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1, 2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    assert.deepEqual(model.getRepresentativePreloadingAttempts('ruleSetId:2' as Protocol.Preload.RuleSetId), [\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource12.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource12.js`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:1', 'ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1, 2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n      {\n        id: `${loaderId}:Prefetch:https://example.com/subresource2.js:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/subresource2.js`,\n          },\n          pipelineId: 'pipelineId:2' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:2' as Protocol.Network.RequestId,\n          ruleSetIds: ['ruleSetId:2'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [2] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n  });\n\n  it('regards attempts with strongest action as representative', async () => {\n    const target = createTarget();\n    const model = target.model(SDK.PreloadingModel.PreloadingModel);\n    assert.exists(model);\n\n    assert.deepEqual(model.getAllRuleSets(), []);\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), []);\n\n    const loaderId = getMainFrame(target).loaderId;\n\n    dispatchEvent(target, 'Preload.ruleSetUpdated', {\n      ruleSet: {\n        id: 'ruleSetId:1',\n        loaderId,\n        sourceText: `\n{\n  \"prerender\": [\n    {\n      \"source\": \"list\",\n      \"urls\": [\"/prerendered.html\"]\n    }\n  ]\n}\n`,\n      },\n    });\n    dispatchEvent(target, 'Preload.preloadingAttemptSourcesUpdated', {\n      loaderId,\n      preloadingAttemptSources: [\n        {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: 'https://example.com/prerendered.html',\n          },\n          ruleSetIds: ['ruleSetId:1'],\n          nodeIds: [1],\n        },\n      ],\n    });\n\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prerender:https://example.com/prerendered.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: null,\n          status: SDK.PreloadingModel.PreloadingStatus.NOT_TRIGGERED,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/prerendered.html',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n      requestId: 'requestId:1',\n    });\n\n    // Here, we get two different attemtps, which should sit in the same pipeline actually.\n    // It is because\n    //\n    // - The `NOT_TRIGGERED` entry is synthesized from\n    //   `Preload.preloadingAttemptSourcesUpdated` event.\n    // - It is associated with the following entry for *prerender*, not prefetch.\n    //\n    // We admit the phenomenon as prefetch and prerender are triggered simultaneously and we don't\n    // expect the duration is very short that these entries are shown.\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prerender:https://example.com/prerendered.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: null,\n          status: SDK.PreloadingModel.PreloadingStatus.NOT_TRIGGERED,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n      {\n        id: `${loaderId}:Prefetch:https://example.com/prerendered.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prefetch,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prefetch,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prefetchStatus: null,\n          requestId: 'requestId:1' as Protocol.Network.RequestId,\n          ruleSetIds: [] as Protocol.Preload.RuleSetId[],\n          nodeIds: [] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    dispatchEvent(target, 'Preload.prerenderStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prerender,\n        url: 'https://example.com/prerendered.html',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n    });\n\n    // Converges to an entry.\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prerender:https://example.com/prerendered.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.RUNNING,\n          prerenderStatus: null,\n          disallowedMojoInterface: null,\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n\n    dispatchEvent(target, 'Preload.prefetchStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prefetch,\n        url: 'https://example.com/prerendered.html',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.SUCCESS,\n      requestId: 'requestId:1',\n    });\n    dispatchEvent(target, 'Preload.prerenderStatusUpdated', {\n      key: {\n        loaderId,\n        action: Protocol.Preload.SpeculationAction.Prerender,\n        url: 'https://example.com/prerendered.html',\n      },\n      pipelineId: 'pipelineId:1',\n      status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n      prerenderStatus: Protocol.Preload.PrerenderFinalStatus.MojoBinderPolicy,\n      disallowedMojoInterface: 'device.mojom.GamepadMonitor',\n    });\n\n    // The prerender is the representative of the pipeline even if it failed.\n    assert.deepEqual(model.getRepresentativePreloadingAttempts(null), [\n      {\n        id: `${loaderId}:Prerender:https://example.com/prerendered.html:undefined`,\n        value: {\n          action: Protocol.Preload.SpeculationAction.Prerender,\n          key: {\n            loaderId,\n            action: Protocol.Preload.SpeculationAction.Prerender,\n            url: urlString`https://example.com/prerendered.html`,\n          },\n          pipelineId: 'pipelineId:1' as Protocol.Preload.PreloadPipelineId,\n          status: SDK.PreloadingModel.PreloadingStatus.FAILURE,\n          prerenderStatus: Protocol.Preload.PrerenderFinalStatus.MojoBinderPolicy,\n          disallowedMojoInterface: 'device.mojom.GamepadMonitor',\n          mismatchedHeaders: null,\n          ruleSetIds: ['ruleSetId:1'] as Protocol.Preload.RuleSetId[],\n          nodeIds: [1] as Protocol.DOM.BackendNodeId[],\n        },\n      },\n    ]);\n  });\n});\n"]}