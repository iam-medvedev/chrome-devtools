{"version":3,"file":"PageResourceLoader.test.js","sourceRoot":"","sources":["../../../../../../front_end/core/sdk/PageResourceLoader.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Protocol from '../../generated/protocol.js';\nimport {\n  createTarget,\n} from '../../testing/EnvironmentHelpers.js';\nimport {setupLocaleHooks} from '../../testing/LocaleHelpers.js';\nimport {MockCDPConnection} from '../../testing/MockCDPConnection.js';\nimport {setupRuntimeHooks} from '../../testing/RuntimeHelpers.js';\nimport {createSettingsForTest, setupSettingsHooks} from '../../testing/SettingsHelpers.js';\nimport * as Host from '../host/host.js';\nimport * as Platform from '../platform/platform.js';\nimport * as Root from '../root/root.js';\n\nimport * as SDK from './sdk.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ninterface LoadResult {\n  success: boolean;\n  content: string;\n  errorDescription: Host.ResourceLoader.LoadErrorDescription;\n}\n\nconst initiator = {\n  target: null,\n  frameId: '123' as Protocol.Page.FrameId,\n  initiatorUrl: Platform.DevToolsPath.EmptyUrlString,\n};\n\n/** Creates a PageResourceLoader, TargetManager and Settings instance without installing them as globals */\nfunction setup({loadOverride, maxConcurrentLoads}: {\n  loadOverride?: ((arg0: string) => Promise<{\n                    success: boolean,\n                    content: string,\n                    errorDescription: Host.ResourceLoader.LoadErrorDescription,\n                  }>),\n  maxConcurrentLoads?: number,\n} = {}) {\n  const targetManager = new SDK.TargetManager.TargetManager(new Root.DevToolsContext.DevToolsContext());\n  const settings = createSettingsForTest();\n  const loader = new SDK.PageResourceLoader.PageResourceLoader(\n      targetManager, settings, {currentUserAgent: () => ''}, loadOverride ?? null, maxConcurrentLoads);\n  return {loader, settings, targetManager};\n}\n\ndescribe('PageResourceLoader', () => {\n  const foo1Url = urlString`foo1`;\n  const foo2Url = urlString`foo2`;\n  const foo3Url = urlString`foo3`;\n  const loads: Array<{url: string, resolve?: {(_: LoadResult|PromiseLike<LoadResult>): void}}> = [];\n  const load = async (url: string) => {\n    loads.push({url});\n\n    return {\n      success: true,\n      content: `${url} - content`,\n      errorDescription: {message: '', statusCode: 0, netError: 0, netErrorName: '', urlValid: true},\n    };\n  };\n\n  beforeEach(() => {\n    loads.length = 0;\n  });\n\n  setupLocaleHooks();\n\n  it('registers extension loads', async () => {\n    const {loader} = setup({loadOverride: load});\n    const initiator: SDK.PageResourceLoader.ExtensionInitiator = {\n      extensionId: '123',\n      initiatorUrl: urlString`www.test.com/main.wasm.dwp`,\n      target: null,\n      frameId: null,\n    };\n    const extensionResource: SDK.PageResourceLoader.PageResource = {\n      url: urlString`main.wasm.dwp`,\n      success: true,\n      initiator,\n      size: null,\n      duration: null,\n    };\n\n    loader.resourceLoadedThroughExtension(extensionResource);\n    assert.deepEqual(loader.getScopedNumberOfResources(), {loading: 0, resources: 1});\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 0, queued: 0, resources: 1});\n\n    const resources = Array.from(loader.getResourcesLoaded().values());\n\n    assert.lengthOf(resources, 1);\n    assert.isTrue(resources[0].success);\n    assert.deepEqual(resources[0].initiator, initiator);\n  });\n\n  it('loads resources correctly', async () => {\n    const {loader} = setup({loadOverride: load});\n    const loading = [\n      loader.loadResource(foo1Url, initiator),\n      loader.loadResource(foo2Url, initiator),\n      loader.loadResource(foo3Url, initiator),\n    ];\n\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 3, queued: 0, resources: 3});\n\n    const results = await Promise.all(loading);\n    assert.deepEqual(loads.map(x => x.url), ['foo1', 'foo2', 'foo3']);\n    assert.deepEqual(results.map(x => x.content), ['foo1 - content', 'foo2 - content', 'foo3 - content']);\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 0, queued: 0, resources: 3});\n    const resources = Array.from(loader.getResourcesLoaded().values());\n    assert.isTrue(resources.every(x => x.success));\n  });\n\n  it('deals with page reloads correctly', async () => {\n    const {loader} = setup({loadOverride: load, maxConcurrentLoads: 1});\n    const loading = [\n      loader.loadResource(foo1Url, initiator).catch(e => e.message),\n      loader.loadResource(foo2Url, initiator).catch(e => e.message),\n      loader.loadResource(foo3Url, initiator).catch(e => e.message),\n    ];\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 3, queued: 2, resources: 3});\n\n    loader.onPrimaryPageChanged({\n      data: {\n        frame: {\n          isOutermostFrame() {\n            return true;\n          },\n          resourceTreeModel() {\n            return {\n              target() {\n                return null;\n              },\n            };\n          },\n        } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame,\n        type: SDK.ResourceTreeModel.PrimaryPageChangeType.NAVIGATION,\n      },\n    });\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 3, queued: 0, resources: 0});\n\n    const results = await Promise.all(loading);\n    assert.deepEqual(loads.map(x => x.url), ['foo1']);\n    assert.deepEqual(results[0].content, 'foo1 - content');\n    assert.deepEqual(results[1], 'Load canceled due to reload of inspected page');\n    assert.deepEqual(results[2], 'Load canceled due to reload of inspected page');\n  });\n\n  it('respects the max concurrent loads', async () => {\n    const {loader} = setup({loadOverride: load, maxConcurrentLoads: 2});\n    const loading = [\n      loader.loadResource(foo1Url, initiator),\n      loader.loadResource(foo2Url, initiator),\n      loader.loadResource(foo3Url, initiator),\n    ];\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 3, queued: 1, resources: 3});\n\n    const results = await Promise.all(loading);\n    assert.deepEqual(loads.map(x => x.url), ['foo1', 'foo2', 'foo3']);\n    assert.deepEqual(results.map(x => x.content), ['foo1 - content', 'foo2 - content', 'foo3 - content']);\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 0, queued: 0, resources: 3});\n    const resources = Array.from(loader.getResourcesLoaded().values());\n    assert.isTrue(resources.every(x => x.success));\n  });\n});\n\n// Loading via host bindings requires the settings infra to be booted.\ndescribe('PageResourceLoader', () => {\n  setupSettingsHooks();\n\n  it('blocks UNC file paths with the default setting', async () => {\n    if (!Host.Platform.isWin()) {\n      return;\n    }\n\n    const {loader} = setup({maxConcurrentLoads: 1});\n\n    const message = await loader.loadResource(urlString`file:////127.0.0.1/share/source-map.js.map`, initiator)\n                        .catch(e => e.message);\n\n    assert.include(message, 'remote file');\n  });\n\n  it('blocks remote file paths with the default setting', async () => {\n    const {loader} = setup({maxConcurrentLoads: 1});\n\n    const message =\n        await loader.loadResource(urlString`file://host/source-map.js.map`, initiator).catch(e => e.message);\n\n    assert.include(message, 'remote file');\n  });\n\n  it('blocks UNC file paths with a backslash on Windows with the default setting', async () => {\n    if (!Host.Platform.isWin()) {\n      return;\n    }\n\n    const {loader} = setup({maxConcurrentLoads: 1});\n\n    const message = await loader.loadResource(urlString`file:///\\\\127.0.0.1/share/source-map.js.map`, initiator)\n                        .catch(e => e.message);\n\n    assert.include(message, 'remote file');\n  });\n\n  it('allows remote file paths with the setting enabled', async () => {\n    const {loader, settings} = setup({maxConcurrentLoads: 1});\n    sinon.stub(Host.InspectorFrontendHost.InspectorFrontendHostInstance, 'loadNetworkResource')\n        .callsFake((_url, _headers, streamId, callback) => {\n          Host.ResourceLoader.streamWrite(streamId, 'content of the source map');\n          callback({statusCode: 200});\n        });\n\n    settings.moduleSetting('network.enable-remote-file-loading').set(true);\n    const response = await loader.loadResource(urlString`file://host/source-map.js.map`, initiator);\n\n    assert.strictEqual(response.content, 'content of the source map');\n  });\n\n  it('allows UNC paths on Windows with the setting enabled', async () => {\n    if (!Host.Platform.isWin()) {\n      return;\n    }\n\n    const {loader, settings} = setup({maxConcurrentLoads: 1});\n    sinon.stub(Host.InspectorFrontendHost.InspectorFrontendHostInstance, 'loadNetworkResource')\n        .callsFake((_url, _headers, streamId, callback) => {\n          Host.ResourceLoader.streamWrite(streamId, 'content of the source map');\n          callback({statusCode: 200});\n        });\n\n    settings.moduleSetting('network.enable-remote-file-loading').set(true);\n    const response = await loader.loadResource(urlString`file:////127.0.0.1/share/source-map.js.map`, initiator);\n\n    assert.strictEqual(response.content, 'content of the source map');\n  });\n});\n\ndescribe('PageResourceLoader', () => {\n  setupRuntimeHooks();\n\n  describe('loadResource', () => {\n    const stream = 'STREAM_ID' as Protocol.IO.StreamHandle;\n    const initiatorUrl = urlString`htp://example.com`;\n    const url = urlString`${`${initiatorUrl}/test.txt`}`;\n\n    function setupLoadingSourceMapsAsNetworkResource(connection: MockCDPConnection):\n        Promise<Protocol.Network.LoadNetworkResourceRequest> {\n      return new Promise(resolve => {\n        let contentToRead: string|null = 'foo';\n        connection.setHandler('IO.read', () => {\n          const data = contentToRead;\n          contentToRead = null;\n          return {result: {data} as Protocol.IO.ReadResponse};\n        });\n        connection.setHandler('IO.close', () => ({result: {}}));\n        connection.setHandler('Network.loadNetworkResource', request => {\n          resolve(request);\n          return {result: {resource: {success: true, stream, statusCode: 200}}};\n        });\n      });\n    }\n\n    for (const disableCache of [true, false]) {\n      it(`loads with ${disableCache ? 'disabled' : 'enabled'} cache based on the setting`, async () => {\n        const {loader, settings, targetManager} = setup();\n        settings.moduleSetting('cache-disabled').set(disableCache);\n        const connection = new MockCDPConnection();\n        const target = createTarget({connection, targetManager});\n        const initiator = {target, frameId: null, initiatorUrl};\n        const [{options}, {content}] = await Promise.all([\n          setupLoadingSourceMapsAsNetworkResource(connection),\n          loader.loadResource(url, initiator),\n        ]);\n        // Check that we loaded the resources with appropriately enabled caching.\n        assert.strictEqual(options.disableCache, disableCache);\n        // Sanity check on the content.\n        assert.deepEqual(content, 'foo');\n      });\n    }\n  });\n});\n\ndescribe('PageResourceLoader', () => {\n  const initiatorUrl = urlString`htp://example.com`;\n  const foo1Url = urlString`foo1`;\n  const foo2Url = urlString`foo2`;\n  const foo3Url = urlString`foo3`;\n\n  setupLocaleHooks();\n  setupSettingsHooks();\n  setupRuntimeHooks();\n\n  it('handles scoped resources', async () => {\n    const load = async () => {\n      await new Promise(() => {});\n      return {\n        success: true,\n        content: 'content',\n        errorDescription: {message: '', statusCode: 0, netError: 0, netErrorName: '', urlValid: true},\n      };\n    };\n    const {targetManager, loader} = setup({loadOverride: load});\n    const connection = new MockCDPConnection();\n    const target = createTarget({id: 'main' as Protocol.Target.TargetID, connection, targetManager});\n    const prerenderTarget = createTarget({id: 'prerender' as Protocol.Target.TargetID, connection, targetManager});\n    const initiator = {target, frameId: null, initiatorUrl};\n    const prerenderInitiator = {target: prerenderTarget, frameId: null, initiatorUrl};\n\n    void loader.loadResource(foo1Url, initiator);\n    void loader.loadResource(foo2Url, initiator);\n    void loader.loadResource(foo3Url, prerenderInitiator);\n\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 3, queued: 0, resources: 3});\n    assert.deepEqual(loader.getScopedNumberOfResources(), {loading: 2, resources: 2});\n\n    let resources = loader.getScopedResourcesLoaded();\n    let resourceUrls = [...resources.values()].map(x => x.url);\n    assert.deepEqual(resourceUrls, [foo1Url, foo2Url]);\n\n    targetManager.setScopeTarget(prerenderTarget);\n    assert.deepEqual(loader.getScopedNumberOfResources(), {loading: 1, resources: 1});\n\n    resources = loader.getScopedResourcesLoaded();\n    resourceUrls = [...resources.values()].map(x => x.url);\n    assert.deepEqual(resourceUrls, [foo3Url]);\n  });\n\n  it('handles prerender activation', async () => {\n    const load = async (url: string) => {\n      return {\n        success: true,\n        content: `${url} - content`,\n        errorDescription: {message: '', statusCode: 0, netError: 0, netErrorName: '', urlValid: true},\n      };\n    };\n    const {targetManager, loader} = setup({loadOverride: load});\n    const connection = new MockCDPConnection();\n    const target = createTarget({id: 'main' as Protocol.Target.TargetID, connection, targetManager});\n    const prerenderTarget = createTarget({id: 'prerender' as Protocol.Target.TargetID, connection, targetManager});\n    const initiator = {target, frameId: null, initiatorUrl};\n    const prerenderInitiator = {target: prerenderTarget, frameId: null, initiatorUrl};\n\n    await Promise.all([\n      loader.loadResource(foo1Url, initiator),\n      loader.loadResource(foo2Url, initiator),\n      loader.loadResource(foo3Url, prerenderInitiator),\n    ]);\n\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 0, queued: 0, resources: 3});\n    assert.deepEqual(loader.getScopedNumberOfResources(), {loading: 0, resources: 2});\n\n    let resources = loader.getScopedResourcesLoaded();\n    let resourceUrls = [...resources.values()].map(x => x.url);\n    assert.deepEqual(resourceUrls, [foo1Url, foo2Url]);\n\n    loader.onPrimaryPageChanged({\n      data: {\n        frame: {\n          isOutermostFrame() {\n            return true;\n          },\n          resourceTreeModel() {\n            return {\n              target() {\n                return prerenderTarget;\n              },\n            };\n          },\n        } as unknown as SDK.ResourceTreeModel.ResourceTreeFrame,\n        type: SDK.ResourceTreeModel.PrimaryPageChangeType.ACTIVATION,\n      },\n    });\n    assert.deepEqual(loader.getNumberOfResources(), {loading: 0, queued: 0, resources: 1});\n\n    targetManager.setScopeTarget(prerenderTarget);\n    assert.deepEqual(loader.getScopedNumberOfResources(), {loading: 0, resources: 1});\n\n    resources = loader.getScopedResourcesLoaded();\n    resourceUrls = [...resources.values()].map(x => x.url);\n    assert.deepEqual(resourceUrls, [foo3Url]);\n  });\n});\n"]}