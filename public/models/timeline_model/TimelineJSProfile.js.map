{"version":3,"file":"TimelineJSProfile.js","sourceRoot":"","sources":["../../../../../../front_end/models/timeline_model/TimelineJSProfile.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,uDAAuD;AAEvD,OAAO,KAAK,IAAI,MAAM,yBAAyB,CAAC;AAEhD,OAAO,KAAK,WAAW,MAAM,mBAAmB,CAAC;AAEjD,OAAO,EAAC,UAAU,EAAC,MAAM,oBAAoB,CAAC;AAE9C,MAAM,SAAS,GAAG;IAChB;;;OAGG;IACH,OAAO,EAAE,cAAc;CACxB,CAAC;AACF,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,4CAA4C,EAAE,SAAS,CAAC,CAAC;AAClG,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;AACtE,MAAM,OAAO,0BAA0B;IACrC,MAAM,CAAC,oBAAoB,CAAC,KAAiC;QAC3D,OAAO,KAAK,CAAC,GAAG,KAAK,kBAAkB,CAAC;IAC1C,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,UAAkB;QACnC,IAAI,UAAU,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;YAClC,mEAAqD;SACtD;QACD,IAAI,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,WAAW,CAAC,EAAE;YAC1E,uEAAuD;SACxD;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,MAAM,CAAC,6BAA6B,CAAC,OAAY,EAAE,GAAW,EAAE,eAAwB,EAAE,IAAkB;QAE1G,MAAM,MAAM,GAA8C,EAAE,CAAC;QAE7D,IAAI,eAAe,EAAE;YACnB,WAAW,CAAC,sBAAsB,EAAE,EAAC,IAAI,EAAE,EAAC,WAAW,EAAE,GAAG,EAAC,EAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;SAC5E;QACD,IAAI,CAAC,IAAI,EAAE;YACT,IAAI,GAAG,UAAU,CAAC,SAAS,CAAC,OAAO,EAAE,EAAC,GAAG,EAAE,GAAG,EAAC,CAAC,CAAC;SAClD;QACD,WAAW,8EAA0D,EAAC,IAAI,EAAC,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,YAAY,CAAC,CAAC;QACtG,IAAI,CAAC,OAAO,EAAE;YACZ,OAAO,MAAM,CAAC;SACf;QAED,+GAA+G;QAC/G,yCAAyC;QACzC,WAAW,CAAC,UAAU,CAAC,MAAM,EAAE,EAAE,EAAE,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC,SAAS,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;QAC5G,oEAAoE;QACpE,WAAW,CAAC,YAAY,EAAE,EAAC,IAAI,EAAE,EAAC,YAAY,EAAE,OAAO,EAAC,EAAC,EAAE,OAAO,CAAC,OAAO,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;QACpF,OAAO,MAAM,CAAC;QAEd,SAAS,WAAW,CAAC,IAAY,EAAE,IAAS,EAAE,EAAU,EAAE,GAAY,EAAE,EAAW,EAAE,GAAY;YAE/F,MAAM,KAAK,GACN,EAAC,GAAG,EAAE,GAAG,IAAI,uCAAuC,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EACxD,CAAC;YAC9C,IAAI,GAAG,EAAE;gBACP,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;aACjB;YACD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACnB,OAAO,KAAK,CAAC;QACf,CAAC;IACH,CAAC;CACF","sourcesContent":["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport * as TraceEngine from '../trace/trace.js';\n\nimport {RecordType} from './TimelineModel.js';\n\nconst UIStrings = {\n  /**\n   *@description Text for the name of a thread of the page\n   *@example {1} PH1\n   */\n  threadS: 'Thread {PH1}',\n};\nconst str_ = i18n.i18n.registerUIStrings('models/timeline_model/TimelineJSProfile.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nexport class TimelineJSProfileProcessor {\n  static isNativeRuntimeFrame(frame: Protocol.Runtime.CallFrame): boolean {\n    return frame.url === 'native V8Runtime';\n  }\n\n  static nativeGroup(nativeName: string): string|null {\n    if (nativeName.startsWith('Parse')) {\n      return TimelineJSProfileProcessor.NativeGroups.Parse;\n    }\n    if (nativeName.startsWith('Compile') || nativeName.startsWith('Recompile')) {\n      return TimelineJSProfileProcessor.NativeGroups.Compile;\n    }\n    return null;\n  }\n\n  static createFakeTraceFromCpuProfile(profile: any, tid: number, injectPageEvent: boolean, name?: string|null):\n      TraceEngine.TracingManager.EventPayload[] {\n    const events: TraceEngine.TracingManager.EventPayload[] = [];\n\n    if (injectPageEvent) {\n      appendEvent('TracingStartedInPage', {data: {'sessionId': '1'}}, 0, 0, 'M');\n    }\n    if (!name) {\n      name = i18nString(UIStrings.threadS, {PH1: tid});\n    }\n    appendEvent(TraceEngine.Types.TraceEvents.KnownEventName.ThreadName, {name}, 0, 0, 'M', '__metadata');\n    if (!profile) {\n      return events;\n    }\n\n    // Append a root to show the start time of the profile (which is earlier than first sample), so the Performance\n    // panel won't truncate this time period.\n    appendEvent(RecordType.JSRoot, {}, profile.startTime, profile.endTime - profile.startTime, 'X', 'toplevel');\n    // TODO: create a `Profile` event instead, as `cpuProfile` is legacy\n    appendEvent('CpuProfile', {data: {'cpuProfile': profile}}, profile.endTime, 0, 'I');\n    return events;\n\n    function appendEvent(name: string, args: any, ts: number, dur?: number, ph?: string, cat?: string):\n        TraceEngine.TracingManager.EventPayload {\n      const event =\n          ({cat: cat || 'disabled-by-default-devtools.timeline', name, ph: ph || 'X', pid: 1, tid, ts, args} as\n           TraceEngine.TracingManager.EventPayload);\n      if (dur) {\n        event.dur = dur;\n      }\n      events.push(event);\n      return event;\n    }\n  }\n}\n\nexport namespace TimelineJSProfileProcessor {\n  export const enum NativeGroups {\n    Compile = 'Compile',\n    Parse = 'Parse',\n  }\n}\n"]}