{"version":3,"file":"Writer.test.js","sourceRoot":"","sources":["../../../../../../front_end/models/har/Writer.test.ts"],"names":[],"mappings":"AAAA,sCAAsC;AACtC,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,MAAM,MAAM,6BAA6B,CAAC;AACtD,OAAO,KAAK,QAAQ,MAAM,iCAAiC,CAAC;AAC5D,OAAO,KAAK,GAAG,MAAM,uBAAuB,CAAC;AAE7C,OAAO,EAAC,kBAAkB,EAAC,MAAM,qCAAqC,CAAC;AACvE,OAAO,KAAK,SAAS,MAAM,6BAA6B,CAAC;AAEzD,OAAO,KAAK,GAAG,MAAM,UAAU,CAAC;AAEhC,MAAM,EAAC,SAAS,EAAC,GAAG,QAAQ,CAAC,YAAY,CAAC;AAC1C,MAAM,4BAA4B,GAAG,CAAC,SAAiB,EAAE,EAAE;IACzD,MAAM,SAAS,GAAG,IAAkC,CAAC;IACrD,MAAM,OAAO,GAAG,GAAG,CAAC,cAAc,CAAC,cAAc,CAAC,MAAM,CACpD,SAAS,EAAE,SAAS,CAAA,QAAQ,EAAE,QAAQ,CAAC,YAAY,CAAC,cAAc,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;IAC1F,OAAO,CAAC,YAAY,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAC3C,OAAO,CAAC,sBAAsB,CAC1B,GAAG,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,SAAS,CAAC,WAAW,CAAC,WAAW,CAAC,EAAE,EAAE,KAAK,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;IAC/F,OAAO,OAAO,CAAC;AACjB,CAAC,CAAC;AAEF,kBAAkB,CAAC,WAAW,EAAE,GAAG,EAAE;IACnC,EAAE,CAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;QACzD,MAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACtC,MAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACtC,MAAM,QAAQ,GAAG,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACtC,MAAM,IAAI,GAAG,4BAA4B,CAAC,QAAQ,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;QACrE,MAAM,IAAI,GAAG,4BAA4B,CAAC,QAAQ,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;QACrE,MAAM,IAAI,GAAG,4BAA4B,CAAC,QAAQ,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,CAAC;QAErE,MAAM,QAAQ,GAAG,IAAI,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;QAChD,MAAM,iBAAiB,GAAG,IAAI,MAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;QAC1E,MAAM,MAAM,GAAG,MAAM,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC,oBAAoB,CACvD;YACE,IAAI;YACJ,IAAI;YACJ,IAAI;SACL,EACD,EAAC,QAAQ,EAAE,KAAK,EAAC,EAAE,iBAAiB,CAAC,CAAC;QAC1C,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC;QACrD,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,eAAe,EAAE,QAAQ,CAAC,MAAM,EAAE,EAAE,mCAAmC,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,eAAe,EAAE,QAAQ,CAAC,MAAM,EAAE,EAAE,mCAAmC,CAAC,CAAC;QAC7G,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,eAAe,EAAE,QAAQ,CAAC,MAAM,EAAE,EAAE,mCAAmC,CAAC,CAAC;IAC/G,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2020 The Chromium Authors\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as Protocol from '../../generated/protocol.js';\nimport {describeWithLocale} from '../../testing/EnvironmentHelpers.js';\nimport * as TextUtils from '../text_utils/text_utils.js';\n\nimport * as HAR from './har.js';\n\nconst {urlString} = Platform.DevToolsPath;\nconst simulateRequestWithStartTime = (startTime: number) => {\n  const requestId = 'r0' as Protocol.Network.RequestId;\n  const request = SDK.NetworkRequest.NetworkRequest.create(\n      requestId, urlString`p0.com`, Platform.DevToolsPath.EmptyUrlString, null, null, null);\n  request.setIssueTime(startTime, startTime);\n  request.setContentDataProvider(\n      () => Promise.resolve(new TextUtils.ContentData.ContentData('', false, request.mimeType)));\n  return request;\n};\n\ndescribeWithLocale('HARWriter', () => {\n  it('can correctly sort exported requests logs', async () => {\n    const req1Time = new Date(2020, 0, 3);\n    const req2Time = new Date(2020, 1, 3);\n    const req3Time = new Date(2020, 2, 3);\n    const req1 = simulateRequestWithStartTime(req1Time.getTime() / 1000);\n    const req2 = simulateRequestWithStartTime(req2Time.getTime() / 1000);\n    const req3 = simulateRequestWithStartTime(req3Time.getTime() / 1000);\n\n    const progress = new Common.Progress.Progress();\n    const compositeProgress = new Common.Progress.CompositeProgress(progress);\n    const result = await HAR.Writer.Writer.harStringForRequests(\n        [\n          req3,\n          req2,\n          req1,\n        ],\n        {sanitize: false}, compositeProgress);\n    const resultEntries = JSON.parse(result).log.entries;\n    assert.strictEqual(resultEntries[0].startedDateTime, req1Time.toJSON(), 'earlier request should come first');\n    assert.strictEqual(resultEntries[1].startedDateTime, req2Time.toJSON(), 'earlier request should come first');\n    assert.strictEqual(resultEntries[2].startedDateTime, req3Time.toJSON(), 'earlier request should come first');\n  });\n});\n"]}