{"version":3,"file":"Simulator.test.js","sourceRoot":"","sources":["../../../../../../../../front_end/models/trace/lantern/simulation/Simulator.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n// @ts-nocheck TODO(crbug.com/348449529)\n\nimport {TraceLoader} from '../../../../testing/TraceLoader.js';\nimport * as TraceModel from '../../trace.js';\nimport * as Lantern from '../lantern.js';\nimport {loadTrace, runTraceEngine} from '../testing/testing.js';\n\nconst {NetworkNode, CPUNode} = Lantern.Graph;\nconst {Simulator, DNSCache} = Lantern.Simulation;\n\nlet nextRequestId = 1;\nlet nextTid = 1;\n\nasync function createGraph(trace: Lantern.Trace) {\n  const traceEngineData = await runTraceEngine(trace);\n  const requests = TraceModel.LanternComputationData.createNetworkRequests(trace, traceEngineData);\n  return TraceModel.LanternComputationData.createGraph(requests, trace, traceEngineData);\n}\n\nfunction request(opts) {\n  const scheme = opts.scheme || 'http';\n  const url = `${scheme}://example.com`;\n  const rendererStartTime = opts.startTime;\n  const networkEndTime = opts.endTime;\n  delete opts.startTime;\n  delete opts.endTime;\n\n  return Object.assign(\n      {\n        requestId: opts.requestId || nextRequestId++,\n        url,\n        transferSize: opts.transferSize || 1000,\n        protocol: scheme,\n        parsedURL: {scheme, host: 'example.com', securityOrigin: url},\n        timing: opts.timing,\n        rendererStartTime,\n        networkEndTime,\n      },\n      opts);\n}\n\nfunction cpuTask({tid, ts, duration}) {\n  tid = tid || nextTid++;\n  ts = ts || 0;\n  const dur = ((duration || 0) * 1000) / 5;\n  return {tid, ts, dur};\n}\n\ndescribe('DependencyGraph/Simulator', () => {\n  // Insulate the simulator tests from DNS multiplier changes\n  let originalDNSMultiplier;\n  let trace: Lantern.Trace;\n\n  before(async function() {\n    trace = await loadTrace(this, 'lantern/progressive-app/trace.json.gz');\n    originalDNSMultiplier = DNSCache.rttMultiplier;\n    DNSCache.rttMultiplier = 1;\n  });\n\n  after(() => {\n    DNSCache.rttMultiplier = originalDNSMultiplier;\n  });\n\n  describe('.simulate', () => {\n    const serverResponseTimeByOrigin = new Map([['http://example.com', 500]]);\n\n    function assertNodeTiming(result, node, assertions) {\n      const timing = result.nodeTimings.get(node);\n      assert.ok(timing, 'missing node timing information');\n      Object.keys(assertions).forEach(key => {\n        assert.strictEqual(timing[key], assertions[key]);\n      });\n    }\n\n    it('should simulate basic network graphs', () => {\n      const rootNode = new NetworkNode(request({}));\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(rootNode);\n      // should be 3 RTTs and 500ms for the server response time\n      assert.strictEqual(result.timeInMs, 450 + 500);\n      assertNodeTiming(result, rootNode, {startTime: 0, endTime: 950});\n    });\n\n    it('should simulate basic mixed graphs', () => {\n      const rootNode = new NetworkNode(request({}));\n      const cpuNode = new CPUNode(cpuTask({duration: 200}));\n      cpuNode.addDependency(rootNode);\n\n      const simulator = new Simulator({\n        serverResponseTimeByOrigin,\n        cpuSlowdownMultiplier: 5,\n      });\n      const result = simulator.simulate(rootNode);\n      // should be 3 RTTs and 500ms for the server response time + 200 CPU\n      assert.strictEqual(result.timeInMs, 450 + 500 + 200);\n      assertNodeTiming(result, rootNode, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, cpuNode, {startTime: 950, endTime: 1150});\n    });\n\n    it('should simulate basic network waterfall graphs', () => {\n      const nodeA = new NetworkNode(request({startTime: 0, endTime: 1}));\n      const nodeB = new NetworkNode(request({startTime: 0, endTime: 3}));\n      const nodeC = new NetworkNode(request({startTime: 0, endTime: 5}));\n      const nodeD = new NetworkNode(request({startTime: 0, endTime: 7}));\n\n      nodeA.addDependent(nodeB);\n      nodeB.addDependent(nodeC);\n      nodeC.addDependent(nodeD);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(nodeA);\n      // should be 950ms for A, 650ms each for B, C, D (no DNS and one-way connection)\n      assert.strictEqual(result.timeInMs, 2900);\n      assertNodeTiming(result, nodeA, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, nodeB, {startTime: 950, endTime: 1600});\n      assertNodeTiming(result, nodeC, {startTime: 1600, endTime: 2250});\n      assertNodeTiming(result, nodeD, {startTime: 2250, endTime: 2900});\n    });\n\n    it('should simulate cached network graphs', () => {\n      const nodeA = new NetworkNode(request({startTime: 0, endTime: 1, fromDiskCache: true}));\n      const nodeB = new NetworkNode(request({startTime: 0, endTime: 3, fromDiskCache: true}));\n      nodeA.addDependent(nodeB);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(nodeA);\n      // should be ~8ms each for A, B\n      assert.strictEqual(result.timeInMs, 16);\n      assertNodeTiming(result, nodeA, {startTime: 0, endTime: 8});\n      assertNodeTiming(result, nodeB, {startTime: 8, endTime: 16});\n    });\n\n    it('should simulate data URL network graphs', () => {\n      const url = 'data:image/jpeg;base64,foobar';\n      const protocol = 'data';\n      const parsedURL = {scheme: 'data', host: '', securityOrigin: 'null'};\n      const nodeA = new NetworkNode(request({startTime: 0, endTime: 1, url, parsedURL, protocol}));\n      const nodeB =\n          new NetworkNode(request({startTime: 0, endTime: 3, url, parsedURL, protocol, resourceSize: 1024 * 1024}));\n      nodeA.addDependent(nodeB);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(nodeA);\n\n      // should be ~2ms for A (resourceSize 0), ~12ms for B (resourceSize 1MB)\n      assert.strictEqual(result.timeInMs, 14);\n      assertNodeTiming(result, nodeA, {startTime: 0, endTime: 2});\n      assertNodeTiming(result, nodeB, {startTime: 2, endTime: 14});\n    });\n\n    it('should simulate basic CPU queue graphs', () => {\n      const nodeA = new NetworkNode(request({}));\n      const nodeB = new CPUNode(cpuTask({duration: 100}));\n      const nodeC = new CPUNode(cpuTask({duration: 600}));\n      const nodeD = new CPUNode(cpuTask({duration: 300}));\n\n      nodeA.addDependent(nodeB);\n      nodeA.addDependent(nodeC);\n      nodeA.addDependent(nodeD);\n\n      const simulator = new Simulator({\n        serverResponseTimeByOrigin,\n        cpuSlowdownMultiplier: 5,\n      });\n      const result = simulator.simulate(nodeA);\n      // should be 800ms A, then 1000 ms total for B, C, D in serial\n      assert.strictEqual(result.timeInMs, 1950);\n      assertNodeTiming(result, nodeA, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, nodeB, {startTime: 950, endTime: 1050});\n      assertNodeTiming(result, nodeC, {startTime: 1050, endTime: 1650});\n      assertNodeTiming(result, nodeD, {startTime: 1650, endTime: 1950});\n    });\n\n    it('should simulate basic network waterfall graphs with CPU', () => {\n      const nodeA = new NetworkNode(request({}));\n      const nodeB = new NetworkNode(request({}));\n      const nodeC = new NetworkNode(request({}));\n      const nodeD = new NetworkNode(request({}));\n      const nodeE = new CPUNode(cpuTask({duration: 1000}));\n      const nodeF = new CPUNode(cpuTask({duration: 1000}));\n\n      nodeA.addDependent(nodeB);\n      nodeB.addDependent(nodeC);\n      nodeB.addDependent(nodeE);  // finishes 350 ms after C\n      nodeC.addDependent(nodeD);\n      nodeC.addDependent(nodeF);  // finishes 700 ms after D\n\n      const simulator = new Simulator({\n        serverResponseTimeByOrigin,\n        cpuSlowdownMultiplier: 5,\n      });\n      const result = simulator.simulate(nodeA);\n      // should be 950ms for A, 650ms each for B, C, D, with F finishing 700 ms after D\n      assert.strictEqual(result.timeInMs, 3600);\n    });\n\n    it('should simulate basic parallel requests', () => {\n      const nodeA = new NetworkNode(request({}));\n      const nodeB = new NetworkNode(request({}));\n      const nodeC = new NetworkNode(request({transferSize: 15000}));\n      const nodeD = new NetworkNode(request({}));\n\n      nodeA.addDependent(nodeB);\n      nodeA.addDependent(nodeC);\n      nodeA.addDependent(nodeD);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(nodeA);\n      // should be 950ms for A and 950ms for C (2 round trips of downloading, but no DNS)\n      assert.strictEqual(result.timeInMs, 950 + 950);\n    });\n\n    it('should make connections in parallel', () => {\n      const nodeA = new NetworkNode(request({startTime: 0, networkRequestTime: 0, endTime: 1}));\n      const nodeB = new NetworkNode(request({startTime: 2, networkRequestTime: 2, endTime: 3}));\n      const nodeC = new NetworkNode(request({startTime: 2, networkRequestTime: 2, endTime: 5}));\n      const nodeD = new NetworkNode(request({startTime: 2, networkRequestTime: 2, endTime: 7}));\n\n      nodeA.addDependent(nodeB);\n      nodeA.addDependent(nodeC);\n      nodeA.addDependent(nodeD);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const result = simulator.simulate(nodeA);\n      // should be 950ms for A, 650ms for B reusing connection, 800ms for C and D in parallel.\n      assert.strictEqual(result.timeInMs, 950 + 800);\n      assertNodeTiming(result, nodeA, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, nodeB, {startTime: 950, endTime: 1600});\n      assertNodeTiming(result, nodeC, {startTime: 950, endTime: 1750});\n      assertNodeTiming(result, nodeD, {startTime: 950, endTime: 1750});\n    });\n\n    it('should adjust throughput based on number of requests', () => {\n      const nodeA = new NetworkNode(request({}));\n      const nodeB = new NetworkNode(request({}));\n      const nodeC = new NetworkNode(request({transferSize: 14000}));\n      const nodeD = new NetworkNode(request({}));\n\n      nodeA.addDependent(nodeB);\n      nodeA.addDependent(nodeC);\n      nodeA.addDependent(nodeD);\n\n      // 80 kbps while all 3 download at 150ms/RT = ~1460 bytes/RT\n      // 240 kbps while the last one finishes at 150ms/RT = ~4380 bytes/RT\n      // ~14000 bytes = 5 RTs\n      // 1 RT 80 kbps b/c its shared\n      // 1 RT 80 kbps b/c it needs to grow congestion window from being shared\n      // 1 RT 160 kbps b/c TCP\n      // 2 RT 240 kbps b/c throughput cap\n      const simulator = new Simulator({serverResponseTimeByOrigin, throughput: 240000});\n      const result = simulator.simulate(nodeA);\n      // should be 950ms for A and 1400ms for C (5 round trips of downloading)\n      assert.strictEqual(result.timeInMs, 950 + (150 + 750 + 500));\n    });\n\n    it('should start network requests in startTime order', () => {\n      const rootNode = new NetworkNode(request({startTime: 0, endTime: 0.05, connectionId: 1}));\n      const imageNodes = [\n        new NetworkNode(request({startTime: 5})),\n        new NetworkNode(request({startTime: 4})),\n        new NetworkNode(request({startTime: 3})),\n        new NetworkNode(request({startTime: 2})),\n        new NetworkNode(request({startTime: 1})),\n      ];\n\n      for (const imageNode of imageNodes) {\n        imageNode.request.connectionReused = true;\n        imageNode.request.connectionId = 1;\n        rootNode.addDependent(imageNode);\n      }\n\n      const simulator = new Simulator({serverResponseTimeByOrigin, maximumConcurrentRequests: 1});\n      const result = simulator.simulate(rootNode);\n\n      // should be 3 RTs + SRT for rootNode (950ms)\n      // should be 1 RT  + SRT for image nodes in observed order (650ms)\n      assertNodeTiming(result, rootNode, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, imageNodes[4], {startTime: 950, endTime: 1600});\n      assertNodeTiming(result, imageNodes[3], {startTime: 1600, endTime: 2250});\n      assertNodeTiming(result, imageNodes[2], {startTime: 2250, endTime: 2900});\n      assertNodeTiming(result, imageNodes[1], {startTime: 2900, endTime: 3550});\n      assertNodeTiming(result, imageNodes[0], {startTime: 3550, endTime: 4200});\n    });\n\n    it('should start network requests in priority order to break startTime ties', () => {\n      const rootNode = new NetworkNode(request({startTime: 0, endTime: 0.05, connectionId: 1}));\n      const imageNodes = [\n        new NetworkNode(request({startTime: 0.1, priority: 'VeryLow'})),\n        new NetworkNode(request({startTime: 0.2, priority: 'Low'})),\n        new NetworkNode(request({startTime: 0.3, priority: 'Medium'})),\n        new NetworkNode(request({startTime: 0.4, priority: 'High'})),\n        new NetworkNode(request({startTime: 0.5, priority: 'VeryHigh'})),\n      ];\n\n      for (const imageNode of imageNodes) {\n        imageNode.request.connectionReused = true;\n        imageNode.request.connectionId = 1;\n        rootNode.addDependent(imageNode);\n      }\n\n      const simulator = new Simulator({serverResponseTimeByOrigin, maximumConcurrentRequests: 1});\n      const result = simulator.simulate(rootNode);\n\n      // should be 3 RTs + SRT for rootNode (950ms)\n      // should be 1 RT  + SRT for image nodes in priority order (650ms)\n      assertNodeTiming(result, rootNode, {startTime: 0, endTime: 950});\n      assertNodeTiming(result, imageNodes[4], {startTime: 950, endTime: 1600});\n      assertNodeTiming(result, imageNodes[3], {startTime: 1600, endTime: 2250});\n      assertNodeTiming(result, imageNodes[2], {startTime: 2250, endTime: 2900});\n      assertNodeTiming(result, imageNodes[1], {startTime: 2900, endTime: 3550});\n      assertNodeTiming(result, imageNodes[0], {startTime: 3550, endTime: 4200});\n    });\n\n    it('should simulate two graphs in a row', () => {\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n\n      const nodeA = new NetworkNode(request({}));\n      const nodeB = new NetworkNode(request({}));\n      const nodeC = new NetworkNode(request({transferSize: 15000}));\n      const nodeD = new NetworkNode(request({}));\n\n      nodeA.addDependent(nodeB);\n      nodeA.addDependent(nodeC);\n      nodeA.addDependent(nodeD);\n\n      const resultA = simulator.simulate(nodeA);\n      // should be 950ms for A and 950ms for C (2 round trips of downloading, no DNS)\n      assert.strictEqual(resultA.timeInMs, 950 + 950);\n\n      const nodeE = new NetworkNode(request({}));\n      const nodeF = new NetworkNode(request({}));\n      const nodeG = new NetworkNode(request({}));\n\n      nodeE.addDependent(nodeF);\n      nodeE.addDependent(nodeG);\n\n      const resultB = simulator.simulate(nodeE);\n      // should be 950ms for E and 800ms for F/G\n      assert.strictEqual(resultB.timeInMs, 950 + 800);\n    });\n\n    it('should maximize throughput with H2', () => {\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      const connectionDefaults = {protocol: 'h2', connectionId: 1};\n      const nodeA = new NetworkNode(request({startTime: 0, endTime: 1, ...connectionDefaults}));\n      const nodeB = new NetworkNode(request({startTime: 1, endTime: 2, ...connectionDefaults}));\n      const nodeC = new NetworkNode(request({startTime: 2, endTime: 3, ...connectionDefaults}));\n      const nodeD = new NetworkNode(request({startTime: 3, endTime: 4, ...connectionDefaults}));\n\n      nodeA.addDependent(nodeB);\n      nodeB.addDependent(nodeC);\n      nodeB.addDependent(nodeD);\n\n      // Run two simulations:\n      //  - The first with C & D in parallel.\n      //  - The second with C & D in series.\n      // Under HTTP/2 simulation these should be equivalent, but definitely parallel\n      // shouldn't be slower.\n      const resultA = simulator.simulate(nodeA);\n      nodeC.addDependent(nodeD);\n      const resultB = simulator.simulate(nodeA);\n      expect(resultA.timeInMs).to.be.lessThanOrEqual(resultB.timeInMs);\n    });\n\n    it('should throw (not hang) on graphs with cycles', () => {\n      const rootNode = new NetworkNode(request({}));\n      const depNode = new NetworkNode(request({}));\n      rootNode.addDependency(depNode);\n      depNode.addDependency(rootNode);\n\n      const simulator = new Simulator({serverResponseTimeByOrigin});\n      assert.throws(() => simulator.simulate(rootNode), /cycle/);\n    });\n\n    describe('on a real trace', function() {\n      TraceLoader.setTestTimeout(this);\n\n      it('should compute a timeInMs', async function() {\n        const graph = await createGraph(trace);\n        const simulator = new Simulator({serverResponseTimeByOrigin});\n        const result = simulator.simulate(graph);\n        expect(result.timeInMs).to.be.greaterThan(100);\n      });\n\n      it('should sort the task event times', async () => {\n        const graph = await createGraph(trace);\n        const simulator = new Simulator({serverResponseTimeByOrigin});\n        const result = simulator.simulate(graph);\n        const nodeTimings = Array.from(result.nodeTimings.entries());\n\n        for (let i = 1; i < nodeTimings.length; i++) {\n          const startTime = nodeTimings[i][1].startTime;\n          const previousStartTime = nodeTimings[i - 1][1].startTime;\n          expect(startTime).to.be.greaterThanOrEqual(previousStartTime);\n        }\n      });\n    });\n  });\n\n  describe('.simulateTimespan', () => {\n    it('calculates savings using throughput', () => {\n      const simulator = new Simulator({throughput: 1000, observedThroughput: 2000});\n      const wastedMs = simulator.computeWastedMsFromWastedBytes(500);\n      expect(wastedMs).to.be.closeTo(4000, 0.1);\n    });\n\n    it('falls back to observed throughput if throughput is 0', () => {\n      const simulator = new Simulator({throughput: 0, observedThroughput: 2000});\n      const wastedMs = simulator.computeWastedMsFromWastedBytes(500);\n      expect(wastedMs).to.be.closeTo(2000, 0.1);\n    });\n\n    it('returns 0 if throughput and observed throughput are 0', () => {\n      const simulator = new Simulator({throughput: 0, observedThroughput: 0});\n      const wastedMs = simulator.computeWastedMsFromWastedBytes(500);\n      expect(wastedMs).to.equal(0);\n    });\n  });\n});\n"]}