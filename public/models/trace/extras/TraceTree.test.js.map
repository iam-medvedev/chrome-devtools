{"version":3,"file":"TraceTree.test.js","sourceRoot":"","sources":["../../../../../../../front_end/models/trace/extras/TraceTree.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAG7B,OAAO,KAAK,QAAQ,MAAM,sCAAsC,CAAC;AACjE,OAAO,EAAC,uBAAuB,EAAC,MAAM,wCAAwC,CAAC;AAC/E,OAAO,EACL,aAAa,EACb,iBAAiB,EACjB,eAAe,GAChB,MAAM,kCAAkC,CAAC;AAC1C,OAAO,EAAC,WAAW,EAAC,MAAM,iCAAiC,CAAC;AAC5D,OAAO,KAAK,KAAK,MAAM,aAAa,CAAC;AAErC,OAAO,KAAK,SAAS,MAAM,gBAAgB,CAAC;AAE5C,uBAAuB,CAAC,WAAW,EAAE,GAAG,EAAE;IACxC,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,kCAAkC;YAClC,sDAAsD;YACtD,oDAAoD;YACpD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;YAC9D,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE;gBACjD,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACjC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAErC,MAAM,aAAa,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC9D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC9D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,GAAG,EAAE;YAC1E,kCAAkC;YAClC,gCAAgC;YAChC,6BAA6B;YAC7B,cAAc;YACd,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE;gBACjD,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAChD,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAElE,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YACnE,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QACrE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,GAAG,EAAE;YAC1E,kCAAkC;YAClC,gCAAgC;YAChC,6BAA6B;YAC7B,4BAA4B;YAC5B,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE;gBACjD,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAChD,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAClE,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YACnE,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QACrE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,kCAAkC;YAClC,gCAAgC;YAChC,gCAAgC;YAChC,8BAA8B;YAC9B,4BAA4B;YAC5B,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;YAC3D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE;gBACjD,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAChD,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YAE5G,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;YACrF,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;YAErF,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YAE7G,MAAM,KAAK,GAAG,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC;YAC/C,MAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;YACxE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;YAErF,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,KAAK,GAAG,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC;YAC/C,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;QACpF,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,kCAAkC;YAClC,sDAAsD;YACtD,oDAAoD;YACpD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;YAC9D,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,eAAe,CAAC,MAAM,EAAE;gBACjD,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACjC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAErC,MAAM,aAAa,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC;YACxC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC9D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAC9D,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,kCAAkC;YAClC,gCAAgC;YAChC,aAAa;YACb,6BAA6B;YAC7B,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAClD,UAAU,EAAE,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,EAAE,CAAC;gBAClE,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YACH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAEhD,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAEnE,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAEnE,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,yDAAyD,EAAE,GAAG,EAAE;YACjE,kCAAkC;YAClC,gCAAgC;YAChC,0BAA0B;YAC1B,6BAA6B;YAC7B,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YAEF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAClD,UAAU,EAAE,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,EAAE,CAAC;gBAClE,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YACH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAEhD,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAExC,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAEnE,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC;YAClD,MAAM,CAAC,WAAW,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;YAEnE,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE1C,MAAM,aAAa,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAC;YACvC,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,kCAAkC;YAClC,gCAAgC;YAChC,0BAA0B;YAC1B,4BAA4B;YAC5B,gCAAgC;YAChC,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;YAC5D,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;YAC3D,2BAA2B;YAC3B,MAAM,MAAM,GAAG;gBACb,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;gBACN,MAAM;aACP,CAAC;YAEF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,gBAAgB,CAAC,MAAM,EAAE;gBAClD,UAAU,EAAE,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,qBAAqB,CAAC,EAAE,CAAC;gBAClE,OAAO,EAAE,EAAE;gBACX,SAAS,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;gBACtC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;aAC3C,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAEzC,MAAM,iBAAiB,GAAG,YAAY,CAAC,MAAM,EAAE,CAAC;YAChD,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAAM,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YAE5G,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YAElF,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;YAElF,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;YACxE,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;YAErF,MAAM,KAAK,GAAG,iBAAiB,CAAC,IAAI,EAAE,CAAC,KAA8B,CAAC;YACtE,MAAM,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;YACrF,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC,CAAC;QACvF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sEAAsE,EAAE,KAAK;YAC9E,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,0BAA0B,CAAC,CAAC;YACtF,MAAM,UAAU,GAAG,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACvD,MAAM,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,uBAAuB,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAE1F,6EAA6E;YAC7E,MAAM,UAAU,GAAG,IAAI,QAAQ,CAAC,eAAe,CAAC,cAAc,EAAE,CAAC;YACjE,MAAM,YAAY,GAAG;gBACnB,QAAQ,CAAC,eAAe,CAAC,eAAe,CAAC,mBAAmB,EAAE;gBAC9D,IAAI,KAAK,CAAC,MAAM,CAAC,WAAW,CAAC,mBAAmB,CAAC;;iBAEhD,CAAC;aACH,CAAC;YACF,MAAM,IAAI,GAAG,IAAI,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,OAAO,EAAE;gBAC9D,UAAU;gBACV,OAAO,EAAE,YAAY;gBACrB,SAAS,EAAE,MAAM,CAAC,GAAG;gBACrB,OAAO,EAAE,MAAM,CAAC,GAAG;aACpB,CAAC,CAAC;YACH,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACrC,MAAM,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,CAAC;YACjD,yGAAyG;YACzG,MAAM,YAAY,GAAG,MAAM;iBACD,MAAM,CACH,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC;gBAC9D,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC;iBACpD,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAgD,CAAC,CAAC;YACvF,MAAM,aAAa,GAAG,YAAY,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;YAC9E,MAAM,CAAC,SAAS,CACZ,aAAa,EAAE,CAAC,OAAO,EAAE,SAAS,EAAE,+BAA+B,EAAE,UAAU,EAAE,eAAe,CAAC,CAAC,CAAC;QACzG,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,EAAE,CAAC,2DAA2D,EAAE,KAAK;YACnE,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,2BAA2B,CAAC,CAAC;YACvF,MAAM,UAAU,GAAG,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACvD,MAAM,gBAAgB,GAAG,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBACvD,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC;oBAC1C,KAAK,CAAC,SAAS,CAAC,YAAY,KAAK,6BAA6B,CAAC;YACrE,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBACtB,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;YACnD,CAAC;YACD,MAAM,OAAO,GAAG,SAAS,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;YAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,iCAAiC,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kEAAkE,EAAE,KAAK;YAC1E,MAAM,EAAC,WAAW,EAAC,GAAG,MAAM,WAAW,CAAC,WAAW,CAAC,IAAI,EAAE,kCAAkC,EAAE;gBAC5F,GAAG,KAAK,CAAC,KAAK,CAAC,aAAa,CAAC,QAAQ,EAAE;gBACvC,uBAAuB,EAAE,IAAI;aAC9B,CAAC,CAAC;YAEH,MAAM,UAAU,GAAG,aAAa,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YACvD,MAAM,gBAAgB,GAAG,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;gBACvD,OAAO,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,SAAS,CAAC,GAAG,KAAK,kBAAkB,CAAC;YAC/F,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBACtB,MAAM,IAAI,KAAK,CAAC,+BAA+B,CAAC,CAAC;YACnD,CAAC;YACD,MAAM,OAAO,GAAG,SAAS,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;YAC5D,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,EAAE,CAAC,0CAA0C,EAAE,KAAK;YAClD,MAAM,KAAK,GAAG,eAAe,CAAC,UAAU,EAAE,GAAG,EAAE,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,wBAAwB,CAAC,CAAC;YAC9G,MAAM,UAAU,GAAG,SAAS,CAAC,eAAe,CAAC,KAAK,CAA+B,CAAC;YAClF,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;YACxD,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,GAAG,EAAE,wBAAwB,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport type * as Protocol from '../../../generated/protocol.js';\nimport * as Timeline from '../../../panels/timeline/timeline.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport {\n  getMainThread,\n  makeCompleteEvent,\n  makeProfileCall,\n} from '../../../testing/TraceHelpers.js';\nimport {TraceLoader} from '../../../testing/TraceLoader.js';\nimport * as Trace from '../trace.js';\n\nimport * as TraceTree from './TraceTree.js';\n\ndescribeWithEnvironment('TraceTree', () => {\n  describe('TopDownRootNode', () => {\n    it('builds the root node and its children properly from an event tree', () => {\n      // This builds the following tree:\n      // |------------------ROOT---------------------------|\n      // |-----A----| |-----B-----| |----------C---------|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 150_000, 100_000);\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n      ];\n      const root = new TraceTree.TopDownRootNode(events, {\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const children = root.children();\n      assert.strictEqual(children.size, 3);\n\n      const nodesIterator = children.values();\n      assert.strictEqual(nodesIterator.next().value!.event, eventA);\n      assert.strictEqual(nodesIterator.next().value!.event, eventB);\n      assert.strictEqual(nodesIterator.next().value!.event, eventC);\n    });\n\n    it('builds a top-down tree from an event tree with multiple levels 1', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      // |-----A----| |-----B-----|\n      // |-C-| |-D-|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventC = makeCompleteEvent('Event C', 0, 10_000);\n      const eventD = makeCompleteEvent('Event D', 10_000, 10_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventC,\n        eventD,\n        eventB,\n      ];\n      const root = new TraceTree.TopDownRootNode(events, {\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 2);\n\n      const rootChildIterator = rootChildren.values();\n      const nodeA = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeA.event, eventA);\n      assert.strictEqual(rootChildIterator.next().value!.event, eventB);\n\n      const nodeAChildren = nodeA.children();\n      assert.strictEqual(nodeAChildren.size, 2);\n\n      const nodeAChildIterator = nodeAChildren.values();\n      assert.strictEqual(nodeAChildIterator.next().value!.event, eventC);\n      assert.strictEqual(nodeAChildIterator.next().value!.event, eventD);\n    });\n\n    it('builds a top-down tree from an event tree with multiple levels 2', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      // |-----A----| |-----B-----|\n      //               |-C-| |-D-|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 50_000, 10_000);\n      const eventD = makeCompleteEvent('Event D', 60_000, 10_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n        eventD,\n      ];\n      const root = new TraceTree.TopDownRootNode(events, {\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 2);\n\n      const rootChildIterator = rootChildren.values();\n      assert.strictEqual(rootChildIterator.next().value!.event, eventA);\n      const nodeB = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeB.event, eventB);\n\n      const nodeBChildren = nodeB.children();\n      assert.strictEqual(nodeBChildren.size, 2);\n\n      const nodeBChildIterator = nodeBChildren.values();\n      assert.strictEqual(nodeBChildIterator.next().value!.event, eventC);\n      assert.strictEqual(nodeBChildIterator.next().value!.event, eventD);\n    });\n\n    it('calculates the self time for each node in an event tree correctly', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      // |-----A----| |-------B------|\n      //               |-C-| |--D--|\n      //                     |-E-|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 50_000, 10_000);\n      const eventD = makeCompleteEvent('Event D', 60_000, 10_000);\n      const eventE = makeCompleteEvent('Event E', 60_000, 5_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n        eventD,\n        eventE,\n      ];\n      const root = new TraceTree.TopDownRootNode(events, {\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 2);\n\n      const rootChildIterator = rootChildren.values();\n      assert.strictEqual(rootChildIterator.next().value!.selfTime, Trace.Helpers.Timing.microToMilli(eventA.dur));\n\n      const nodeB = rootChildIterator.next().value as TraceTree.TopDownNode;\n      const nodeBSelfTime = Trace.Types.Timing.Micro(eventB.dur - eventC.dur - eventD.dur);\n      assert.strictEqual(nodeB.selfTime, Trace.Helpers.Timing.microToMilli(nodeBSelfTime));\n\n      const nodeBChildren = nodeB.children();\n      assert.strictEqual(nodeBChildren.size, 2);\n\n      const nodeBChildIterator = nodeBChildren.values();\n      assert.strictEqual(nodeBChildIterator.next().value!.selfTime, Trace.Helpers.Timing.microToMilli(eventC.dur));\n\n      const nodeD = nodeBChildIterator.next().value!;\n      const nodeDSelfTime = Trace.Types.Timing.Micro(eventD.dur - eventE.dur);\n      assert.strictEqual(nodeD.selfTime, Trace.Helpers.Timing.microToMilli(nodeDSelfTime));\n\n      const nodeDChildren = nodeD.children();\n      assert.strictEqual(nodeDChildren.size, 1);\n\n      const nodeDChildIterator = nodeDChildren.values();\n      const nodeE = nodeDChildIterator.next().value!;\n      assert.strictEqual(nodeE.selfTime, Trace.Helpers.Timing.microToMilli(eventE.dur));\n    });\n  });\n\n  describe('BottomUpRootNode', () => {\n    it('builds the root node and its children properly from an event tree', () => {\n      // This builds the following tree:\n      // |------------------ROOT---------------------------|\n      // |-----A----| |-----B-----| |----------C---------|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 150_000, 100_000);\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n      ];\n      const root = new TraceTree.TopDownRootNode(events, {\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const children = root.children();\n      assert.strictEqual(children.size, 3);\n\n      const nodesIterator = children.values();\n      assert.strictEqual(nodesIterator.next().value!.event, eventA);\n      assert.strictEqual(nodesIterator.next().value!.event, eventB);\n      assert.strictEqual(nodesIterator.next().value!.event, eventC);\n    });\n\n    it('builds a bottom up tree from an event tree with multiple levels 1', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      // |-C-||-D-|\n      // |-----A----| |-----B-----|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventC = makeCompleteEvent('Event C', 0, 10_000);\n      const eventD = makeCompleteEvent('Event D', 10_000, 10_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventC,\n        eventD,\n        eventB,\n      ];\n      const root = new TraceTree.BottomUpRootNode(events, {\n        textFilter: new Trace.Extras.TraceFilter.InvisibleEventsFilter([]),\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 4);\n\n      const rootChildIterator = rootChildren.values();\n\n      const nodeC = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeC.event, eventC);\n\n      const nodeD = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeD.event, eventD);\n\n      const nodeA = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeA.event, eventA);\n\n      const nodeB = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeB.event, eventB);\n\n      const nodeCChildren = nodeC.children();\n      assert.strictEqual(nodeCChildren.size, 1);\n      const nodeCChildIterator = nodeCChildren.values();\n      assert.strictEqual(nodeCChildIterator.next().value!.event, eventA);\n\n      const nodeDChildren = nodeC.children();\n      assert.strictEqual(nodeDChildren.size, 1);\n      const nodeDChildIterator = nodeDChildren.values();\n      assert.strictEqual(nodeDChildIterator.next().value!.event, eventA);\n\n      const nodeAChildren = nodeA.children();\n      assert.strictEqual(nodeAChildren.size, 0);\n\n      const nodeBChildren = nodeB.children();\n      assert.strictEqual(nodeBChildren.size, 0);\n    });\n\n    it('builds a tree from an event tree with multiple levels 2', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      //              |-C-||-D-|\n      // |-----A----| |-----B-----|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 50_000, 10_000);\n      const eventD = makeCompleteEvent('Event D', 60_000, 10_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n        eventD,\n      ];\n\n      const root = new TraceTree.BottomUpRootNode(events, {\n        textFilter: new Trace.Extras.TraceFilter.InvisibleEventsFilter([]),\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 4);\n\n      const rootChildIterator = rootChildren.values();\n\n      const nodeA = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeA.event, eventA);\n\n      const nodeC = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeC.event, eventC);\n\n      const nodeD = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeD.event, eventD);\n\n      const nodeB = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeB.event, eventB);\n\n      const nodeCChildren = nodeC.children();\n      assert.strictEqual(nodeCChildren.size, 1);\n      const nodeCChildIterator = nodeCChildren.values();\n      assert.strictEqual(nodeCChildIterator.next().value!.event, eventB);\n\n      const nodeDChildren = nodeC.children();\n      assert.strictEqual(nodeDChildren.size, 1);\n      const nodeDChildIterator = nodeDChildren.values();\n      assert.strictEqual(nodeDChildIterator.next().value!.event, eventB);\n\n      const nodeAChildren = nodeA.children();\n      assert.strictEqual(nodeAChildren.size, 0);\n\n      const nodeBChildren = nodeB.children();\n      assert.strictEqual(nodeBChildren.size, 0);\n    });\n\n    it('calculates the self time for each node in an event tree correctly', () => {\n      // This builds the following tree:\n      // |------------ROOT-----------|\n      //                   |-E-|\n      //              |-C-||--D--|\n      // |-----A----| |-------B------|\n      const eventA = makeCompleteEvent('Event A', 0, 40_000);\n      const eventB = makeCompleteEvent('Event B', 50_000, 50_000);\n      const eventC = makeCompleteEvent('Event C', 50_000, 10_000);\n      const eventD = makeCompleteEvent('Event D', 60_000, 10_000);\n      const eventE = makeCompleteEvent('Event E', 60_000, 5_000);\n      // Events must be in order.\n      const events = [\n        eventA,\n        eventB,\n        eventC,\n        eventD,\n        eventE,\n      ];\n\n      const root = new TraceTree.BottomUpRootNode(events, {\n        textFilter: new Trace.Extras.TraceFilter.InvisibleEventsFilter([]),\n        filters: [],\n        startTime: Trace.Types.Timing.Milli(0),\n        endTime: Trace.Types.Timing.Milli(200_000),\n      });\n\n      const rootChildren = root.children();\n      assert.strictEqual(rootChildren.size, 5);\n\n      const rootChildIterator = rootChildren.values();\n      assert.strictEqual(rootChildIterator.next().value!.selfTime, Trace.Helpers.Timing.microToMilli(eventA.dur));\n\n      const nodeC = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeC.selfTime, Trace.Helpers.Timing.microToMilli(eventC.dur));\n\n      const nodeE = rootChildIterator.next().value as TraceTree.TopDownNode;\n      assert.strictEqual(nodeE.selfTime, Trace.Helpers.Timing.microToMilli(eventE.dur));\n\n      const nodeD = rootChildIterator.next().value as TraceTree.TopDownNode;\n      const nodeDSelfTime = Trace.Types.Timing.Micro(eventD.dur - eventE.dur);\n      assert.strictEqual(nodeD.selfTime, Trace.Helpers.Timing.microToMilli(nodeDSelfTime));\n\n      const nodeB = rootChildIterator.next().value as TraceTree.TopDownNode;\n      const nodeBSelfTime = Trace.Types.Timing.Micro(eventB.dur - eventC.dur - eventD.dur);\n      assert.strictEqual(nodeB.selfTime, Trace.Helpers.Timing.microToMilli(nodeBSelfTime));\n    });\n\n    it('correctly keeps ProfileCall nodes and uses them to build up the tree', async function() {\n      const {parsedTrace} = await TraceLoader.traceEngine(this, 'mainWasm_profile.json.gz');\n      const mainThread = getMainThread(parsedTrace.Renderer);\n      const bounds = Trace.Helpers.Timing.traceWindowMilliSeconds(parsedTrace.Meta.traceBounds);\n\n      // Replicate the filters as they would be when rendering in the actual panel.\n      const textFilter = new Timeline.TimelineFilters.TimelineRegExp();\n      const modelFilters = [\n        Timeline.TimelineUIUtils.TimelineUIUtils.visibleEventsFilter(),\n        new Trace.Extras.TraceFilter.ExclusiveNameFilter([\n          Trace.Types.Events.Name.RUN_TASK,\n        ]),\n      ];\n      const root = new TraceTree.BottomUpRootNode(mainThread.entries, {\n        textFilter,\n        filters: modelFilters,\n        startTime: bounds.min,\n        endTime: bounds.max,\n      });\n      const rootChildren = root.children();\n      const values = Array.from(rootChildren.values());\n      // Find the list of profile calls that have been calculated as the top level rows in the Bottom Up table.\n      const profileCalls = values\n                               .filter(\n                                   node => node.event && Trace.Types.Events.isProfileCall(node.event) &&\n                                       node.event.callFrame.functionName.length > 0)\n                               .map(n => n.event as Trace.Types.Events.SyntheticProfileCall);\n      const functionNames = profileCalls.map(entry => entry.callFrame.functionName);\n      assert.deepEqual(\n          functionNames, ['fetch', 'getTime', 'wasm-to-js::l-imports.getTime', 'mainWasm', 'js-to-wasm::i']);\n    });\n  });\n\n  describe('generateEventID', () => {\n    it('generates the right ID for new engine profile call events', async function() {\n      const {parsedTrace} = await TraceLoader.traceEngine(this, 'react-hello-world.json.gz');\n      const mainThread = getMainThread(parsedTrace.Renderer);\n      const profileCallEntry = mainThread.entries.find(entry => {\n        return Trace.Types.Events.isProfileCall(entry) &&\n            entry.callFrame.functionName === 'performConcurrentWorkOnRoot';\n      });\n      if (!profileCallEntry) {\n        throw new Error('Could not find a profile call');\n      }\n      const eventId = TraceTree.generateEventID(profileCallEntry);\n      assert.strictEqual(eventId, 'f:performConcurrentWorkOnRoot@7');\n    });\n\n    it('generates the right ID for new engine native profile call events', async function() {\n      const {parsedTrace} = await TraceLoader.traceEngine(this, 'invalid-animation-events.json.gz', {\n        ...Trace.Types.Configuration.defaults(),\n        includeRuntimeCallStats: true,\n      });\n\n      const mainThread = getMainThread(parsedTrace.Renderer);\n      const profileCallEntry = mainThread.entries.find(entry => {\n        return Trace.Types.Events.isProfileCall(entry) && entry.callFrame.url === 'native V8Runtime';\n      });\n      if (!profileCallEntry) {\n        throw new Error('Could not find a profile call');\n      }\n      const eventId = TraceTree.generateEventID(profileCallEntry);\n      assert.strictEqual(eventId, 'f:Compile@0');\n    });\n  });\n\n  describe('eventStackFrame', () => {\n    it('extracts the stackFrame for ProfileCalls', async function() {\n      const event = makeProfileCall('somefunc', 100, 10, undefined, undefined, undefined, 'https://x.com/file.mjs');\n      const stackFrame = TraceTree.eventStackFrame(event) as Protocol.Runtime.CallFrame;\n      assert.strictEqual(stackFrame.functionName, 'somefunc');\n      assert.strictEqual(stackFrame.url, 'https://x.com/file.mjs');\n    });\n  });\n});\n"]}