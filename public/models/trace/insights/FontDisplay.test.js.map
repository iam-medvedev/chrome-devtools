{"version":3,"file":"FontDisplay.test.js","sourceRoot":"","sources":["../../../../../../../front_end/models/trace/insights/FontDisplay.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,EAAC,uBAAuB,EAAC,MAAM,wCAAwC,CAAC;AAC/E,OAAO,EAAC,eAAe,EAAE,iBAAiB,EAAE,YAAY,EAAC,MAAM,oCAAoC,CAAC;AAGpG,uBAAuB,CAAC,aAAa,EAAE;IACrC,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;QAClD,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,qBAAqB,CAAC,CAAC;QACzE,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACrC,MAAM,OAAO,GACT,iBAAiB,CAAC,aAAa,EAAE,QAAQ,EAAE,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE9G,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IACpC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;QAC/C,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,sBAAsB,CAAC,CAAC;QAC1E,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;QACrC,MAAM,OAAO,GACT,iBAAiB,CAAC,aAAa,EAAE,QAAQ,EAAE,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;QAE9G,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAC,GAAG,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAC,CAAC,CAAC,EAAE;YACnF;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,0EAA0E;gBACnF,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;YACD;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,iFAAiF;gBAC1F,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;YACD;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,8EAA8E;gBACvF,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;YACD;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,qFAAqF;gBAC9F,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;YACD;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,4EAA4E;gBACrF,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;YACD;gBACE,IAAI,EAAE,SAAS;gBACf,OAAO,EAAE,wEAAwE;gBACjF,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,EAAwB;aACrC;SACF,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport {getFirstOrError, getInsightOrError, processTrace} from '../../../testing/InsightHelpers.js';\nimport type * as Types from '../types/types.js';\n\ndescribeWithEnvironment('FontDisplay', function() {\n  it('finds no requests for remote fonts', async () => {\n    const {data, insights} = await processTrace(this, 'load-simple.json.gz');\n    assert.strictEqual(insights.size, 2);\n    const insight =\n        getInsightOrError('FontDisplay', insights, getFirstOrError(data.Meta.navigationsByNavigationId.values()));\n\n    assert.lengthOf(insight.fonts, 0);\n  });\n\n  it('finds requests for remote fonts', async () => {\n    const {data, insights} = await processTrace(this, 'font-display.json.gz');\n    assert.strictEqual(insights.size, 1);\n    const insight =\n        getInsightOrError('FontDisplay', insights, getFirstOrError(data.Meta.navigationsByNavigationId.values()));\n\n    assert.deepEqual(insight.fonts.map(f => ({...f, request: f.request.args.data.url})), [\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/ptsans/v17/jizaRExUiTo99u79D0KExcOPIDU.woff2',\n        display: 'auto',\n        wastedTime: 20 as Types.Timing.Milli,\n      },\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/droidsans/v18/SlGVmQWMvZQIdix7AFxXkHNSbRYXags.woff2',\n        display: 'auto',\n        wastedTime: 15 as Types.Timing.Milli,\n      },\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/ptsans/v17/jizfRExUiTo99u79B_mh0O6tLR8a8zI.woff2',\n        display: 'auto',\n        wastedTime: 15 as Types.Timing.Milli,\n      },\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/droidsans/v18/SlGWmQWMvZQIdix7AFxXmMh3eDs1ZyHKpWg.woff2',\n        display: 'auto',\n        wastedTime: 15 as Types.Timing.Milli,\n      },\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/ptserif/v18/EJRVQgYoZZY2vCFuvAFWzr-_dSb_.woff2',\n        display: 'auto',\n        wastedTime: 15 as Types.Timing.Milli,\n      },\n      {\n        name: undefined,\n        request: 'https://fonts.gstatic.com/s/lato/v24/S6u9w4BMUTPHh6UVSwiPGQ3q5d0.woff2',\n        display: 'auto',\n        wastedTime: 10 as Types.Timing.Milli,\n      },\n    ]);\n  });\n});\n"]}