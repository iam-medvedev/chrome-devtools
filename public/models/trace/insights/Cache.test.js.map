{"version":3,"file":"Cache.test.js","sourceRoot":"","sources":["../../../../../../../front_end/models/trace/insights/Cache.test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2025 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Protocol from '../../../generated/protocol.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport {getFirstOrError, getInsightOrError, processTrace} from '../../../testing/InsightHelpers.js';\nimport type * as Trace from '../trace.js';\n\nimport * as Cache from './Cache.js';\n\ndescribeWithEnvironment('Cache', function() {\n  describe('isCacheable', () => {\n    it('should return true for cacheable requests', () => {\n      const cacheableRequest = {\n        args: {\n          data: {\n            protocol: 'https',\n            resourceType: Protocol.Network.ResourceType.Script,\n            statusCode: 200,\n          },\n        },\n      } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n      assert.isTrue(Cache.isCacheable(cacheableRequest));\n    });\n\n    it('should return false for non-network scheme: file', () => {\n      const nonNetworkRequest = {\n        args: {\n          data: {\n            protocol: 'file',\n            resourceType: Protocol.Network.ResourceType.Script,\n            statusCode: 200,\n          },\n        },\n      } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n      assert.isFalse(Cache.isCacheable(nonNetworkRequest));\n    });\n\n    it('should return false for non-cacheable status codes', () => {\n      const nonCacheableRequest = {\n        args: {\n          data: {\n            protocol: 'https',\n            resourceType: Protocol.Network.ResourceType.Script,\n            statusCode: 404,\n          },\n        },\n      } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n      assert.isFalse(Cache.isCacheable(nonCacheableRequest));\n    });\n\n    it('should return false for non-static resource types', () => {\n      const nonCacheableRequest = {\n        args: {\n          data: {\n            protocol: 'https',\n            resourceType: Protocol.Network.ResourceType.XHR,\n            statusCode: 200,\n          },\n        },\n      } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n      assert.isFalse(Cache.isCacheable(nonCacheableRequest));\n    });\n  });\n\n  describe('computeCacheLifetimeInSeconds', () => {\n    it('should return max-age if defined', () => {\n      const headers = [{name: 'cache-control', value: 'max-age=3600'}];\n      const cacheControl = {\n        'max-age': 3600,\n      };\n      assert.strictEqual(Cache.computeCacheLifetimeInSeconds(headers, cacheControl), 3600);\n    });\n\n    it('should return expires header if defined and max-age is not defined', () => {\n      const now = Date.now();\n      const future = new Date(now + 5000).toUTCString();\n      const headers = [{name: 'expires', value: future}];\n      const cacheControl = null;\n      assert.strictEqual(Cache.computeCacheLifetimeInSeconds(headers, cacheControl), 5);\n    });\n\n    it('should handle negative max-age', () => {\n      const past = new Date(Date.now() - 5000).toUTCString();\n      const headers = [{name: 'expires', value: past}];\n      const cacheControl = null;\n      assert.strictEqual(Cache.computeCacheLifetimeInSeconds(headers, cacheControl), -5);\n    });\n\n    it('should return null if neither max-age nor expires is defined', () => {\n      const headers: Array<{name: string, value: string}> = [];\n      const cacheControl = null;\n      assert.isNull(Cache.computeCacheLifetimeInSeconds(headers, cacheControl));\n    });\n\n    it('should return 0 if expires is invalid', () => {\n      const headers = [{name: 'expires', value: 'invalid date'}];\n      const cacheControl = null;\n      assert.strictEqual(Cache.computeCacheLifetimeInSeconds(headers, cacheControl), 0);\n    });\n  });\n\n  describe('cachingDisabled', () => {\n    it('should return true if cache-control contains no-cache', () => {\n      const headers = new Map([['cache-control', 'no-cache']]);\n      const parsedCacheControl = {\n        'no-cache': true,\n      };\n      assert.isTrue(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return true if cache-control contains no-store', () => {\n      const headers = new Map([['cache-control', 'no-store']]);\n      const parsedCacheControl = {\n        'no-store': true,\n      };\n      assert.isTrue(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return true if cache-control contains must-revalidate', () => {\n      const headers = new Map([['cache-control', 'must-revalidate']]);\n      const parsedCacheControl = {\n        'must-revalidate': true,\n      };\n      assert.isTrue(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return true if cache-control contains private', () => {\n      const headers = new Map([['cache-control', 'private']]);\n\n      const parsedCacheControl = {\n        private: true,\n      };\n      assert.isTrue(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return true if pragma contains no-cache and no cache-control', () => {\n      const headers = new Map([['pragma', 'no-cache']]);\n      const parsedCacheControl = null;\n      assert.isTrue(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return false if no disabling headers are present', () => {\n      const headers = new Map([['cache-control', 'max-age=3600']]);\n      const parsedCacheControl = {\n        'max-age': 3600,\n      };\n      assert.isFalse(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n\n    it('should return false if pragma contains no-cache but cache-control is present', () => {\n      const headers = new Map([['cache-control', 'max-age=3600'], ['pragma', 'no-cache']]);\n      const parsedCacheControl = {\n        'max-age': 3600,\n      };\n      assert.isFalse(Cache.cachingDisabled(headers, parsedCacheControl));\n    });\n  });\n  describe('getHeaders', () => {\n    it('should handle multiple headers with the same name', () => {\n      const responseHeaders = [\n        {name: 'cache-control', value: 'max-age=3600'},\n        {name: 'cache-control', value: 'public'},\n        {name: 'content-type', value: 'text/css'},\n      ];\n      const headers = Cache.getCombinedHeaders(responseHeaders);\n      assert.strictEqual(headers.get('cache-control'), 'max-age=3600, public');\n      assert.strictEqual(headers.get('content-type'), 'text/css');\n    });\n  });\n\n  describe('generateInsight', () => {\n    it('generateInsight - no cacheable requests', async () => {\n      const {data, insights} = await processTrace(this, 'load-simple.json.gz');\n      const insight =\n          getInsightOrError('Cache', insights, getFirstOrError(data.Meta.navigationsByNavigationId.values()));\n\n      const relatedEvents = insight.relatedEvents as Trace.Types.Events.SyntheticNetworkRequest[];\n      assert.strictEqual(insight.insightKey, 'Cache');\n      assert.strictEqual(insight.state, 'pass');\n      assert.deepEqual(insight.strings, Cache.UIStrings);\n      assert.strictEqual(insight.requests?.length, 0);\n      assert.deepEqual(insight.totalWastedBytes, 0);\n      assert.strictEqual(relatedEvents?.length, 0);\n    });\n\n    it('generateInsight - cacheable requests', async () => {\n      /**\n       * Contains 4 network requests:\n       * (1) page html request: not cacheable, Document resource type\n       * (2) stylesheet Google Fonts css2: caching is disabled\n       * (3) stylesheet app.css: ~ should recommend caching ~\n       * (4) via.placeholder img jpg: maxAgeInHours 8766, has high enough cache probability\n       * (5) via.placeholder img jpeg: maxAgeInHours 8766, has high enough cache probability\n       */\n      const {data, insights} = await processTrace(this, 'lcp-images.json.gz');\n      const insight =\n          getInsightOrError('Cache', insights, getFirstOrError(data.Meta.navigationsByNavigationId.values()));\n\n      const relatedEvents = insight.relatedEvents as Trace.Types.Events.SyntheticNetworkRequest[] ?? [];\n      assert.strictEqual(insight.insightKey, 'Cache');\n      assert.strictEqual(insight.state, 'fail');\n      assert.deepEqual(insight.strings, Cache.UIStrings);\n\n      const gotCacheable = insight.requests;\n      // Should have the 1 cacheable request.\n      assert.deepEqual(gotCacheable?.length, 1);\n      assert.deepEqual(\n          gotCacheable[0].request.args.data.url,\n          'https://chromedevtools.github.io/performance-stories/lcp-large-image/app.css');\n      // 10min\n      assert.deepEqual(gotCacheable[0].ttl, 600);\n      // request's transfer size is 0.\n      assert.deepEqual(gotCacheable[0].wastedBytes, 0);\n\n      assert.deepEqual(relatedEvents?.length, 1);\n      assert.deepEqual(insight.totalWastedBytes, 0);\n    });\n  });\n});\n"]}