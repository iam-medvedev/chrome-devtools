{"version":3,"file":"NetworkDependencyTree.test.js","sourceRoot":"","sources":["../../../../../../../front_end/models/trace/insights/NetworkDependencyTree.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,QAAQ,MAAM,oCAAoC,CAAC;AAE/D,OAAO,EAAC,uBAAuB,EAAC,MAAM,wCAAwC,CAAC;AAC/E,OAAO,EAAC,eAAe,EAAE,iBAAiB,EAAE,YAAY,EAAC,MAAM,oCAAoC,CAAC;AACpG,OAAO,EAAC,WAAW,EAAC,MAAM,iCAAiC,CAAC;AAC5D,OAAO,KAAK,KAAK,MAAM,aAAa,CAAC;AAKrC,MAAM,EAAC,SAAS,EAAC,GAAG,QAAQ,CAAC,YAAY,CAAC;AAE1C,uBAAuB,CAAC,uBAAuB,EAAE;IAC/C,IAAI,OAAoE,CAAC;IAEzE,MAAM,CAAC,KAAK;QACV,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,6BAA6B,CAAC,CAAC;QACjF,MAAM,QAAQ,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC;QAC/E,OAAO,GAAG,iBAAiB,CAAC,uBAAuB,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAC3E,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oCAAoC,EAAE,GAAG,EAAE;QAC5C,gHAAgH;QAChH,kDAAkD;QAClD,IAAI;QACJ,8CAA8C;QAC9C,8CAA8C;QAC9C,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC;QAEtC,MAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,8CAA8C,CAAC,CAAC;QAC/F,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,sBAAsB,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;QAC5F,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;QAElC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;QACvD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,0CAA0C,CAAC,CAAC;QAC7F,MAAM,CAAC,WAAW,CACd,MAAM,CAAC,sBAAsB,EAC7B,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;QACxF,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;QACpC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,2CAA2C,CAAC,CAAC;QAC9F,MAAM,CAAC,WAAW,CACd,MAAM,CAAC,sBAAsB,EAC7B,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;QACxF,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;IACtC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,yCAAyC,EAAE,GAAG,EAAE;QACjD,gEAAgE;QAChE,MAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAChC,MAAM,CAAC,WAAW,CACd,OAAO,CAAC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,GAAG,MAAM,CAAC,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;IAC3G,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE;QACpD,MAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;QAEvC,gEAAgE;QAChE,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC9B,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QAChC,4CAA4C;QAC5C,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACrC,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4DAA4D,EAAE,GAAG,EAAE;QACpE,MAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;QAEvC,uCAAuC;QACvC,uBAAuB;QACvB,yCAAyC;QACzC,0CAA0C;QAC1C,iDAAiD;QACjD,MAAM,CAAC,eAAe,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;QAClG,iDAAiD;QACjD,MAAM,CAAC,eAAe,CAAC,CAAC,GAAG,MAAM,CAAC,eAAe,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;QACpF,iDAAiD;QACjD,MAAM,CAAC,eAAe,CAAC,CAAC,GAAG,MAAM,CAAC,eAAe,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;IACtF,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,yEAAyE,EAAE,GAAG,EAAE;QACjF,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6DAA6D,EAAE,KAAK,IAAI,EAAE;QAC3E,8EAA8E;QAC9E,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,wBAAwB,CAAC,CAAC;QAC5E,MAAM,QAAQ,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC;QAC/E,OAAO,GAAG,iBAAiB,CAAC,uBAAuB,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAEzE,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,yDAAyD,EAAE,KAAK;QACjE,WAAW,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACjC,kEAAkE;QAClE,4EAA4E;QAC5E,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,uCAAuC,CAAC,CAAC;QAC3F,MAAM,QAAQ,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC;QAC/E,OAAO,GAAG,iBAAiB,CAAC,uBAAuB,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAEzE,gEAAgE;QAChE,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC;QACrD,MAAM,aAAa,GAAG,OAAO,CAAC,aAAiC,CAAC;QAEhE,mDAAmD;QACnD,4CAA4C;QAC5C,MAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAClC,MAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAChC,MAAM,OAAO,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QAEnC,wDAAwD;QACxD,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;QACtD,0DAA0D;QAC1D,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;QACxD,wDAAwD;QACxD,MAAM,CAAC,SAAS,CACZ,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC,CAAC;IACtH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,6BAA6B,EAAE,GAAG,EAAE;IAC3C,QAAQ,CAAC,oCAAoC,EAAE,GAAG,EAAE;QAClD,MAAM,eAAe,GAAG;YACtB,eAAe,EAAE;gBACf,oBAAoB,EAAE,EAAyC;gBAC/D,MAAM,EAAE,EAAkD;aAC3D;SACkC,CAAC;QAEtC,MAAM,WAAW,GAAG,EAAqC,CAAC;QAE1D,UAAU,CAAC,GAAG,EAAE;YACd,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,MAAM,GAAG,CAAC,CAAC;QAClE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+EAA+E,EAAE,GAAG,EAAE;YACvF,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC;gBACxD,IAAI,EAAE;oBACJ,IAAI,EAAE;wBACJ,GAAG,EAAE,qBAAqB;wBAC1B,OAAO,EAAE,CAAC;wBACV,KAAK,EAAE,UAAU;qBAClB;iBACF;aACmC,CAAC,CAAC;YACxC,MAAM,mBAAmB,GAAiD,CAAC;oBACzE,IAAI,EAAE;wBACJ,IAAI,EAAE;4BACJ,GAAG,EAAE,+BAA+B;yBACrC;qBACF;iBAC4C,CAAC,CAAC;YACjD,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,2BAA2B,CAC7F,eAAe,EAAE,WAAW,EAAE,mBAAmB,EAAE,0BAA0B,CAAA,EAAE,CAAC,CAAC;YACrF,MAAM,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC;oBAClB,OAAO,EAAE,CAA+B;oBACxC,KAAK,EAAE,UAAU;oBACjB,GAAG,EAAE,qBAAqB;oBAC1B,MAAM,EAAE,KAAK;oBACb,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kFAAkF,EAAE,GAAG,EAAE;YAC1F,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC;gBACxD,IAAI,EAAE;oBACJ,IAAI,EAAE;wBACJ,GAAG,EAAE,qBAAqB;wBAC1B,OAAO,EAAE,CAAC;wBACV,KAAK,EAAE,UAAU;qBAClB;iBACF;aACmC,CAAC,CAAC;YACxC,MAAM,mBAAmB,GAAiD,CAAC;oBACzE,IAAI,EAAE;wBACJ,IAAI,EAAE;4BACJ,GAAG,EAAE,6BAA6B;yBACnC;qBACF;iBAC4C,CAAC,CAAC;YACjD,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,2BAA2B,CAC7F,eAAe,EAAE,WAAW,EAAE,mBAAmB,EAAE,0BAA0B,CAAA,EAAE,CAAC,CAAC;YACrF,MAAM,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC;oBAClB,OAAO,EAAE,CAA+B;oBACxC,KAAK,EAAE,UAAU;oBACjB,GAAG,EAAE,qBAAqB;oBAC1B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sEAAsE,EAAE,GAAG,EAAE;YAC9E,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC;gBACxD,IAAI,EAAE;oBACJ,IAAI,EAAE;wBACJ,GAAG,EAAE,qBAAqB;wBAC1B,OAAO,EAAE,CAAC;wBACV,KAAK,EAAE,UAAU;qBAClB;iBACF;aACmC,CAAC,CAAC;YACxC,MAAM,wBAAwB,GAC1B,CAAC,EAAC,MAAM,EAAE,SAAS,CAAA,qBAAqB,EAAE,QAAQ,EAAE,GAA+B,EAAC,CAAC,CAAC;YAC1F,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,2BAA2B,CAC7F,eAAe,EAAE,WAAW,EAAE,yBAAyB,CAAA,EAAE;YACzD,0BAA0B,CAAC,wBAAwB,CAAC,CAAC;YACzD,MAAM,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC;oBAClB,OAAO,EAAE,CAA+B;oBACxC,KAAK,EAAE,UAAU;oBACjB,GAAG,EAAE,qBAAqB;oBAC1B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,IAAI;oBACjB,MAAM,EAAE,KAAK;iBACd,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,wEAAwE,EAAE,GAAG,EAAE;YAChF,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,IAAI,CAAC;gBACxD,IAAI,EAAE;oBACJ,IAAI,EAAE;wBACJ,GAAG,EAAE,qBAAqB;wBAC1B,OAAO,EAAE,CAAC;wBACV,KAAK,EAAE,UAAU;qBAClB;iBACF;aACmC,CAAC,CAAC;YACxC,MAAM,wBAAwB,GAC1B,CAAC,EAAC,MAAM,EAAE,SAAS,CAAA,mBAAmB,EAAE,QAAQ,EAAE,GAA+B,EAAC,CAAC,CAAC;YACxF,MAAM,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,2BAA2B,CAC7F,eAAe,EAAE,WAAW,EAAE,yBAAyB,CAAA,EAAE;YACzD,0BAA0B,CAAC,wBAAwB,CAAC,CAAC;YACzD,MAAM,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC;oBAClB,OAAO,EAAE,CAA+B;oBACxC,KAAK,EAAE,UAAU;oBACjB,GAAG,EAAE,qBAAqB;oBAC1B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd,CAAC,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,uBAAuB,CAAC,sCAAsC,EAAE;QAC9D,IAAI,OAAoE,CAAC;QACzE,IAAI,eAAqE,CAAC;QAE1E,MAAM,CAAC,KAAK;YACV,MAAM,EAAC,IAAI,EAAE,QAAQ,EAAC,GAAG,MAAM,YAAY,CAAC,IAAI,EAAE,2BAA2B,CAAC,CAAC;YAC/E,MAAM,QAAQ,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,yBAAyB,CAAC,MAAM,EAAE,CAAC,CAAC;YAC/E,OAAO,GAAG,iBAAiB,CAAC,uBAAuB,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YACzE,eAAe;gBACX,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,KAAK,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;QAC5G,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6CAA6C,EAAE,GAAG,EAAE;YACrD,4EAA4E;YAC5E,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,mBAAmB,EAAE,CAAC,CAAC,CAAC;YAEhD,oCAAoC;YACpC,MAAM,CAAC,SAAS,CAAC,eAAe,CAAC,CAAC;YAClC,MAAM,QAAQ,GAAyB;gBACrC;oBACE,OAAO,EAAE,EAAgC;oBACzC,KAAK,EAAE,kCAAkC;oBACzC,GAAG,EAAE,0BAA0B;oBAC/B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd;gBACD;oBACE,OAAO,EAAE,EAAgC;oBACzC,KAAK,EAAE,kCAAkC;oBACzC,GAAG,EAAE,yBAAyB;oBAC9B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd;gBACD;oBACE,OAAO,EAAE,EAAgC;oBACzC,KAAK,EAAE,kCAAkC;oBACzC,GAAG,EAAE,qBAAqB;oBAC1B,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,KAAK;iBACd;gBACD;oBACE,GAAG,EAAE,sBAAsB;oBAC3B,UAAU,EAAE,wCAAwC;oBACpD,OAAO,EAAE,eAAe;oBACxB,MAAM,EAAE,IAAI;oBACZ,WAAW,EAAE,KAAK;oBAClB,MAAM,EAAE,gBAAgB;iBACzB;aACF,CAAC;YAEF,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,mBAAmB,EAAE,QAAQ,CAAC,CAAC;QAC1D,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,0BAA0B,EAAE,GAAG,EAAE;QACxC,EAAE,CAAC,sDAAsD,EAAE,GAAG,EAAE;YAC9D,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;YAC/F,MAAM,CAAC,SAAS,CACZ,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,IAAyB,CAAC,EAAE,EAAE,CAAC,CAAC;QAC3G,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kDAAkD,EAAE,GAAG,EAAE;YAC1D,MAAM,UAAU,GAAG,yCAAyC,CAAC;YAC7D,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAC,GAAG,EAAE,qBAAqB,EAAE,UAAU,EAAE,yCAAyC,EAAC,CAAC,CAAC,CAAC;QAClH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,MAAM,UAAU,GAAG,uCAAuC,CAAC;YAC3D,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAC,GAAG,EAAE,qBAAqB,EAAE,UAAU,EAAE,uCAAuC,EAAC,CAAC,CAAC,CAAC;QAChH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,wCAAwC,EAAE,GAAG,EAAE;YAChD,MAAM,UAAU,GAAG,8EAA8E,CAAC;YAClG,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBACvB,EAAC,GAAG,EAAE,qBAAqB,EAAE,UAAU,EAAE,yCAAyC,EAAC;gBACnF,EAAC,GAAG,EAAE,mBAAmB,EAAE,UAAU,EAAE,qCAAqC,EAAC;aAC9E,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sDAAsD,EAAE,GAAG,EAAE;YAC9D,MAAM,UAAU,GAAG,sDAAsD,CAAC;YAC1E,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CACZ,MAAM,EAAE,CAAC,EAAC,GAAG,EAAE,qBAAqB,EAAE,UAAU,EAAE,sDAAsD,EAAC,CAAC,CAAC,CAAC;QAClH,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mDAAmD,EAAE,GAAG,EAAE;YAC3D,MAAM,UAAU,GACZ,gGAAgG,CAAC;YACrG,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CACZ,MAAM,EAAE,CAAC;oBACP,GAAG,EAAE,4EAA4E;oBACjF,UAAU,EAAE,gGAAgG;iBAC7G,CAAC,CAAC,CAAC;QACV,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,GAAG,EAAE;YACnD,MAAM,UAAU,GAAG,sCAAsC,CAAC;YAC1D,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,GAAG,EAAE;YAClD,MAAM,UAAU,GAAG,uCAAuC,CAAC;YAC3D,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2CAA2C,EAAE,GAAG,EAAE;YACnD,MAAM,UAAU,GAAG,oCAAoC,CAAC;YACxD,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6CAA6C,EAAE,GAAG,EAAE;YACrD,MAAM,UAAU,GACZ,kHAAkH,CAAC;YACvH,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YAChG,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,EAAC,GAAG,EAAE,qBAAqB,EAAE,UAAU,EAAE,yCAAyC,EAAC,CAAC,CAAC,CAAC;QAClH,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,uBAAuB,CAAC,8BAA8B,EAAE,GAAG,EAAE;IAC3D,MAAM,eAAe,GAAG;QACtB,eAAe,EAAE;YACf,gBAAgB,EAAE,IAAI,GAAG,EAAwE;YACjG,MAAM,EAAE,EAAkD;YAC1D,oBAAoB,EAAE,EAAyC;SAChE;KACkC,CAAC;IAEtC,MAAM,WAAW,GAAG;QAClB,sHAAsH;QACtH,UAAU,EAAE,EAAwC;QACpD,OAAO,EAAE;YACP,SAAS,EAAE;gBACT,UAAU,EAAE,GAAG,EAAE,CAAC,CAAC,EAAC,GAAG,EAAE,GAAG,EAAE,qBAAqB,EAAE,IAAI,GAAG,EAAkB,EAAC,CAAC;aACjF;YACD,OAAO,EAAE;gBACP,sBAAsB,EAAE;oBACtB,gBAAgB,EAAE;wBAChB,QAAQ,EAAE,CAAC,EAA4C,EAAE,EAAE;4BACzD,EAAE,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAC,GAAG,EAAE,+BAA+B,EAAC,EAA6B,CAAC,CAAC;4BACnG,EAAE,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAC,GAAG,EAAE,8BAA8B,EAAC,EAA6B,CAAC,CAAC;4BAClG,EAAE,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAC,GAAG,EAAE,+BAA+B,EAAC,EAA6B,CAAC,CAAC;4BACnG,EAAE,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAC,GAAG,EAAE,6BAA6B,EAAC,EAA6B,CAAC,CAAC;wBACnG,CAAC;qBACF;iBACF;gBACD,oBAAoB,EAAE;oBACpB,gBAAgB,EAAE;wBAChB,QAAQ,EAAE,CAAC,EAA4C,EAAE,EAAE;4BACzD,EAAE,CAAC,EAAC,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAC,GAAG,EAAE,+BAA+B,EAAC,EAA6B,CAAC,CAAC;wBACrG,CAAC;qBACF;iBACF;aACF;SACgD;QACnD,MAAM,EAAE,EAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,OAAO,EAAC;QAC9B,YAAY,EAAE,cAAc;KACM,CAAC;IAErC,MAAM,WAAW,GAA+C;QAC9D,IAAI,EAAE;YACJ,IAAI,EAAE;gBACJ,GAAG,EAAE,kBAAkB;gBACvB,SAAS,EAAE,cAAc;gBACzB,aAAa,EAAE,EAAC,UAAU,EAAE,KAAK,EAAC;gBAClC,MAAM,EAAE,EAAC,UAAU,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAC;aACzC;SACF;QACD,EAAE,EAAE,CAAC;KACmD,CAAC;IAE3D,MAAM,YAAY,GAA+C;QAC/D,IAAI,EAAE;YACJ,IAAI,EAAE;gBACJ,GAAG,EAAE,+BAA+B;gBACpC,aAAa,EAAE,EAAC,aAAa,EAAE,KAAK,EAAC;gBACrC,MAAM,EAAE,EAAC,QAAQ,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,YAAY,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,EAAC;aACzE;SACF;QACD,EAAE,EAAE,IAAI;KACgD,CAAC;IAE3D,UAAU,CAAC,GAAG,EAAE;QACd,eAAe,CAAC,eAAe,CAAC,gBAAgB,CAAC,KAAK,EAAE,CAAC;QACzD,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;QAClD,eAAe,CAAC,eAAe,CAAC,oBAAoB,CAAC,MAAM,GAAG,CAAC,CAAC;QAChE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC3D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;QACzD,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAE1D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,qBAAqB,CAAC,CAAC;QAC1E,uFAAuF;QACvF,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;QACnE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAE1D,MAAM,iBAAiB,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC/G,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,6BAA6B,CAAC;QAChE,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;QAC1F,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAE/D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;QAEzC,uGAAuG;QACvG,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,mBAAmB,CAAC,CAAC;QACxE,iGAAiG;QACjG,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;QAE1D,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,qBAAqB,CAAC,CAAC;QAC1E,uFAAuF;QACvF,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,8EAA8E,EAAE,GAAG,EAAE;QACtF,MAAM,iBAAiB,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC/G,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,gCAAgC,CAAC;QACnE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAE/D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;QACvE,MAAM,sBAAsB,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QACpH,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,+BAA+B,CAAC;QACvE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC,CAAC;QACpE,eAAe,CAAC,eAAe,CAAC,gBAAgB,CAAC,GAAG,CAAC,sBAAsB,EAAE,WAAW,CAAC,CAAC;QAE1F,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,wDAAwD,EAAE,GAAG,EAAE;QAChE,MAAM,cAAc,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC5G,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,8BAA8B,CAAC;QAC9D,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;QAE5D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,qEAAqE,EAAE,GAAG,EAAE;QAC7E,MAAM,qBAAqB,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QACnH,qDAAqD;QACrD,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,aAAa,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;QACnG,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QAEnE,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,kEAAkE,EAAE,GAAG,EAAE;QAC1E,MAAM,eAAe,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC7G,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,sCAAsC,CAAC;QACvE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAE7D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iCAAiC,EAAE,GAAG,EAAE;QACzC,MAAM,YAAY,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC1G,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,8BAA8B,CAAC;QAC5D,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAE1D,MAAM,aAAa,GAA+C,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAC3G,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,+BAA+B,CAAC;QAC9D,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAE3D,MAAM,oBAAoB,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,qBAAqB,CAAC,4BAA4B,CACjG,eAAe,EAAE,WAAW,EAAE,eAAe,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;QAC1E,MAAM,CAAC,QAAQ,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,qBAAqB,CAAC,CAAC;QAC1E,6EAA6E;QAC7E,0DAA0D;QAC1D,MAAM,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;IAC5D,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2025 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Platform from '../../../core/platform/platform.js';\nimport type * as Protocol from '../../../generated/protocol.js';\nimport {describeWithEnvironment} from '../../../testing/EnvironmentHelpers.js';\nimport {getFirstOrError, getInsightOrError, processTrace} from '../../../testing/InsightHelpers.js';\nimport {TraceLoader} from '../../../testing/TraceLoader.js';\nimport * as Trace from '../trace.js';\n\nimport type {PreconnectedOrigin} from './NetworkDependencyTree.js';\nimport type {InsightSetContextWithNavigation, RelatedEventsMap} from './types.js';\n\nconst {urlString} = Platform.DevToolsPath;\n\ndescribeWithEnvironment('NetworkDependencyTree', function() {\n  let insight: Trace.Insights.Types.InsightModels['NetworkDependencyTree'];\n\n  before(async function() {\n    const {data, insights} = await processTrace(this, 'lcp-multiple-frames.json.gz');\n    const firstNav = getFirstOrError(data.Meta.navigationsByNavigationId.values());\n    insight = getInsightOrError('NetworkDependencyTree', insights, firstNav);\n  });\n\n  it('calculates network dependency tree', () => {\n    // The network dependency tree in this trace is, |app.js| took longer than |app.css|, so |app.js| will be first.\n    // | .../index.html (ts:566777570990, dur:5005590)\n    // |\n    // | | .../app.js (ts:566782574106, dur:11790)\n    // | | .../app.css (ts:566782573909, dur:7205)\n    assert.lengthOf(insight.rootNodes, 1);\n\n    const root = insight.rootNodes[0];\n    assert.strictEqual(root.request.args.data.url, 'http://localhost:8787/lcp-iframes/index.html');\n    assert.strictEqual(root.timeFromInitialRequest, Trace.Types.Timing.Micro(root.request.dur));\n    assert.lengthOf(root.children, 2);\n\n    const [child0, child1] = insight.rootNodes[0].children;\n    assert.strictEqual(child0.request.args.data.url, 'http://localhost:8787/lcp-iframes/app.js');\n    assert.strictEqual(\n        child0.timeFromInitialRequest,\n        Trace.Types.Timing.Micro(child0.request.ts + child0.request.dur - root.request.ts));\n    assert.lengthOf(child0.children, 0);\n    assert.strictEqual(child1.request.args.data.url, 'http://localhost:8787/lcp-iframes/app.css');\n    assert.strictEqual(\n        child1.timeFromInitialRequest,\n        Trace.Types.Timing.Micro(child1.request.ts + child1.request.dur - root.request.ts));\n    assert.lengthOf(child1.children, 0);\n  });\n\n  it('Calculate the max critical path latency', () => {\n    // The chain |index.html(root) -> app.js(child0)| is the longest\n    const root = insight.rootNodes[0];\n    const child0 = root.children[0];\n    assert.strictEqual(\n        insight.maxTime, Trace.Types.Timing.Micro(child0.request.ts + child0.request.dur - root.request.ts));\n  });\n\n  it('Marks the longest network dependency chain', () => {\n    const root = insight.rootNodes[0];\n    const [child0, child1] = root.children;\n\n    // The chain |index.html(root) -> app.js(child0)| is the longest\n    assert.isTrue(root.isLongest);\n    assert.isTrue(child0.isLongest);\n    // The |app.css| is not in the longest chain\n    assert.isNotTrue(child1.isLongest);\n  });\n\n  it('Store the all parents and children events for all requests', () => {\n    const root = insight.rootNodes[0];\n    const [child0, child1] = root.children;\n\n    // There are three chains from Lantern:\n    //   |index.html(root)|\n    //   |index.html(root) -> app.js(child0)|\n    //   |index.html(root) -> app.css(child1)|\n    // Both child0 and child1 are related to the root\n    assert.sameDeepMembers([...root.relatedRequests], [root.request, child0.request, child1.request]);\n    // Only root and child0 are related to the child0\n    assert.sameDeepMembers([...child0.relatedRequests], [root.request, child0.request]);\n    // Only root and child1 are related to the child1\n    assert.sameDeepMembers([...child1.relatedRequests], [root.request, child1.request]);\n  });\n\n  it('Fail the audit when there at least one chain with at least two requests', () => {\n    assert.isTrue(insight.fail);\n  });\n\n  it('Does not fail the audit when there is only main doc request', async () => {\n    // Need to load a file with only main doc in the the critical requests chains.\n    const {data, insights} = await processTrace(this, 'image-delivery.json.gz');\n    const firstNav = getFirstOrError(data.Meta.navigationsByNavigationId.values());\n    insight = getInsightOrError('NetworkDependencyTree', insights, firstNav);\n\n    assert.isFalse(insight.fail);\n  });\n\n  it('Calculates the relatedEvents map (event to warning map)', async function() {\n    TraceLoader.setTestTimeout(this);\n    // Need to load a file with longer dependency chain for this test.\n    // Only those requests whose depth >= 2 will be added to the related events.\n    const {data, insights} = await processTrace(this, 'web-dev-screenshot-source-ids.json.gz');\n    const firstNav = getFirstOrError(data.Meta.navigationsByNavigationId.values());\n    insight = getInsightOrError('NetworkDependencyTree', insights, firstNav);\n\n    // For NetworkDependencyTree, the relatedEvents is a map format.\n    assert.isFalse(Array.isArray(insight.relatedEvents));\n    const relatedEvents = insight.relatedEvents as RelatedEventsMap;\n\n    // There are a few chains, let test the first chain\n    // |web.dev -> /css -> KFO7CnqEu9…UBA.woff2|\n    const root = insight.rootNodes[0];\n    const child0 = root.children[0];\n    const child00 = child0.children[0];\n\n    // Root's depth is 0, so there isn't any warning message\n    assert.deepEqual(relatedEvents.get(root.request), []);\n    // child0's depth is 1, so there isn't any warning message\n    assert.deepEqual(relatedEvents.get(child0.request), []);\n    // child00's depth is 2, so there is one warning message\n    assert.deepEqual(\n        relatedEvents.get(child00.request), [Trace.Insights.Models.NetworkDependencyTree.UIStrings.warningDescription]);\n  });\n});\n\ndescribe('generatePreconnectedOrigins', () => {\n  describe('generatePreconnectedOriginsFromDom', () => {\n    const mockParsedTrace = {\n      NetworkRequests: {\n        linkPreconnectEvents: [] as Trace.Types.Events.LinkPreconnect[],\n        byTime: [] as Trace.Types.Events.SyntheticNetworkRequest[],\n      },\n    } as Trace.Handlers.Types.ParsedTrace;\n\n    const mockContext = {} as InsightSetContextWithNavigation;\n\n    beforeEach(() => {\n      mockParsedTrace.NetworkRequests.linkPreconnectEvents.length = 0;\n    });\n\n    it('should mark preconnect origins as not unused when they match context requests', () => {\n      mockParsedTrace.NetworkRequests.linkPreconnectEvents.push({\n        args: {\n          data: {\n            url: 'https://example.com',\n            node_id: 1,\n            frame: 'frame-id',\n          },\n        },\n      } as Trace.Types.Events.LinkPreconnect);\n      const mockContextRequests: Trace.Types.Events.SyntheticNetworkRequest[] = [{\n        args: {\n          data: {\n            url: 'https://example.com/script.js',\n          },\n        },\n      } as Trace.Types.Events.SyntheticNetworkRequest];\n      const preconnectOrigins = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectedOrigins(\n          mockParsedTrace, mockContext, mockContextRequests, /* preconnectCandidates */[]);\n      assert.deepEqual(preconnectOrigins, [{\n                         node_id: 1 as Protocol.DOM.BackendNodeId,\n                         frame: 'frame-id',\n                         url: 'https://example.com',\n                         unused: false,\n                         crossorigin: false,\n                         source: 'DOM'\n                       }]);\n    });\n\n    it('should mark preconnect origins as unused when they do not match context requests', () => {\n      mockParsedTrace.NetworkRequests.linkPreconnectEvents.push({\n        args: {\n          data: {\n            url: 'https://example.com',\n            node_id: 1,\n            frame: 'frame-id',\n          },\n        },\n      } as Trace.Types.Events.LinkPreconnect);\n      const mockContextRequests: Trace.Types.Events.SyntheticNetworkRequest[] = [{\n        args: {\n          data: {\n            url: 'https://other.com/image.png',\n          },\n        },\n      } as Trace.Types.Events.SyntheticNetworkRequest];\n      const preconnectOrigins = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectedOrigins(\n          mockParsedTrace, mockContext, mockContextRequests, /* preconnectCandidates */[]);\n      assert.deepEqual(preconnectOrigins, [{\n                         node_id: 1 as Protocol.DOM.BackendNodeId,\n                         frame: 'frame-id',\n                         url: 'https://example.com',\n                         unused: true,\n                         crossorigin: false,\n                         source: 'DOM'\n                       }]);\n    });\n\n    it('sets crossorigin to true when a matching preconnect candidate exists', () => {\n      mockParsedTrace.NetworkRequests.linkPreconnectEvents.push({\n        args: {\n          data: {\n            url: 'https://example.com',\n            node_id: 1,\n            frame: 'frame-id',\n          },\n        },\n      } as Trace.Types.Events.LinkPreconnect);\n      const mockPreconnectCandidates: Trace.Insights.Models.NetworkDependencyTree.PreconnectCandidate[] =\n          [{origin: urlString`https://example.com`, wastedMs: 100 as Trace.Types.Timing.Milli}];\n      const preconnectOrigins = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectedOrigins(\n          mockParsedTrace, mockContext, /* mockContextRequests */[],\n          /* preconnectCandidates */ mockPreconnectCandidates);\n      assert.deepEqual(preconnectOrigins, [{\n                         node_id: 1 as Protocol.DOM.BackendNodeId,\n                         frame: 'frame-id',\n                         url: 'https://example.com',\n                         unused: true,\n                         crossorigin: true,\n                         source: 'DOM'\n                       }]);\n    });\n\n    it('sets crossorigin to false when no matching preconnect candidate exists', () => {\n      mockParsedTrace.NetworkRequests.linkPreconnectEvents.push({\n        args: {\n          data: {\n            url: 'https://example.com',\n            node_id: 1,\n            frame: 'frame-id',\n          },\n        },\n      } as Trace.Types.Events.LinkPreconnect);\n      const mockPreconnectCandidates: Trace.Insights.Models.NetworkDependencyTree.PreconnectCandidate[] =\n          [{origin: urlString`https://other.com`, wastedMs: 100 as Trace.Types.Timing.Milli}];\n      const preconnectOrigins = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectedOrigins(\n          mockParsedTrace, mockContext, /* mockContextRequests */[],\n          /* preconnectCandidates */ mockPreconnectCandidates);\n      assert.deepEqual(preconnectOrigins, [{\n                         node_id: 1 as Protocol.DOM.BackendNodeId,\n                         frame: 'frame-id',\n                         url: 'https://example.com',\n                         unused: true,\n                         crossorigin: false,\n                         source: 'DOM'\n                       }]);\n    });\n  });\n\n  describeWithEnvironment('PreconnectedOriginFromResponseHeader', function() {\n    let insight: Trace.Insights.Types.InsightModels['NetworkDependencyTree'];\n    let documentRequest: Trace.Types.Events.SyntheticNetworkRequest|undefined;\n\n    before(async function() {\n      const {data, insights} = await processTrace(this, 'preconnect-advice.json.gz');\n      const firstNav = getFirstOrError(data.Meta.navigationsByNavigationId.values());\n      insight = getInsightOrError('NetworkDependencyTree', insights, firstNav);\n      documentRequest =\n          data.NetworkRequests.byTime.find(req => req.args.data.requestId === firstNav.args.data?.navigationId);\n    });\n\n    it('correctly generate the preconnected origins', () => {\n      // There are 4 preconnected origins, 3 from DOM, and 1 from response header.\n      assert.lengthOf(insight.preconnectedOrigins, 4);\n\n      // A sanity check to avoid TS error.\n      assert.isDefined(documentRequest);\n      const expected: PreconnectedOrigin[] = [\n        {\n          node_id: 57 as Protocol.DOM.BackendNodeId,\n          frame: '3773BAB92FB5A26C6B03EAD6CF821791',\n          url: 'https://www.youtube.com/',\n          unused: true,\n          crossorigin: false,\n          source: 'DOM',\n        },\n        {\n          node_id: 58 as Protocol.DOM.BackendNodeId,\n          frame: '3773BAB92FB5A26C6B03EAD6CF821791',\n          url: 'https://www.google.com/',\n          unused: true,\n          crossorigin: false,\n          source: 'DOM',\n        },\n        {\n          node_id: 59 as Protocol.DOM.BackendNodeId,\n          frame: '3773BAB92FB5A26C6B03EAD6CF821791',\n          url: 'http://example.com/',\n          unused: true,\n          crossorigin: false,\n          source: 'DOM',\n        },\n        {\n          url: 'https://example.com/',\n          headerText: '<https://example.com/>; rel=preconnect',\n          request: documentRequest,\n          unused: true,\n          crossorigin: false,\n          source: 'ResponseHeader',\n        },\n      ];\n\n      assert.deepEqual(insight.preconnectedOrigins, expected);\n    });\n  });\n\n  describe('handleLinkResponseHeader', () => {\n    it('should return an empty array for null or empty input', () => {\n      assert.deepEqual(Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(''), []);\n      assert.deepEqual(\n          Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(null as unknown as string), []);\n    });\n\n    it('should parse a valid preconnect link with quotes', () => {\n      const linkHeader = '<https://example.com>; rel=\"preconnect\"';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, [{url: 'https://example.com', headerText: '<https://example.com>; rel=\"preconnect\"'}]);\n    });\n\n    it('should parse a valid preconnect link without quotes', () => {\n      const linkHeader = '<https://example.com>; rel=preconnect';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, [{url: 'https://example.com', headerText: '<https://example.com>; rel=preconnect'}]);\n    });\n\n    it('should parse multiple preconnect links', () => {\n      const linkHeader = '<https://example.com>; rel=\"preconnect\", <https://other.com>; rel=preconnect';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, [\n        {url: 'https://example.com', headerText: '<https://example.com>; rel=\"preconnect\"'},\n        {url: 'https://other.com', headerText: '<https://other.com>; rel=preconnect'},\n      ]);\n    });\n\n    it('should parse a preconnect link with other parameters', () => {\n      const linkHeader = '<https://example.com>; rel=\"preconnect\"; crossorigin';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(\n          result, [{url: 'https://example.com', headerText: '<https://example.com>; rel=\"preconnect\"; crossorigin'}]);\n    });\n\n    it('should parse a preconnect link with comma in urls', () => {\n      const linkHeader =\n          '<https://imaginary.url.notreal/segment;foo=bar;baz/item?name=What,+me+worry>; rel=\"preconnect\"';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(\n          result, [{\n            url: 'https://imaginary.url.notreal/segment;foo=bar;baz/item?name=What,+me+worry',\n            headerText: '<https://imaginary.url.notreal/segment;foo=bar;baz/item?name=What,+me+worry>; rel=\"preconnect\"'\n          }]);\n    });\n\n    it('should ignore links with other rel values', () => {\n      const linkHeader = '<https://example.com>; rel=\"preload\"';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, []);\n    });\n\n    it('should ignore invalid links (missing <>)', () => {\n      const linkHeader = 'https://example.com; rel=\"preconnect\"';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, []);\n    });\n\n    it('should ignore invalid links (missing rel)', () => {\n      const linkHeader = '<https://example.com>; crossorigin';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, []);\n    });\n\n    it('should handle mixed valid and invalid links', () => {\n      const linkHeader =\n          '<https://example.com>; rel=\"preconnect\", https://other.com; rel=preconnect, <https://another.com>; rel=\"preload\"';\n      const result = Trace.Insights.Models.NetworkDependencyTree.handleLinkResponseHeader(linkHeader);\n      assert.deepEqual(result, [{url: 'https://example.com', headerText: '<https://example.com>; rel=\"preconnect\"'}]);\n    });\n  });\n});\n\ndescribeWithEnvironment('generatePreconnectCandidates', () => {\n  const mockParsedTrace = {\n    NetworkRequests: {\n      eventToInitiator: new Map<Trace.Types.Events.SyntheticNetworkRequest, Trace.Types.Events.Event>(),\n      byTime: [] as Trace.Types.Events.SyntheticNetworkRequest[],\n      linkPreconnectEvents: [] as Trace.Types.Events.LinkPreconnect[],\n    },\n  } as Trace.Handlers.Types.ParsedTrace;\n\n  const mockContext = {\n    // This is not need to calculate the data of this insight, but is needed to check this is a context with lantern data.\n    navigation: {} as Trace.Types.Events.NavigationStart,\n    lantern: {\n      simulator: {\n        getOptions: () => ({rtt: 200, additionalRttByOrigin: new Map<string, number>()}),\n      },\n      metrics: {\n        largestContentfulPaint: {\n          pessimisticGraph: {\n            traverse: (cb: (node: Trace.Lantern.Graph.Node) => void) => {\n              cb({type: 'network', request: {url: 'https://example.com/script.js'}} as Trace.Lantern.Graph.Node);\n              cb({type: 'network', request: {url: 'https://example.com/first.js'}} as Trace.Lantern.Graph.Node);\n              cb({type: 'network', request: {url: 'https://example.com/second.js'}} as Trace.Lantern.Graph.Node);\n              cb({type: 'network', request: {url: 'https://other.com/image.png'}} as Trace.Lantern.Graph.Node);\n            },\n          },\n        },\n        firstContentfulPaint: {\n          pessimisticGraph: {\n            traverse: (cb: (node: Trace.Lantern.Graph.Node) => void) => {\n              cb({type: 'network', request: {url: 'https://example.com/script.js'}} as Trace.Lantern.Graph.Node);\n            },\n          },\n        },\n      },\n    } as unknown as Trace.Insights.Types.LanternContext,\n    bounds: {min: 0, max: 1000000},\n    navigationId: 'main-request',\n  } as InsightSetContextWithNavigation;\n\n  const mainRequest: Trace.Types.Events.SyntheticNetworkRequest = {\n    args: {\n      data: {\n        url: 'https://main.com',\n        requestId: 'main-request',\n        syntheticData: {finishTime: 1_000},\n        timing: {connectEnd: 0, connectStart: 0}\n      },\n    },\n    ts: 0,\n  } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n\n  const validRequest: Trace.Types.Events.SyntheticNetworkRequest = {\n    args: {\n      data: {\n        url: 'https://example.com/script.js',\n        syntheticData: {sendStartTime: 2_000},\n        timing: {dnsStart: 100, dnsEnd: 200, connectStart: 300, connectEnd: 400},\n      },\n    },\n    ts: 1500,\n  } as unknown as Trace.Types.Events.SyntheticNetworkRequest;\n\n  beforeEach(() => {\n    mockParsedTrace.NetworkRequests.eventToInitiator.clear();\n    mockParsedTrace.NetworkRequests.byTime.length = 0;\n    mockParsedTrace.NetworkRequests.linkPreconnectEvents.length = 0;\n    mockParsedTrace.NetworkRequests.byTime.push(mainRequest);\n  });\n\n  it('generates preconnect results for valid requests', () => {\n    mockParsedTrace.NetworkRequests.byTime.push(validRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 1);\n    assert.strictEqual(preconnectCandidates[0].origin, 'https://example.com');\n    // |validRequest->sendStartTime| - |mainRequest->finishTime| + |validRequest->dnsStart|\n    assert.strictEqual(preconnectCandidates[0].wastedMs, 101);\n  });\n\n  it('generates preconnect results and sort them by wasted time', () => {\n    mockParsedTrace.NetworkRequests.byTime.push(validRequest);\n\n    const otherValidRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    otherValidRequest.args.data.url = 'https://other.com/image.png';\n    otherValidRequest.args.data.syntheticData.sendStartTime = Trace.Types.Timing.Micro(3_000);\n    mockParsedTrace.NetworkRequests.byTime.push(otherValidRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 2);\n\n    // other.com has a wasted time of 102 ms, while example.com has 101 ms. So other.com will be the first.\n    assert.strictEqual(preconnectCandidates[0].origin, 'https://other.com');\n    // |otherValidRequest->sendStartTime| - |mainRequest->finishTime| + |otherValidRequest->dnsStart|\n    assert.strictEqual(preconnectCandidates[0].wastedMs, 102);\n\n    assert.strictEqual(preconnectCandidates[1].origin, 'https://example.com');\n    // |validRequest->sendStartTime| - |mainRequest->finishTime| + |validRequest->dnsStart|\n    assert.strictEqual(preconnectCandidates[1].wastedMs, 101);\n  });\n\n  it('shouldn\\'t suggest preconnect when requests have same origin as main request', () => {\n    const sameOriginRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    sameOriginRequest.args.data.url = 'https://main.com/some-resource';\n    mockParsedTrace.NetworkRequests.byTime.push(sameOriginRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 0);\n  });\n\n  it('shouldn\\'t suggest preconnect when initiator is main resource', () => {\n    const initiatedByMainRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    initiatedByMainRequest.args.data.url = 'https://example.com/script.js';\n    mockParsedTrace.NetworkRequests.byTime.push(initiatedByMainRequest);\n    mockParsedTrace.NetworkRequests.eventToInitiator.set(initiatedByMainRequest, mainRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 0);\n  });\n\n  it('shouldn\\'t suggest non http(s) protocols as preconnect', () => {\n    const nonHttpRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    nonHttpRequest.args.data.url = 'data:text/plain;base64,hello';\n    mockParsedTrace.NetworkRequests.byTime.push(nonHttpRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 0);\n  });\n\n  it('shouldn\\'t suggest preconnect when request has been fired after 15s', () => {\n    const aboveThresholdRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    // sendStartTime is way above the threshold (15000ms)\n    aboveThresholdRequest.args.data.syntheticData.sendStartTime = Trace.Types.Timing.Micro(20_000_000);\n    mockParsedTrace.NetworkRequests.byTime.push(aboveThresholdRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 0);\n  });\n\n  it('shouldn\\'t suggest preconnect when requests are not in LCP graph', () => {\n    const notInLCPRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    notInLCPRequest.args.data.url = 'https://not-in-lcp.com/some-resource';\n    mockParsedTrace.NetworkRequests.byTime.push(notInLCPRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 0);\n  });\n\n  it('should only list an origin once', () => {\n    const firstRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    firstRequest.args.data.url = 'https://example.com/first.js';\n    mockParsedTrace.NetworkRequests.byTime.push(firstRequest);\n\n    const secondRequest: Trace.Types.Events.SyntheticNetworkRequest = JSON.parse(JSON.stringify(validRequest));\n    secondRequest.args.data.url = 'https://example.com/second.js';\n    mockParsedTrace.NetworkRequests.byTime.push(secondRequest);\n\n    const preconnectCandidates = Trace.Insights.Models.NetworkDependencyTree.generatePreconnectCandidates(\n        mockParsedTrace, mockContext, mockParsedTrace.NetworkRequests.byTime);\n    assert.lengthOf(preconnectCandidates, 1);\n    assert.strictEqual(preconnectCandidates[0].origin, 'https://example.com');\n    // First request has a wasted time of 101 ms, while second request has 51 ms.\n    // So the final waste time will be the longer one: 101 ms.\n    assert.strictEqual(preconnectCandidates[0].wastedMs, 101);\n  });\n});\n"]}