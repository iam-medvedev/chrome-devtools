{"version":3,"file":"OnEachInteraction.js","sourceRoot":"","sources":["../../../../../../../front_end/models/live-metrics/web-vitals-injected/OnEachInteraction.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B;;;;GAIG;AAEH,OAAO,KAAK,SAAS,MAAM,+CAA+C,CAAC;AAE3E,MAAM,UAAU,iBAAiB,CAAC,QAA8D;IAC9F,SAAS,CAAC,2BAA2B,CAAC,IAAI,CAAC,CAAC,KAA6B,EAAE,EAAE;QAC3E,8DAA8D;QAC9D,wCAAwC;QACxC,KAAK,OAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YAC/B,IAAI,KAAK,CAAC,aAAa,EAAE,CAAC;gBACxB,MAAM,WAAW,GAAG,SAAS,CAAC,YAAY,CAAC;oBACzC,OAAO,EAAE,CAAC,KAAK,CAAC;oBAChB,gEAAgE;oBAChE,oDAAoD;oBACpD,IAAI,EAAE,KAAK;oBACX,MAAM,EAAE,MAAM;oBACd,KAAK,EAAE,KAAK,CAAC,QAAQ;oBACrB,KAAK,EAAE,KAAK,CAAC,QAAQ;oBACrB,cAAc,EAAE,UAAU;oBAC1B,EAAE,EAAE,KAAK;iBACV,CAAC,CAAC;gBACH,QAAQ,CAAC,WAAW,CAAC,CAAC;YACxB,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["// Copyright 2024 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\n/**\n * @file web-vitals.js doesn't provide a log of all interactions.\n * This solution is hacky but it was recommended by web-vitals devs:\n * b/371052022\n */\n\nimport * as WebVitals from '../../../third_party/web-vitals/web-vitals.js';\n\nexport function onEachInteraction(onReport: (metric: WebVitals.INPMetricWithAttribution) => void): void {\n  WebVitals.entryPreProcessingCallbacks.push((entry: PerformanceEventTiming) => {\n    // Wait a microtask so this \"pre\" processing callback actually\n    // becomes a \"post\" processing callback.\n    void Promise.resolve().then(() => {\n      if (entry.interactionId) {\n        const interaction = WebVitals.attributeINP({\n          entries: [entry],\n          // The only value we really need for `attributeINP` is `entries`\n          // Everything else is included to fill out the type.\n          name: 'INP',\n          rating: 'good',\n          value: entry.duration,\n          delta: entry.duration,\n          navigationType: 'navigate',\n          id: 'N/A',\n        });\n        onReport(interaction);\n      }\n    });\n  });\n}\n"]}