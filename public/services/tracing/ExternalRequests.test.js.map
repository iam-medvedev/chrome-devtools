{"version":3,"file":"ExternalRequests.test.js","sourceRoot":"","sources":["../../../../../../front_end/services/tracing/ExternalRequests.test.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;AAE7B,OAAO,KAAK,KAAK,MAAM,6BAA6B,CAAC;AACrD,OAAO,KAAK,aAAa,MAAM,sCAAsC,CAAC;AACtE,OAAO,EAAC,uBAAuB,EAAC,MAAM,qCAAqC,CAAC;AAC5E,OAAO,EAAC,WAAW,EAAC,MAAM,8BAA8B,CAAC;AAEzD,OAAO,KAAK,OAAO,MAAM,cAAc,CAAC;AAExC,MAAM,EAAC,2BAA2B,EAAC,GAAG,OAAO,CAAC,gBAAgB,CAAC;AAE/D,uBAAuB,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAC/C,EAAE,CAAC,gCAAgC,EAAE,KAAK;QACxC,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,6BAA6B,CAAC,CAAC;QAChF,MAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC7D,MAAM,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAE1B,MAAM,MAAM,GAAG,MAAM,2BAA2B,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC;QACzE,IAAI,OAAO,IAAI,MAAM,EAAE,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,gBAAgB,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC;QAC9C,CAAC;QACD,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,KAAK,EAAE,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QACpE,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,cAAc,CAAC,CAAC;IACnH,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,sCAAsC,EAAE,KAAK;QAC9C,MAAM,MAAM,GAAG,MAAM,WAAW,CAAC,SAAS,CAAC,IAAI,EAAE,6BAA6B,CAAC,CAAC;QAChF,MAAM,KAAK,GAAG,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;QAC7D,MAAM,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAE1B,MAAM,MAAM,GAAG,MAAM,2BAA2B,CAAC,KAAK,EAAE,kBAAkB,CAAC,CAAC;QAC5E,IAAI,OAAO,IAAI,MAAM,EAAE,CAAC;YACtB,MAAM,CAAC,IAAI,CAAC,gCAAgC,CAAC,CAAC;QAChD,CAAC;QACD,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,sDAAsD,CAAC,CAAC;IAC3F,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2025 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Trace from '../../models/trace/trace.js';\nimport * as TimelineUtils from '../../panels/timeline/utils/utils.js';\nimport {describeWithEnvironment} from '../../testing/EnvironmentHelpers.js';\nimport {TraceLoader} from '../../testing/TraceLoader.js';\n\nimport * as Tracing from './tracing.js';\n\nconst {getInsightAgentFocusToDebug} = Tracing.ExternalRequests;\n\ndescribeWithEnvironment('ExternalRequests', () => {\n  it('finds the insight by the title', async function() {\n    const events = await TraceLoader.rawEvents(this, 'web-dev-with-commit.json.gz');\n    const model = Trace.TraceModel.Model.createWithAllHandlers();\n    await model.parse(events);\n\n    const result = await getInsightAgentFocusToDebug(model, 'LCP breakdown');\n    if ('error' in result) {\n      assert.fail(`Test failed: ${result.error}`);\n    }\n    assert.instanceOf(result.focus, TimelineUtils.AIContext.AgentFocus);\n    assert.strictEqual(result.focus.data.type === 'insight' && result.focus.data.insight.insightKey, 'LCPBreakdown');\n  });\n\n  it('errors if it cannot find the insight', async function() {\n    const events = await TraceLoader.rawEvents(this, 'web-dev-with-commit.json.gz');\n    const model = Trace.TraceModel.Model.createWithAllHandlers();\n    await model.parse(events);\n\n    const result = await getInsightAgentFocusToDebug(model, 'FakeInsightTitle');\n    if ('focus' in result) {\n      assert.fail('Test should not find an focus.');\n    }\n    assert.strictEqual(result.error, 'Could not find matching insight for FakeInsightTitle');\n  });\n});\n"]}